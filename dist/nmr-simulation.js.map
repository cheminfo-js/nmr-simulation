{"version":3,"sources":["webpack://nmrSimulation/webpack/universalModuleDefinition","webpack://nmrSimulation/webpack/bootstrap","webpack://nmrSimulation/./node_modules/ml-sparse-matrix/src/SparseMatrix.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/index.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/matrix.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/base.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/util.js","webpack://nmrSimulation/./node_modules/num-sort/index.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/dc/util.js","webpack://nmrSimulation/./node_modules/ml-hclust/src/Cluster.js","webpack://nmrSimulation/./node_modules/new-array/index.js","webpack://nmrSimulation/./node_modules/binary-search/index.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/abstractMatrix.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/dc/lu.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/dc/svd.js","webpack://nmrSimulation/./node_modules/ml-stat/index.js","webpack://nmrSimulation/./node_modules/ml-stat/array.js","webpack://nmrSimulation/./node_modules/ml-distance-euclidean/euclidean.js","webpack://nmrSimulation/./node_modules/ml-hclust/src/ClusterLeaf.js","webpack://nmrSimulation/./node_modules/ml-simple-clustering/src/index.js","webpack://nmrSimulation/./node_modules/ml-hclust/src/index.js","webpack://nmrSimulation/./index.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/symbol-species.js","webpack://nmrSimulation/./node_modules/ml-array-utils/src/index.js","webpack://nmrSimulation/./node_modules/ml-array-utils/src/ArrayUtils.js","webpack://nmrSimulation/./node_modules/ml-stat/matrix.js","webpack://nmrSimulation/./node_modules/ml-array-utils/src/getEquallySpaced.js","webpack://nmrSimulation/./node_modules/ml-array-utils/src/snv.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/transpose.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/row.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/sub.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/selection.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/column.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/flipRow.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/views/flipColumn.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/decompositions.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/dc/evd.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/dc/qr.js","webpack://nmrSimulation/./node_modules/ml-matrix/src/dc/cholesky.js","webpack://nmrSimulation/./node_modules/ml-hclust/src/agnes.js","webpack://nmrSimulation/./node_modules/heap/index.js","webpack://nmrSimulation/./node_modules/heap/lib/heap.js","webpack://nmrSimulation/./node_modules/util/util.js","webpack://nmrSimulation/./node_modules/process/browser.js","webpack://nmrSimulation/./node_modules/util/support/isBufferBrowser.js","webpack://nmrSimulation/./node_modules/inherits/inherits_browser.js","webpack://nmrSimulation/./node_modules/ml-distance-matrix/src/index.js","webpack://nmrSimulation/./node_modules/ml-hclust/src/diana.js","webpack://nmrSimulation/./node_modules/ml-hash-table/src/HashTable.js","webpack://nmrSimulation/./node_modules/ml-hash-table/src/primeFinder.js","webpack://nmrSimulation/./node_modules/number-is-nan/index.js","webpack://nmrSimulation/./node_modules/nmr-simulation/src/SpinSystem.js","webpack://nmrSimulation/./node_modules/nmr-simulation/src/pauli.js","webpack://nmrSimulation/./node_modules/nmr-simulation/src/simulate1D.js","webpack://nmrSimulation/./node_modules/nmr-simulation/src/simulate2D.js","webpack://nmrSimulation/./node_modules/nmr-simulation/src/index.js"],"names":["HashTable","require","SparseMatrix","constructor","rows","columns","options","other","_init","elements","clone","threshold","Array","isArray","matrix","length","i","j","value","Math","abs","set","eye","min","initialCapacity","to2DArray","copy","get","isSquare","isSymmetric","symmetric","forEachNonZero","v","cardinality","size","row","column","remove","mmul","console","warn","m","p","result","v1","k","l","v2","kroneckerProduct","n","q","callback","forEachPair","key","r","maybeShrinkCapacity","getNonZeros","values","idx","setThreshold","newThreshold","prototype","klass","identity","tensorProduct","module","exports","inplaceOperator","inplaceOperatorScalar","inplaceOperatorMatrix","staticOperator","inplaceMethod","staticMethod","operators","operator","eval","fillTemplateFunction","name","op","methods","forEach","mathMethod","push","method","template","replace","RegExp","Matrix","Decompositions","DC","abstractMatrix","util","nRows","nColumns","arguments","isMatrix","Number","isInteger","TypeError","RangeError","concat","rowIndex","columnIndex","newMatrix","Symbol","species","removeRow","index","checkRowIndex","splice","addRow","array","undefined","checkRowVector","removeColumn","checkColumnIndex","addColumn","checkColumnVector","BaseView","outer","max","vector","to1DArray","checkIndices","rowIndices","columnIndices","rowOut","some","columnOut","c","from","checkRange","startRow","endRow","startColumn","endColumn","notAllNumbers","slice","arg","getRange","to","arr","sumByRow","sum","zeros","sumByColumn","sumAll","numberIsNan","assertNum","x","asc","a","b","desc","hypotenuse","sqrt","getEmpty2DArray","getFilled2DArray","Heap","Cluster","children","distance","cut","root","list","ans","aux","shift","group","minGroups","heap","first","pop","child","toArray","traverse","cb","visit","newArray","haystack","needle","comparator","low","high","mid","cmp","LuDecomposition","SvDecomposition","arrayUtils","MatrixTransposeView","MatrixRowView","MatrixSubView","MatrixSelectionView","MatrixColumnView","MatrixFlipRowView","MatrixFlipColumnView","superCtor","Object","from1DArray","newRows","newColumns","newData","rowVector","columnVector","empty","fill","ones","rand","rng","random","randInt","maxValue","floor","diag","data","matrix1","matrix2","checkMatrix","apply","ii","jj","call","isRowVector","isColumnVector","isVector","Error","repeat","rowRep","colRep","setSubMatrix","neg","mulS","getRow","getRowVector","setRow","swapRows","row1","row2","temp","getColumn","getColumnVector","setColumn","swapColumns","column1","column2","addRowVector","subRowVector","mulRowVector","divRowVector","addColumnVector","subColumnVector","mulColumnVector","divColumnVector","mulRow","mulColumn","maxIndex","minIndex","maxRow","maxRowIndex","minRow","minRowIndex","maxColumn","maxColumnIndex","minColumn","minColumnIndex","by","mean","prod","cumulativeSum","dot","vector2","vector1","Bcolj","s","strassen2x2","a11","b11","a12","b12","a21","b21","a22","b22","m1","m2","m3","m4","m5","m6","m7","c00","c01","c10","c11","strassen3x3","a00","a01","a02","a10","a20","b00","b01","b02","b10","b20","m8","m9","m10","m11","m12","m13","m14","m15","m16","m17","m18","m19","m20","m21","m22","m23","c02","c12","c20","c21","c22","mmulStrassen","y","r1","c1","r2","c2","embed","mat","cols","resultat","blockMult","halfRows","parseInt","halfCols","subMatrix","add","sub","scaleRows","scaled","scale","scaleColumns","transpose","sortRows","compareFunction","compareNumbers","sort","sortColumns","subMatrixRow","indices","subMatrixColumn","selection","trace","transposeView","rowView","columnView","flipRowView","flipColumnView","subMatrixView","selectionView","det","d","subMatrix0","subMatrix1","subMatrix2","determinant","pseudoInverse","EPSILON","svdSolution","autoTranspose","U","leftSingularVectors","V","rightSingularVectors","diagonal","checkDimensions","otherMatrix","negate","inplaceMethodWithArgs","staticMethodWithArgs","inplaceMethodWithOneArgScalar","inplaceMethodWithOneArgMatrix","inplaceMethodWithOneArg","staticMethodWithOneArg","inplaceOp","inplaceOpS","inplaceOpM","staticOp","inplaceMeth","staticMeth","methodsWithArgs","methodWithArg","args","inplaceMethWithArgs","staticMethWithArgs","tmplVar","inplaceMethod2","inplaceMethodS","inplaceMethodM","staticMethod2","lu","pivotVector","pivotSign","t","LUrowi","LUcolj","kmax","LU","isSingular","col","lowerTriangularMatrix","X","upperTriangularMatrix","pivotPermutationVector","solve","count","SingularValueDecomposition","nu","wantu","wantv","computeLeftSingularVectors","computeRightSingularVectors","swapped","e","work","nct","nrt","ks","f","cs","sn","kase","sp","spm1","epm1","sk","ek","g","pp","iter","eps","pow","tmp","condition","norm2","rank","tol","diagonalMatrix","Y","scols","Ls","VL","vrows","urows","VLU","solveForDiagonal","inverse","vcols","ucols","minMax","arithmeticMean","geometricMean","mul","logMean","lnsum","log","grandMean","means","samples","truncatedMean","percent","alreadySorted","harmonicMean","contraHarmonicMean","median","half","variance","unbiased","theMean","theVariance","standardDeviation","standardError","robustMeanAndStdev","stdev","averageDeviations","quartiles","quart","q1","ceil","q2","q3","pooledStandardDeviation","pooledVariance","vari","mode","itemCount","itemArray","indexOf","covariance","mean1","mean2","cov","skewness","s2","s3","dev","kurtosis","s4","entropy","weightedMean","weights","weightedStandardDeviation","weightedVariance","z","w","center","inPlace","standardize","standardDev","squaredEuclidean","euclidean","squared","ClusterLeaf","inherits","defOptions","out","fullClusterGenerator","conMat","opt","assign","clList","fullClusterGeneratorVector","conn","resultAsMatrix","clusterList","available","remaining","cluster","nextAv","toInclude","agnes","diana","for","getEquallySpacedData","SNV","Stat","coordArrayToPoints","dimensions","pointsArr","point","coordArrayToCoordMatrix","coordinatesArray","points","currentPoint","coordMatrixToCoordArray","coordMatrix","coodinatesArray","resultMatrix","pointsToCoordArray","applyDotProduct","firstVector","secondVector","largestVector","smallestVector","difference","dotProductApplied","input","factor","currentMin","coordMatrixToPoints","pointsToCoordMatrix","arrayStat","Infinity","l1","l2","dimension","N","theSum","product","theProduct","sum1","sum2","medians","modes","skew","kurt","standardDeviations","standardErrors","sqrtN","scatter","divisor","correlation","scores","zScores","cor","resultRow","sourceRow","isNaN","weightSum","weightedCovariance","s1","weightedScatter","reverse","xLength","isFinite","numberOfPoints","algorithm","variant","output","getEquallySpacedSlot","getEquallySpacedSmooth","step","halfStep","start","initialOriginalStep","lastOriginalStep","previousX","MIN_VALUE","previousY","nextX","nextY","currentValue","slope","intercept","sumAtMin","sumAtMax","getSlope","x0","y0","x1","y1","main","integral","lastStep","MAX_VALUE","frontOutsideSpectra","backOutsideSpectra","currentPoints","std","EigenvalueDecomposition","QrDecomposition","CholeskyDecomposition","inv","leftHandSide","rightHandSide","SVD","EVD","QR","CHO","defaultOptions","assumeSymmetric","tred2","tql2","H","ort","orthes","hqr2","realEigenvalues","imaginaryEigenvalues","eigenvectorMatrix","h","hh","dl1","c3","el1","tst1","nn","exshift","norm","ra","sa","vr","vi","notlast","cdivres","cdiv","xr","xi","yr","yi","qr","rdiag","nrm","Rdiag","isFullRank","orthogonalMatrix","positiveDefinite","Lrowj","Lrowk","L","B","distanceMatrix","simpleLink","cluster1","cluster2","disFun","completeLink","averageLink","centroidLink","dist","wardLink","disFunc","kind","isDistanceMatrix","len","dis","fdistance","sdistance","toFixed","dmin","clustered","int","filter","diff","obj","indCount","defaultCmp","heapify","heappop","heappush","heappushpop","heapreplace","insort","nlargest","nsmallest","updateItem","_siftdown","_siftup","lo","hi","item","lastelt","returnitem","_ref","_i","_j","_len","_ref1","_results","_results1","pos","elem","los","startpos","newitem","parent","parentpos","childpos","endpos","rightpos","pushpop","nodes","peek","contains","clear","insert","top","front","has","factory","define","getOwnPropertyDescriptors","keys","descriptors","getOwnPropertyDescriptor","formatRegExp","format","isString","objects","inspect","join","str","String","JSON","stringify","_","isNull","isObject","deprecate","fn","msg","process","noDeprecation","warned","deprecated","throwDeprecation","traceDeprecation","error","debugs","debugEnviron","debuglog","isUndefined","env","NODE_DEBUG","toUpperCase","test","pid","opts","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","customInspect","stylizeWithColor","formatValue","styles","styleType","style","arrayToHash","hash","val","recurseTimes","isFunction","ret","primitive","formatPrimitive","visibleKeys","getOwnPropertyNames","isError","formatError","isRegExp","toString","isDate","Date","base","braces","toUTCString","formatArray","map","formatProperty","reduceToSingleString","simple","isNumber","hasOwnProperty","match","split","line","substr","numLinesEst","reduce","prev","cur","ar","isNullOrUndefined","isSymbol","re","objectToString","isPrimitive","isBuffer","o","pad","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","origin","prop","kCustomPromisifiedSymbol","promisify","original","defineProperty","enumerable","writable","configurable","promiseResolve","promiseReject","promise","Promise","resolve","reject","err","setPrototypeOf","getPrototypeOf","defineProperties","custom","callbackifyOnRejected","reason","newReason","callbackify","callbackified","maybeCb","self","then","nextTick","rej","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","run","Item","title","browser","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","readUInt8","create","ctor","super_","TempCtor","distanceFn","x2","y2","splitting","Ci","Cj","ndist","intrDist","tree","ind","M","clId","rebel","C","sG","spl","fData","sData","primeFinder","nextPrime","largestPrime","FREE","FULL","REMOVED","defaultInitialCapacity","defaultMinLoadFactor","defaultMaxLoadFactor","table","state","minLoadFactor","maxLoadFactor","distinct","freeEntries","lowWaterMark","highWaterMark","capacity","chooseHighWaterMark","indexOfKey","indexOfInsertion","newCapacity","chooseGrowCapacity","rehash","noRehash","delete","chooseShrinkCapacity","containsKey","decrement","containsValue","indexOfValue","ensureCapacity","minCapacity","oldCapacity","oldTable","oldValues","oldState","newTable","newValues","newState","chooseLowWaterMark","element","forEachKey","forEachValue","minLoad","maxLoad","binarySearch","sortAsc","primeNumbers","SpinSystem","chemicalShifts","couplingConstants","multiplicity","nSpins","_initConnectivity","_initClusters","fromSpinusPrediction","lines","nspins","integrals","ids","jc","tokens","nCoup","withID","fromPrediction","predictions","ungroupAtoms","delta","atomIDs","assignment","coupling","prediction","pred","tempPred","parse","nmrJ","tempJ","nbAtoms","clusters","simpleClustering","connectivity","couplings","_calculateBetas","J","frequency","betas","ensureClusterSize","hlClust","_splitCluster","maxClusterSize","_mergeClusters","nClusters","force","_getMembers","members","nElements","clusterA","clusterB","common","createPauli","mult","spin","prjs","A","pauli2","getPauli","smallValue","simulate1d","spinSystem","lineWidth","nbPoints","frequencyMHz","noiseFactor","lineWidthPointsG","lineWidthPointsL","lnPoints","gaussianLength","gaussian","g2pi","PI","exp","withNoise","clusterFake","weight","sumI","frequencies","intensities","currentSize","hamiltonian","getHamiltonian","hamSize","evd","diagB","assignmentMatrix","multLen","tempMat","rhoip","rhoip2","tV","triuTimesAbs","valFreq","insertIn","numFreq","inte","addPeak","_getX","freq","height","indexLorentz","conMatrix","clusterHam","A1","B1","alpha","kronProd","pos2","S","A2","B2","kron1","dx","simule2DNmrSpectrum","fromLabel","fromAtomLabel","toLabel","frequencyX","frequencyY","lineWidthX","lineWidthY","symmetrize","sigmaX","sigmaY","minX","fromChemicalShift","maxX","minY","toChemicalShift","maxY","firstX","firstY","lastX","lastY","nbPointsX","nbPointsY","spectraMatrix","peak","unitsToArrayPoints","fromAtoms","toAtoms","widthX","widthY","nSigma","fromX","round","toX","fromY","toY","squareSigmaX","squareSigmaY","exponent"],"mappings":"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","file":"nmr-simulation.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"nmrSimulation\"] = factory();\n\telse\n\t\troot[\"nmrSimulation\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","const HashTable = require('ml-hash-table');\n\nclass SparseMatrix {\n    constructor(rows, columns, options = {}) {\n        if (rows instanceof SparseMatrix) { // clone\n            const other = rows;\n            this._init(other.rows, other.columns, other.elements.clone(), other.threshold);\n            return;\n        }\n\n        if (Array.isArray(rows)) {\n            const matrix = rows;\n            rows = matrix.length;\n            options = columns || {};\n            columns = matrix[0].length;\n            this._init(rows, columns, new HashTable(options), options.threshold);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    var value = matrix[i][j];\n                    if (this.threshold && Math.abs(value) < this.threshold) value = 0;\n                    if (value !== 0) {\n                        this.elements.set(i * columns + j, matrix[i][j]);\n                    }\n                }\n            }\n        } else {\n            this._init(rows, columns, new HashTable(options), options.threshold);\n        }\n    }\n\n    _init(rows, columns, elements, threshold) {\n        this.rows = rows;\n        this.columns = columns;\n        this.elements = elements;\n        this.threshold = threshold || 0;\n    }\n    \n    static eye(rows = 1, columns = rows) {\n        const min = Math.min(rows, columns);\n        const matrix = new SparseMatrix(rows, columns, {initialCapacity: min});\n        for (var i = 0; i < min; i++) {\n            matrix.set(i, i, 1);\n        }\n        return matrix;\n    }\n\n    clone() {\n        return new SparseMatrix(this);\n    }\n    \n    to2DArray() {\n        const copy = new Array(this.rows);\n        for (var i = 0; i < this.rows; i++) {\n            copy[i] = new Array(this.columns);\n            for (var j = 0; j < this.columns; j++) {\n                copy[i][j] = this.get(i, j);\n            }\n        }\n        return copy;\n    }\n\n    isSquare() {\n        return this.rows === this.columns;\n    }\n\n    isSymmetric() {\n        if (!this.isSquare()) return false;\n\n        var symmetric = true;\n        this.forEachNonZero((i, j, v) => {\n            if (this.get(j, i) !== v) {\n                symmetric = false;\n                return false;\n            }\n            return v;\n        });\n        return symmetric;\n    }\n\n    get cardinality() {\n        return this.elements.size;\n    }\n\n    get size() {\n        return this.rows * this.columns;\n    }\n\n    get(row, column) {\n        return this.elements.get(row * this.columns + column);\n    }\n\n    set(row, column, value) {\n        if (this.threshold && Math.abs(value) < this.threshold) value = 0;\n        if (value === 0) {\n            this.elements.remove(row * this.columns + column);\n        } else {\n            this.elements.set(row * this.columns + column, value);\n        }\n        return this;\n    }\n    \n    mmul(other) {\n        if (this.columns !== other.rows)\n            console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');\n        \n        const m = this.rows;\n        const p = other.columns;\n        \n        const result = new SparseMatrix(m, p);\n        this.forEachNonZero((i, j, v1) => {\n            other.forEachNonZero((k, l, v2) => {\n                if (j === k) {\n                    result.set(i, l, result.get(i, l) + v1 * v2);\n                }\n                return v2;\n            });\n            return v1;\n        });\n        return result;\n    }\n\n    kroneckerProduct(other) {\n        const m = this.rows;\n        const n = this.columns;\n        const p = other.rows;\n        const q = other.columns;\n\n        const result = new SparseMatrix(m * p, n * q, {\n            initialCapacity: this.cardinality * other.cardinality\n        });\n        this.forEachNonZero((i, j, v1) => {\n            other.forEachNonZero((k, l, v2) => {\n                result.set(p * i + k, q * j + l, v1 * v2);\n                return v2;\n            });\n            return v1;\n        });\n        return result;\n    }\n\n    forEachNonZero(callback) {\n        this.elements.forEachPair((key, value) => {\n            const i = (key / this.columns) | 0;\n            const j = key % this.columns;\n            let r = callback(i, j, value);\n            if (r === false) return false; // stop iteration\n            if (this.threshold && Math.abs(r) < this.threshold) r = 0;\n            if (r !== value) {\n                if (r === 0) {\n                    this.elements.remove(key, true);\n                } else {\n                    this.elements.set(key, r);\n                }\n            }\n            return true;\n        });\n        this.elements.maybeShrinkCapacity();\n        return this;\n    }\n\n    getNonZeros() {\n        const cardinality = this.cardinality;\n        const rows = new Array(cardinality);\n        const columns = new Array(cardinality);\n        const values = new Array(cardinality);\n        var idx = 0;\n        this.forEachNonZero((i, j, value) => {\n            rows[idx] = i;\n            columns[idx] = j;\n            values[idx] = value;\n            idx++;\n            return value;\n        });\n        return {rows, columns, values};\n    }\n\n    setThreshold(newThreshold) {\n        if (newThreshold !== 0 && newThreshold !== this.threshold) {\n            this.threshold = newThreshold;\n            this.forEachNonZero((i, j, v) => v);\n        }\n        return this;\n    }\n}\n\nSparseMatrix.prototype.klass = 'Matrix';\n\nSparseMatrix.identity = SparseMatrix.eye;\nSparseMatrix.prototype.tensorProduct = SparseMatrix.prototype.kroneckerProduct;\n\nmodule.exports = SparseMatrix;\n\n/*\n Add dynamically instance and static methods for mathematical operations\n */\n\nvar inplaceOperator = `\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n`;\n\nvar inplaceOperatorScalar = `\n(function %name%S(value) {\n    this.forEachNonZero((i, j, v) => v %op% value);\n    return this;\n})\n`;\n\nvar inplaceOperatorMatrix = `\n(function %name%M(matrix) {\n    matrix.forEachNonZero((i, j, v) => {\n        this.set(i, j, this.get(i, j) %op% v);\n        return v;\n    });\n    return this;\n})\n`;\n\nvar staticOperator = `\n(function %name%(matrix, value) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%(value);\n})\n`;\n\nvar inplaceMethod = `\n(function %name%() {\n    this.forEachNonZero((i, j, v) => %method%(v));\n    return this;\n})\n`;\n\nvar staticMethod = `\n(function %name%(matrix) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%();\n})\n`;\n\nvar operators = [\n    // Arithmetic operators\n    ['+', 'add'],\n    ['-', 'sub', 'subtract'],\n    ['*', 'mul', 'multiply'],\n    ['/', 'div', 'divide'],\n    ['%', 'mod', 'modulus'],\n    // Bitwise operators\n    ['&', 'and'],\n    ['|', 'or'],\n    ['^', 'xor'],\n    ['<<', 'leftShift'],\n    ['>>', 'signPropagatingRightShift'],\n    ['>>>', 'rightShift', 'zeroFillRightShift']\n];\n\nfor (var operator of operators) {\n    for (var i = 1; i < operator.length; i++) {\n        SparseMatrix.prototype[operator[i]] = eval(fillTemplateFunction(inplaceOperator, {name: operator[i], op: operator[0]}));\n        SparseMatrix.prototype[operator[i] + 'S'] = eval(fillTemplateFunction(inplaceOperatorScalar, {name: operator[i] + 'S', op: operator[0]}));\n        SparseMatrix.prototype[operator[i] + 'M'] = eval(fillTemplateFunction(inplaceOperatorMatrix, {name: operator[i] + 'M', op: operator[0]}));\n\n        SparseMatrix[operator[i]] = eval(fillTemplateFunction(staticOperator, {name: operator[i]}));\n    }\n}\n\nvar methods = [\n    ['~', 'not']\n];\n\n[\n    'abs', 'acos', 'acosh', 'asin', 'asinh', 'atan', 'atanh', 'cbrt', 'ceil',\n    'clz32', 'cos', 'cosh', 'exp', 'expm1', 'floor', 'fround', 'log', 'log1p',\n    'log10', 'log2', 'round', 'sign', 'sin', 'sinh', 'sqrt', 'tan', 'tanh', 'trunc'\n].forEach(function (mathMethod) {\n    methods.push(['Math.' + mathMethod, mathMethod]);\n});\n\nfor (var method of methods) {\n    for (var i = 1; i < method.length; i++) {\n        SparseMatrix.prototype[method[i]] = eval(fillTemplateFunction(inplaceMethod, {name: method[i], method: method[0]}));\n        SparseMatrix[method[i]] = eval(fillTemplateFunction(staticMethod, {name: method[i]}));\n    }\n}\n\nfunction fillTemplateFunction(template, values) {\n    for (var i in values) {\n        template = template.replace(new RegExp('%' + i + '%', 'g'), values[i]);\n    }\n    return template;\n}\n","'use strict';\n\nmodule.exports = require('./matrix').Matrix;\nmodule.exports.Decompositions = module.exports.DC = require('./decompositions');\n","'use strict';\n\nrequire('./symbol-species');\nvar abstractMatrix = require('./abstractMatrix');\nvar util = require('./util');\n\nclass Matrix extends abstractMatrix(Array) {\n    constructor(nRows, nColumns) {\n        var i;\n        if (arguments.length === 1 && typeof nRows === 'number') {\n            return new Array(nRows);\n        }\n        if (Matrix.isMatrix(nRows)) {\n            return nRows.clone();\n        } else if (Number.isInteger(nRows) && nRows > 0) { // Create an empty matrix\n            super(nRows);\n            if (Number.isInteger(nColumns) && nColumns > 0) {\n                for (i = 0; i < nRows; i++) {\n                    this[i] = new Array(nColumns);\n                }\n            } else {\n                throw new TypeError('nColumns must be a positive integer');\n            }\n        } else if (Array.isArray(nRows)) { // Copy the values from the 2D array\n            const matrix = nRows;\n            nRows = matrix.length;\n            nColumns = matrix[0].length;\n            if (typeof nColumns !== 'number' || nColumns === 0) {\n                throw new TypeError('Data must be a 2D array with at least one element');\n            }\n            super(nRows);\n            for (i = 0; i < nRows; i++) {\n                if (matrix[i].length !== nColumns) {\n                    throw new RangeError('Inconsistent array dimensions');\n                }\n                this[i] = [].concat(matrix[i]);\n            }\n        } else {\n            throw new TypeError('First argument must be a positive number or an array');\n        }\n        this.rows = nRows;\n        this.columns = nColumns;\n        return this;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this[rowIndex][columnIndex] = value;\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this[rowIndex][columnIndex];\n    }\n\n    /**\n     * Creates an exact and independent copy of the matrix\n     * @return {Matrix}\n     */\n    clone() {\n        var newMatrix = new this.constructor[Symbol.species](this.rows, this.columns);\n        for (var row = 0; row < this.rows; row++) {\n            for (var column = 0; column < this.columns; column++) {\n                newMatrix.set(row, column, this.get(row, column));\n            }\n        }\n        return newMatrix;\n    }\n\n    /**\n     * Removes a row from the given index\n     * @param {number} index - Row index\n     * @return {Matrix} this\n     */\n    removeRow(index) {\n        util.checkRowIndex(this, index);\n        if (this.rows === 1) {\n            throw new RangeError('A matrix cannot have less than one row');\n        }\n        this.splice(index, 1);\n        this.rows -= 1;\n        return this;\n    }\n\n    /**\n     * Adds a row at the given index\n     * @param {number} [index = this.rows] - Row index\n     * @param {Array|Matrix} array - Array or vector\n     * @return {Matrix} this\n     */\n    addRow(index, array) {\n        if (array === undefined) {\n            array = index;\n            index = this.rows;\n        }\n        util.checkRowIndex(this, index, true);\n        array = util.checkRowVector(this, array, true);\n        this.splice(index, 0, array);\n        this.rows += 1;\n        return this;\n    }\n\n    /**\n     * Removes a column from the given index\n     * @param {number} index - Column index\n     * @return {Matrix} this\n     */\n    removeColumn(index) {\n        util.checkColumnIndex(this, index);\n        if (this.columns === 1) {\n            throw new RangeError('A matrix cannot have less than one column');\n        }\n        for (var i = 0; i < this.rows; i++) {\n            this[i].splice(index, 1);\n        }\n        this.columns -= 1;\n        return this;\n    }\n\n    /**\n     * Adds a column at the given index\n     * @param {number} [index = this.columns] - Column index\n     * @param {Array|Matrix} array - Array or vector\n     * @return {Matrix} this\n     */\n    addColumn(index, array) {\n        if (typeof array === 'undefined') {\n            array = index;\n            index = this.columns;\n        }\n        util.checkColumnIndex(this, index, true);\n        array = util.checkColumnVector(this, array);\n        for (var i = 0; i < this.rows; i++) {\n            this[i].splice(index, 0, array[i]);\n        }\n        this.columns += 1;\n        return this;\n    }\n}\n\nexports.Matrix = Matrix;\nMatrix.abstractMatrix = abstractMatrix;\n","'use strict';\n\nvar abstractMatrix = require('../abstractMatrix');\nvar Matrix = require('../matrix');\n\nclass BaseView extends abstractMatrix() {\n    constructor(matrix, rows, columns) {\n        super();\n        this.matrix = matrix;\n        this.rows = rows;\n        this.columns = columns;\n    }\n\n    static get [Symbol.species]() {\n        return Matrix.Matrix;\n    }\n}\n\nmodule.exports = BaseView;\n","'use strict';\n\nvar Matrix = require('./matrix');\n\n/**\n * @private\n * Check that a row index is not out of bounds\n * @param {Matrix} matrix\n * @param {number} index\n * @param {boolean} [outer]\n */\nexports.checkRowIndex = function checkRowIndex(matrix, index, outer) {\n    var max = outer ? matrix.rows : matrix.rows - 1;\n    if (index < 0 || index > max) {\n        throw new RangeError('Row index out of range');\n    }\n};\n\n/**\n * @private\n * Check that a column index is not out of bounds\n * @param {Matrix} matrix\n * @param {number} index\n * @param {boolean} [outer]\n */\nexports.checkColumnIndex = function checkColumnIndex(matrix, index, outer) {\n    var max = outer ? matrix.columns : matrix.columns - 1;\n    if (index < 0 || index > max) {\n        throw new RangeError('Column index out of range');\n    }\n};\n\n/**\n * @private\n * Check that the provided vector is an array with the right length\n * @param {Matrix} matrix\n * @param {Array|Matrix} vector\n * @return {Array}\n * @throws {RangeError}\n */\nexports.checkRowVector = function checkRowVector(matrix, vector) {\n    if (vector.to1DArray) {\n        vector = vector.to1DArray();\n    }\n    if (vector.length !== matrix.columns) {\n        throw new RangeError('vector size must be the same as the number of columns');\n    }\n    return vector;\n};\n\n/**\n * @private\n * Check that the provided vector is an array with the right length\n * @param {Matrix} matrix\n * @param {Array|Matrix} vector\n * @return {Array}\n * @throws {RangeError}\n */\nexports.checkColumnVector = function checkColumnVector(matrix, vector) {\n    if (vector.to1DArray) {\n        vector = vector.to1DArray();\n    }\n    if (vector.length !== matrix.rows) {\n        throw new RangeError('vector size must be the same as the number of rows');\n    }\n    return vector;\n};\n\nexports.checkIndices = function checkIndices(matrix, rowIndices, columnIndices) {\n    var rowOut = rowIndices.some(r => {\n        return r < 0 || r >= matrix.rows;\n\n    });\n\n    var columnOut = columnIndices.some(c => {\n        return c < 0 || c >= matrix.columns;\n    });\n\n    if (rowOut || columnOut) {\n        throw new RangeError('Indices are out of range');\n    }\n\n    if (typeof rowIndices !== 'object' || typeof columnIndices !== 'object') {\n        throw new TypeError('Unexpected type for row/column indices');\n    }\n    if (!Array.isArray(rowIndices)) rowIndices = Array.from(rowIndices);\n    if (!Array.isArray(columnIndices)) rowIndices = Array.from(columnIndices);\n\n    return {\n        row: rowIndices,\n        column: columnIndices\n    };\n};\n\nexports.checkRange = function checkRange(matrix, startRow, endRow, startColumn, endColumn) {\n    if (arguments.length !== 5) throw new TypeError('Invalid argument type');\n    var notAllNumbers = Array.from(arguments).slice(1).some(function (arg) {\n        return typeof arg !== 'number';\n    });\n    if (notAllNumbers) throw new TypeError('Invalid argument type');\n    if (startRow > endRow || startColumn > endColumn || startRow < 0 || startRow >= matrix.rows || endRow < 0 || endRow >= matrix.rows || startColumn < 0 || startColumn >= matrix.columns || endColumn < 0 || endColumn >= matrix.columns) {\n        throw new RangeError('Submatrix indices are out of range');\n    }\n};\n\nexports.getRange = function getRange(from, to) {\n    var arr = new Array(to - from + 1);\n    for (var i = 0; i < arr.length; i++) {\n        arr[i] = from + i;\n    }\n    return arr;\n};\n\nexports.sumByRow = function sumByRow(matrix) {\n    var sum = Matrix.Matrix.zeros(matrix.rows, 1);\n    for (var i = 0; i < matrix.rows; ++i) {\n        for (var j = 0; j < matrix.columns; ++j) {\n            sum.set(i, 0, sum.get(i, 0) + matrix.get(i, j));\n        }\n    }\n    return sum;\n};\n\nexports.sumByColumn = function sumByColumn(matrix) {\n    var sum = Matrix.Matrix.zeros(1, matrix.columns);\n    for (var i = 0; i < matrix.rows; ++i) {\n        for (var j = 0; j < matrix.columns; ++j) {\n            sum.set(0, j, sum.get(0, j) + matrix.get(i, j));\n        }\n    }\n    return sum;\n};\n\nexports.sumAll = function sumAll(matrix) {\n    var v = 0;\n    for (var i = 0; i < matrix.rows; i++) {\n        for (var j = 0; j < matrix.columns; j++) {\n            v += matrix.get(i, j);\n        }\n    }\n    return v;\n};\n","'use strict';\nvar numberIsNan = require('number-is-nan');\n\nfunction assertNum(x) {\n\tif (typeof x !== 'number' || numberIsNan(x)) {\n\t\tthrow new TypeError('Expected a number');\n\t}\n}\n\nexports.asc = function (a, b) {\n\tassertNum(a);\n\tassertNum(b);\n\treturn a - b;\n};\n\nexports.desc = function (a, b) {\n\tassertNum(a);\n\tassertNum(b);\n\treturn b - a;\n};\n","'use strict';\n\nexports.hypotenuse = function hypotenuse(a, b) {\n    var r;\n    if (Math.abs(a) > Math.abs(b)) {\n        r = b / a;\n        return Math.abs(a) * Math.sqrt(1 + r * r);\n    }\n    if (b !== 0) {\n        r = a / b;\n        return Math.abs(b) * Math.sqrt(1 + r * r);\n    }\n    return 0;\n};\n\n// For use in the decomposition algorithms. With big matrices, access time is\n// too long on elements from array subclass\n// todo check when it is fixed in v8\n// http://jsperf.com/access-and-write-array-subclass\nexports.getEmpty2DArray = function (rows, columns) {\n    var array = new Array(rows);\n    for (var i = 0; i < rows; i++) {\n        array[i] = new Array(columns);\n    }\n    return array;\n};\n\nexports.getFilled2DArray = function (rows, columns, value) {\n    var array = new Array(rows);\n    for (var i = 0; i < rows; i++) {\n        array[i] = new Array(columns);\n        for (var j = 0; j < columns; j++) {\n            array[i][j] = value;\n        }\n    }\n    return array;\n};\n","'use strict';\n\nconst Heap = require('heap');\n\nfunction Cluster() {\n    this.children = [];\n    this.distance = -1;\n    this.index = [];\n}\n\n/**\n * Creates an array of values where maximum distance smaller than the threshold\n * @param {number} threshold\n * @return {Array <Cluster>}\n */\nCluster.prototype.cut = function (threshold) {\n    if (threshold < 0) throw new RangeError('Threshold too small');\n    var root = new Cluster();\n    root.children = this.children;\n    root.distance = this.distance;\n    root.index = this.index;\n    var list = [root];\n    var ans = [];\n    while (list.length > 0) {\n        var aux = list.shift();\n        if (threshold >= aux.distance) {\n            ans.push(aux);\n        } else {\n            list = list.concat(aux.children);\n        }\n    }\n    return ans;\n};\n\n/**\n * Merge the leaves in the minimum way to have 'minGroups' number of clusters\n * @param {number} minGroups - Them minimum number of children the first level of the tree should have\n * @return {Cluster}\n */\nCluster.prototype.group = function (minGroups) {\n    if (!Number.isInteger(minGroups) || minGroups < 1) throw new RangeError('Number of groups must be a positive integer');\n\n    const heap = new Heap(function (a, b) {\n        return b.distance - a.distance;\n    });\n\n    heap.push(this);\n\n    while (heap.size() < minGroups) {\n        var first = heap.pop();\n        if (first.children.length === 0) {\n            break;\n        }\n        first.children.forEach(child => heap.push(child));\n    }\n\n    var root = new Cluster();\n    root.children = heap.toArray();\n    root.distance = this.distance;\n\n    return root;\n};\n\n/**\n * Traverses the tree depth-first and provide callback to be called on each individual node\n * @param {function} cb - The callback to be called on each node encounter\n * @type {Cluster}\n */\nCluster.prototype.traverse = function (cb) {\n    function visit(root, callback) {\n        callback(root);\n        if (root.children) {\n            for (var i = root.children.length - 1; i >= 0; i--) {\n                visit(root.children[i], callback);\n            }\n        }\n    }\n    visit(this, cb);\n};\n\nmodule.exports = Cluster;\n","module.exports = newArray\n\nfunction newArray (n, value) {\n  n = n || 0\n  var array = new Array(n)\n  for (var i = 0; i < n; i++) {\n    array[i] = value\n  }\n  return array\n}\n","module.exports = function(haystack, needle, comparator, low, high) {\n  var mid, cmp;\n\n  if(low === undefined)\n    low = 0;\n\n  else {\n    low = low|0;\n    if(low < 0 || low >= haystack.length)\n      throw new RangeError(\"invalid lower bound\");\n  }\n\n  if(high === undefined)\n    high = haystack.length - 1;\n\n  else {\n    high = high|0;\n    if(high < low || high >= haystack.length)\n      throw new RangeError(\"invalid upper bound\");\n  }\n\n  while(low <= high) {\n    /* Note that \"(low + high) >>> 1\" may overflow, and results in a typecast\n     * to double (which gives the wrong results). */\n    mid = low + (high - low >> 1);\n    cmp = +comparator(haystack[mid], needle, mid, haystack);\n\n    /* Too low. */\n    if(cmp < 0.0)\n      low  = mid + 1;\n\n    /* Too high. */\n    else if(cmp > 0.0)\n      high = mid - 1;\n\n    /* Key found. */\n    else\n      return mid;\n  }\n\n  /* Key not found. */\n  return ~low;\n}\n","'use strict';\n\nmodule.exports = abstractMatrix;\n\nvar LuDecomposition = require('./dc/lu');\nvar SvDecomposition = require('./dc/svd');\nvar arrayUtils = require('ml-array-utils');\nvar util = require('./util');\nvar MatrixTransposeView = require('./views/transpose');\nvar MatrixRowView = require('./views/row');\nvar MatrixSubView = require('./views/sub');\nvar MatrixSelectionView = require('./views/selection');\nvar MatrixColumnView = require('./views/column');\nvar MatrixFlipRowView = require('./views/flipRow');\nvar MatrixFlipColumnView = require('./views/flipColumn');\n\nfunction abstractMatrix(superCtor) {\n    if (superCtor === undefined) superCtor = Object;\n\n    /**\n     * Real matrix\n     * @class Matrix\n     * @param {number|Array|Matrix} nRows - Number of rows of the new matrix,\n     * 2D array containing the data or Matrix instance to clone\n     * @param {number} [nColumns] - Number of columns of the new matrix\n     */\n    class Matrix extends superCtor {\n        static get [Symbol.species]() {\n            return this;\n        }\n\n        /**\n         * Constructs a Matrix with the chosen dimensions from a 1D array\n         * @param {number} newRows - Number of rows\n         * @param {number} newColumns - Number of columns\n         * @param {Array} newData - A 1D array containing data for the matrix\n         * @return {Matrix} - The new matrix\n         */\n        static from1DArray(newRows, newColumns, newData) {\n            var length = newRows * newColumns;\n            if (length !== newData.length) {\n                throw new RangeError('Data length does not match given dimensions');\n            }\n            var newMatrix = new this(newRows, newColumns);\n            for (var row = 0; row < newRows; row++) {\n                for (var column = 0; column < newColumns; column++) {\n                    newMatrix.set(row, column, newData[row * newColumns + column]);\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Creates a row vector, a matrix with only one row.\n         * @param {Array} newData - A 1D array containing data for the vector\n         * @return {Matrix} - The new matrix\n         */\n        static rowVector(newData) {\n            var vector = new this(1, newData.length);\n            for (var i = 0; i < newData.length; i++) {\n                vector.set(0, i, newData[i]);\n            }\n            return vector;\n        }\n\n        /**\n         * Creates a column vector, a matrix with only one column.\n         * @param {Array} newData - A 1D array containing data for the vector\n         * @return {Matrix} - The new matrix\n         */\n        static columnVector(newData) {\n            var vector = new this(newData.length, 1);\n            for (var i = 0; i < newData.length; i++) {\n                vector.set(i, 0, newData[i]);\n            }\n            return vector;\n        }\n\n        /**\n         * Creates an empty matrix with the given dimensions. Values will be undefined. Same as using new Matrix(rows, columns).\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @return {Matrix} - The new matrix\n         */\n        static empty(rows, columns) {\n            return new this(rows, columns);\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be set to zero.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @return {Matrix} - The new matrix\n         */\n        static zeros(rows, columns) {\n            return this.empty(rows, columns).fill(0);\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be set to one.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @return {Matrix} - The new matrix\n         */\n        static ones(rows, columns) {\n            return this.empty(rows, columns).fill(1);\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be randomly set.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @param {function} [rng=Math.random] - Random number generator\n         * @return {Matrix} The new matrix\n         */\n        static rand(rows, columns, rng) {\n            if (rng === undefined) rng = Math.random;\n            var matrix = this.empty(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    matrix.set(i, j, rng());\n                }\n            }\n            return matrix;\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be random integers.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @param {number} [maxValue=1000] - Maximum value\n         * @param {function} [rng=Math.random] - Random number generator\n         * @return {Matrix} The new matrix\n         */\n        static randInt(rows, columns, maxValue, rng) {\n            if (maxValue === undefined) maxValue = 1000;\n            if (rng === undefined) rng = Math.random;\n            var matrix = this.empty(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    var value = Math.floor(rng() * maxValue);\n                    matrix.set(i, j, value);\n                }\n            }\n            return matrix;\n        }\n\n        /**\n         * Creates an identity matrix with the given dimension. Values of the diagonal will be 1 and others will be 0.\n         * @param {number} rows - Number of rows\n         * @param {number} [columns=rows] - Number of columns\n         * @param {number} [value=1] - Value to fill the diagonal with\n         * @return {Matrix} - The new identity matrix\n         */\n        static eye(rows, columns, value) {\n            if (columns === undefined) columns = rows;\n            if (value === undefined) value = 1;\n            var min = Math.min(rows, columns);\n            var matrix = this.zeros(rows, columns);\n            for (var i = 0; i < min; i++) {\n                matrix.set(i, i, value);\n            }\n            return matrix;\n        }\n\n        /**\n         * Creates a diagonal matrix based on the given array.\n         * @param {Array} data - Array containing the data for the diagonal\n         * @param {number} [rows] - Number of rows (Default: data.length)\n         * @param {number} [columns] - Number of columns (Default: rows)\n         * @return {Matrix} - The new diagonal matrix\n         */\n        static diag(data, rows, columns) {\n            var l = data.length;\n            if (rows === undefined) rows = l;\n            if (columns === undefined) columns = rows;\n            var min = Math.min(l, rows, columns);\n            var matrix = this.zeros(rows, columns);\n            for (var i = 0; i < min; i++) {\n                matrix.set(i, i, data[i]);\n            }\n            return matrix;\n        }\n\n        /**\n         * Returns a matrix whose elements are the minimum between matrix1 and matrix2\n         * @param {Matrix} matrix1\n         * @param {Matrix} matrix2\n         * @return {Matrix}\n         */\n        static min(matrix1, matrix2) {\n            matrix1 = this.checkMatrix(matrix1);\n            matrix2 = this.checkMatrix(matrix2);\n            var rows = matrix1.rows;\n            var columns = matrix1.columns;\n            var result = new this(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    result.set(i, j, Math.min(matrix1.get(i, j), matrix2.get(i, j)));\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Returns a matrix whose elements are the maximum between matrix1 and matrix2\n         * @param {Matrix} matrix1\n         * @param {Matrix} matrix2\n         * @return {Matrix}\n         */\n        static max(matrix1, matrix2) {\n            matrix1 = this.checkMatrix(matrix1);\n            matrix2 = this.checkMatrix(matrix2);\n            var rows = matrix1.rows;\n            var columns = matrix1.columns;\n            var result = new this(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    result.set(i, j, Math.max(matrix1.get(i, j), matrix2.get(i, j)));\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Check that the provided value is a Matrix and tries to instantiate one if not\n         * @param {*} value - The value to check\n         * @return {Matrix}\n         */\n        static checkMatrix(value) {\n            return Matrix.isMatrix(value) ? value : new this(value);\n        }\n\n        /**\n         * Returns true if the argument is a Matrix, false otherwise\n         * @param {*} value - The value to check\n         * @return {boolean}\n         */\n        static isMatrix(value) {\n            return (value != null) && (value.klass === 'Matrix');\n        }\n\n        /**\n         * @prop {number} size - The number of elements in the matrix.\n         */\n        get size() {\n            return this.rows * this.columns;\n        }\n\n        /**\n         * Applies a callback for each element of the matrix. The function is called in the matrix (this) context.\n         * @param {function} callback - Function that will be called with two parameters : i (row) and j (column)\n         * @return {Matrix} this\n         */\n        apply(callback) {\n            if (typeof callback !== 'function') {\n                throw new TypeError('callback must be a function');\n            }\n            var ii = this.rows;\n            var jj = this.columns;\n            for (var i = 0; i < ii; i++) {\n                for (var j = 0; j < jj; j++) {\n                    callback.call(this, i, j);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Returns a new 1D array filled row by row with the matrix values\n         * @return {Array}\n         */\n        to1DArray() {\n            var array = new Array(this.size);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    array[i * this.columns + j] = this.get(i, j);\n                }\n            }\n            return array;\n        }\n\n        /**\n         * Returns a 2D array containing a copy of the data\n         * @return {Array}\n         */\n        to2DArray() {\n            var copy = new Array(this.rows);\n            for (var i = 0; i < this.rows; i++) {\n                copy[i] = new Array(this.columns);\n                for (var j = 0; j < this.columns; j++) {\n                    copy[i][j] = this.get(i, j);\n                }\n            }\n            return copy;\n        }\n\n        /**\n         * @return {boolean} true if the matrix has one row\n         */\n        isRowVector() {\n            return this.rows === 1;\n        }\n\n        /**\n         * @return {boolean} true if the matrix has one column\n         */\n        isColumnVector() {\n            return this.columns === 1;\n        }\n\n        /**\n         * @return {boolean} true if the matrix has one row or one column\n         */\n        isVector() {\n            return (this.rows === 1) || (this.columns === 1);\n        }\n\n        /**\n         * @return {boolean} true if the matrix has the same number of rows and columns\n         */\n        isSquare() {\n            return this.rows === this.columns;\n        }\n\n        /**\n         * @return {boolean} true if the matrix is square and has the same values on both sides of the diagonal\n         */\n        isSymmetric() {\n            if (this.isSquare()) {\n                for (var i = 0; i < this.rows; i++) {\n                    for (var j = 0; j <= i; j++) {\n                        if (this.get(i, j) !== this.get(j, i)) {\n                            return false;\n                        }\n                    }\n                }\n                return true;\n            }\n            return false;\n        }\n\n        /**\n         * Sets a given element of the matrix. mat.set(3,4,1) is equivalent to mat[3][4]=1\n         * @abstract\n         * @param {number} rowIndex - Index of the row\n         * @param {number} columnIndex - Index of the column\n         * @param {number} value - The new value for the element\n         * @return {Matrix} this\n         */\n        set(rowIndex, columnIndex, value) { // eslint-disable-line no-unused-vars\n            throw new Error('set method is unimplemented');\n        }\n\n        /**\n         * Returns the given element of the matrix. mat.get(3,4) is equivalent to matrix[3][4]\n         * @abstract\n         * @param {number} rowIndex - Index of the row\n         * @param {number} columnIndex - Index of the column\n         * @return {number}\n         */\n        get(rowIndex, columnIndex) { // eslint-disable-line no-unused-vars\n            throw new Error('get method is unimplemented');\n        }\n\n        /**\n         * Creates a new matrix that is a repetition of the current matrix. New matrix has rowRep times the number of\n         * rows of the matrix, and colRep times the number of columns of the matrix\n         * @param {number} rowRep - Number of times the rows should be repeated\n         * @param {number} colRep - Number of times the columns should be re\n         * @return {Matrix}\n         * @example\n         * var matrix = new Matrix([[1,2]]);\n         * matrix.repeat(2); // [[1,2],[1,2]]\n         */\n        repeat(rowRep, colRep) {\n            rowRep = rowRep || 1;\n            colRep = colRep || 1;\n            var matrix = new this.constructor[Symbol.species](this.rows * rowRep, this.columns * colRep);\n            for (var i = 0; i < rowRep; i++) {\n                for (var j = 0; j < colRep; j++) {\n                    matrix.setSubMatrix(this, this.rows * i, this.columns * j);\n                }\n            }\n            return matrix;\n        }\n\n        /**\n         * Fills the matrix with a given value. All elements will be set to this value.\n         * @param {number} value - New value\n         * @return {Matrix} this\n         */\n        fill(value) {\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, value);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Negates the matrix. All elements will be multiplied by (-1)\n         * @return {Matrix} this\n         */\n        neg() {\n            return this.mulS(-1);\n        }\n\n        /**\n         * Returns a new array from the given row index\n         * @param {number} index - Row index\n         * @return {Array}\n         */\n        getRow(index) {\n            util.checkRowIndex(this, index);\n            var row = new Array(this.columns);\n            for (var i = 0; i < this.columns; i++) {\n                row[i] = this.get(index, i);\n            }\n            return row;\n        }\n\n        /**\n         * Returns a new row vector from the given row index\n         * @param {number} index - Row index\n         * @return {Matrix}\n         */\n        getRowVector(index) {\n            return this.constructor.rowVector(this.getRow(index));\n        }\n\n        /**\n         * Sets a row at the given index\n         * @param {number} index - Row index\n         * @param {Array|Matrix} array - Array or vector\n         * @return {Matrix} this\n         */\n        setRow(index, array) {\n            util.checkRowIndex(this, index);\n            array = util.checkRowVector(this, array);\n            for (var i = 0; i < this.columns; i++) {\n                this.set(index, i, array[i]);\n            }\n            return this;\n        }\n\n        /**\n         * Swaps two rows\n         * @param {number} row1 - First row index\n         * @param {number} row2 - Second row index\n         * @return {Matrix} this\n         */\n        swapRows(row1, row2) {\n            util.checkRowIndex(this, row1);\n            util.checkRowIndex(this, row2);\n            for (var i = 0; i < this.columns; i++) {\n                var temp = this.get(row1, i);\n                this.set(row1, i, this.get(row2, i));\n                this.set(row2, i, temp);\n            }\n            return this;\n        }\n\n        /**\n         * Returns a new array from the given column index\n         * @param {number} index - Column index\n         * @return {Array}\n         */\n        getColumn(index) {\n            util.checkColumnIndex(this, index);\n            var column = new Array(this.rows);\n            for (var i = 0; i < this.rows; i++) {\n                column[i] = this.get(i, index);\n            }\n            return column;\n        }\n\n        /**\n         * Returns a new column vector from the given column index\n         * @param {number} index - Column index\n         * @return {Matrix}\n         */\n        getColumnVector(index) {\n            return this.constructor.columnVector(this.getColumn(index));\n        }\n\n        /**\n         * Sets a column at the given index\n         * @param {number} index - Column index\n         * @param {Array|Matrix} array - Array or vector\n         * @return {Matrix} this\n         */\n        setColumn(index, array) {\n            util.checkColumnIndex(this, index);\n            array = util.checkColumnVector(this, array);\n            for (var i = 0; i < this.rows; i++) {\n                this.set(i, index, array[i]);\n            }\n            return this;\n        }\n\n        /**\n         * Swaps two columns\n         * @param {number} column1 - First column index\n         * @param {number} column2 - Second column index\n         * @return {Matrix} this\n         */\n        swapColumns(column1, column2) {\n            util.checkColumnIndex(this, column1);\n            util.checkColumnIndex(this, column2);\n            for (var i = 0; i < this.rows; i++) {\n                var temp = this.get(i, column1);\n                this.set(i, column1, this.get(i, column2));\n                this.set(i, column2, temp);\n            }\n            return this;\n        }\n\n        /**\n         * Adds the values of a vector to each row\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        addRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) + vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Subtracts the values of a vector from each row\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        subRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) - vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a vector with each row\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        mulRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) * vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Divides the values of each row by those of a vector\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        divRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) / vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Adds the values of a vector to each column\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        addColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) + vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Subtracts the values of a vector from each column\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        subColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) - vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a vector with each column\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        mulColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) * vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Divides the values of each column by those of a vector\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        divColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) / vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a row with a scalar\n         * @param {number} index - Row index\n         * @param {number} value\n         * @return {Matrix} this\n         */\n        mulRow(index, value) {\n            util.checkRowIndex(this, index);\n            for (var i = 0; i < this.columns; i++) {\n                this.set(index, i, this.get(index, i) * value);\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a column with a scalar\n         * @param {number} index - Column index\n         * @param {number} value\n         * @return {Matrix} this\n         */\n        mulColumn(index, value) {\n            util.checkColumnIndex(this, index);\n            for (var i = 0; i < this.rows; i++) {\n                this.set(i, index, this.get(i, index) * value);\n            }\n            return this;\n        }\n\n        /**\n         * Returns the maximum value of the matrix\n         * @return {number}\n         */\n        max() {\n            var v = this.get(0, 0);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) > v) {\n                        v = this.get(i, j);\n                    }\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value\n         * @return {Array}\n         */\n        maxIndex() {\n            var v = this.get(0, 0);\n            var idx = [0, 0];\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) > v) {\n                        v = this.get(i, j);\n                        idx[0] = i;\n                        idx[1] = j;\n                    }\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the minimum value of the matrix\n         * @return {number}\n         */\n        min() {\n            var v = this.get(0, 0);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) < v) {\n                        v = this.get(i, j);\n                    }\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the minimum value\n         * @return {Array}\n         */\n        minIndex() {\n            var v = this.get(0, 0);\n            var idx = [0, 0];\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) < v) {\n                        v = this.get(i, j);\n                        idx[0] = i;\n                        idx[1] = j;\n                    }\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the maximum value of one row\n         * @param {number} row - Row index\n         * @return {number}\n         */\n        maxRow(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) > v) {\n                    v = this.get(row, i);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value of one row\n         * @param {number} row - Row index\n         * @return {Array}\n         */\n        maxRowIndex(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            var idx = [row, 0];\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) > v) {\n                    v = this.get(row, i);\n                    idx[1] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the minimum value of one row\n         * @param {number} row - Row index\n         * @return {number}\n         */\n        minRow(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) < v) {\n                    v = this.get(row, i);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value of one row\n         * @param {number} row - Row index\n         * @return {Array}\n         */\n        minRowIndex(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            var idx = [row, 0];\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) < v) {\n                    v = this.get(row, i);\n                    idx[1] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the maximum value of one column\n         * @param {number} column - Column index\n         * @return {number}\n         */\n        maxColumn(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) > v) {\n                    v = this.get(i, column);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value of one column\n         * @param {number} column - Column index\n         * @return {Array}\n         */\n        maxColumnIndex(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            var idx = [0, column];\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) > v) {\n                    v = this.get(i, column);\n                    idx[0] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the minimum value of one column\n         * @param {number} column - Column index\n         * @return {number}\n         */\n        minColumn(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) < v) {\n                    v = this.get(i, column);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the minimum value of one column\n         * @param {number} column - Column index\n         * @return {Array}\n         */\n        minColumnIndex(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            var idx = [0, column];\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) < v) {\n                    v = this.get(i, column);\n                    idx[0] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns an array containing the diagonal values of the matrix\n         * @return {Array}\n         */\n        diag() {\n            var min = Math.min(this.rows, this.columns);\n            var diag = new Array(min);\n            for (var i = 0; i < min; i++) {\n                diag[i] = this.get(i, i);\n            }\n            return diag;\n        }\n\n        /**\n         * Returns the sum by the argument given, if no argument given,\n         * it returns the sum of all elements of the matrix.\n         * @param {string} by - sum by 'row' or 'column'.\n         * @return {Matrix|number}\n         */\n        sum(by) {\n            switch (by) {\n                case 'row':\n                    return util.sumByRow(this);\n                case 'column':\n                    return util.sumByColumn(this);\n                default:\n                    return util.sumAll(this);\n            }\n        }\n\n        /**\n         * Returns the mean of all elements of the matrix\n         * @return {number}\n         */\n        mean() {\n            return this.sum() / this.size;\n        }\n\n        /**\n         * Returns the product of all elements of the matrix\n         * @return {number}\n         */\n        prod() {\n            var prod = 1;\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    prod *= this.get(i, j);\n                }\n            }\n            return prod;\n        }\n\n        /**\n         * Computes the cumulative sum of the matrix elements (in place, row by row)\n         * @return {Matrix} this\n         */\n        cumulativeSum() {\n            var sum = 0;\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    sum += this.get(i, j);\n                    this.set(i, j, sum);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Computes the dot (scalar) product between the matrix and another\n         * @param {Matrix} vector2 vector\n         * @return {number}\n         */\n        dot(vector2) {\n            if (Matrix.isMatrix(vector2)) vector2 = vector2.to1DArray();\n            var vector1 = this.to1DArray();\n            if (vector1.length !== vector2.length) {\n                throw new RangeError('vectors do not have the same size');\n            }\n            var dot = 0;\n            for (var i = 0; i < vector1.length; i++) {\n                dot += vector1[i] * vector2[i];\n            }\n            return dot;\n        }\n\n        /**\n         * Returns the matrix product between this and other\n         * @param {Matrix} other\n         * @return {Matrix}\n         */\n        mmul(other) {\n            other = this.constructor.checkMatrix(other);\n            if (this.columns !== other.rows) {\n                // eslint-disable-next-line no-console\n                console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');\n            }\n\n            var m = this.rows;\n            var n = this.columns;\n            var p = other.columns;\n\n            var result = new this.constructor[Symbol.species](m, p);\n\n            var Bcolj = new Array(n);\n            for (var j = 0; j < p; j++) {\n                for (var k = 0; k < n; k++) {\n                    Bcolj[k] = other.get(k, j);\n                }\n\n                for (var i = 0; i < m; i++) {\n                    var s = 0;\n                    for (k = 0; k < n; k++) {\n                        s += this.get(i, k) * Bcolj[k];\n                    }\n\n                    result.set(i, j, s);\n                }\n            }\n            return result;\n        }\n\n        strassen2x2(other) {\n            var result = new this.constructor[Symbol.species](2, 2);\n            const a11 = this.get(0, 0);\n            const b11 = other.get(0, 0);\n            const a12 = this.get(0, 1);\n            const b12 = other.get(0, 1);\n            const a21 = this.get(1, 0);\n            const b21 = other.get(1, 0);\n            const a22 = this.get(1, 1);\n            const b22 = other.get(1, 1);\n\n            // Compute intermediate values.\n            const m1 = (a11 + a22) * (b11 + b22);\n            const m2 = (a21 + a22) * b11;\n            const m3 = a11 * (b12 - b22);\n            const m4 = a22 * (b21 - b11);\n            const m5 = (a11 + a12) * b22;\n            const m6 = (a21 - a11) * (b11 + b12);\n            const m7 = (a12 - a22) * (b21 + b22);\n\n            // Combine intermediate values into the output.\n            const c00 = m1 + m4 - m5 + m7;\n            const c01 = m3 + m5;\n            const c10 = m2 + m4;\n            const c11 = m1 - m2 + m3 + m6;\n\n            result.set(0, 0, c00);\n            result.set(0, 1, c01);\n            result.set(1, 0, c10);\n            result.set(1, 1, c11);\n            return result;\n        }\n\n        strassen3x3(other) {\n            var result = new this.constructor[Symbol.species](3, 3);\n\n            const a00 = this.get(0, 0);\n            const a01 = this.get(0, 1);\n            const a02 = this.get(0, 2);\n            const a10 = this.get(1, 0);\n            const a11 = this.get(1, 1);\n            const a12 = this.get(1, 2);\n            const a20 = this.get(2, 0);\n            const a21 = this.get(2, 1);\n            const a22 = this.get(2, 2);\n\n            const b00 = other.get(0, 0);\n            const b01 = other.get(0, 1);\n            const b02 = other.get(0, 2);\n            const b10 = other.get(1, 0);\n            const b11 = other.get(1, 1);\n            const b12 = other.get(1, 2);\n            const b20 = other.get(2, 0);\n            const b21 = other.get(2, 1);\n            const b22 = other.get(2, 2);\n\n            const m1 = (a00 + a01 + a02 - a10 - a11 - a21 - a22) * b11;\n            const m2 = (a00 - a10) * (-b01 + b11);\n            const m3 = a11 * (-b00 + b01 + b10 - b11 - b12 - b20 + b22);\n            const m4 = (-a00 + a10 + a11) * (b00 - b01 + b11);\n            const m5 = (a10 + a11) * (-b00 + b01);\n            const m6 = a00 * b00;\n            const m7 = (-a00 + a20 + a21) * (b00 - b02 + b12);\n            const m8 = (-a00 + a20) * (b02 - b12);\n            const m9 = (a20 + a21) * (-b00 + b02);\n            const m10 = (a00 + a01 + a02 - a11 - a12 - a20 - a21) * b12;\n            const m11 = a21 * (-b00 + b02 + b10 - b11 - b12 - b20 + b21);\n            const m12 = (-a02 + a21 + a22) * (b11 + b20 - b21);\n            const m13 = (a02 - a22) * (b11 - b21);\n            const m14 = a02 * b20;\n            const m15 = (a21 + a22) * (-b20 + b21);\n            const m16 = (-a02 + a11 + a12) * (b12 + b20 - b22);\n            const m17 = (a02 - a12) * (b12 - b22);\n            const m18 = (a11 + a12) * (-b20 + b22);\n            const m19 = a01 * b10;\n            const m20 = a12 * b21;\n            const m21 = a10 * b02;\n            const m22 = a20 * b01;\n            const m23 = a22 * b22;\n\n            const c00 = m6 + m14 + m19;\n            const c01 = m1 + m4 + m5 + m6 + m12 + m14 + m15;\n            const c02 = m6 + m7 + m9 + m10 + m14 + m16 + m18;\n            const c10 = m2 + m3 + m4 + m6 + m14 + m16 + m17;\n            const c11 = m2 + m4 + m5 + m6 + m20;\n            const c12 = m14 + m16 + m17 + m18 + m21;\n            const c20 = m6 + m7 + m8 + m11 + m12 + m13 + m14;\n            const c21 = m12 + m13 + m14 + m15 + m22;\n            const c22 = m6 + m7 + m8 + m9 + m23;\n\n            result.set(0, 0, c00);\n            result.set(0, 1, c01);\n            result.set(0, 2, c02);\n            result.set(1, 0, c10);\n            result.set(1, 1, c11);\n            result.set(1, 2, c12);\n            result.set(2, 0, c20);\n            result.set(2, 1, c21);\n            result.set(2, 2, c22);\n            return result;\n        }\n\n        /**\n         * Returns the matrix product between x and y. More efficient than mmul(other) only when we multiply squared matrix and when the size of the matrix is > 1000.\n         * @param {Matrix} y\n         * @return {Matrix}\n         */\n        mmulStrassen(y) {\n            var x = this.clone();\n            var r1 = x.rows;\n            var c1 = x.columns;\n            var r2 = y.rows;\n            var c2 = y.columns;\n            if (c1 !== r2) {\n                // eslint-disable-next-line no-console\n                console.warn(`Multiplying ${r1} x ${c1} and ${r2} x ${c2} matrix: dimensions do not match.`);\n            }\n\n            // Put a matrix into the top left of a matrix of zeros.\n            // `rows` and `cols` are the dimensions of the output matrix.\n            function embed(mat, rows, cols) {\n                var r = mat.rows;\n                var c = mat.columns;\n                if ((r === rows) && (c === cols)) {\n                    return mat;\n                } else {\n                    var resultat = Matrix.zeros(rows, cols);\n                    resultat = resultat.setSubMatrix(mat, 0, 0);\n                    return resultat;\n                }\n            }\n\n\n            // Make sure both matrices are the same size.\n            // This is exclusively for simplicity:\n            // this algorithm can be implemented with matrices of different sizes.\n\n            var r = Math.max(r1, r2);\n            var c = Math.max(c1, c2);\n            x = embed(x, r, c);\n            y = embed(y, r, c);\n\n            // Our recursive multiplication function.\n            function blockMult(a, b, rows, cols) {\n                // For small matrices, resort to naive multiplication.\n                if (rows <= 512 || cols <= 512) {\n                    return a.mmul(b); // a is equivalent to this\n                }\n\n                // Apply dynamic padding.\n                if ((rows % 2 === 1) && (cols % 2 === 1)) {\n                    a = embed(a, rows + 1, cols + 1);\n                    b = embed(b, rows + 1, cols + 1);\n                } else if (rows % 2 === 1) {\n                    a = embed(a, rows + 1, cols);\n                    b = embed(b, rows + 1, cols);\n                } else if (cols % 2 === 1) {\n                    a = embed(a, rows, cols + 1);\n                    b = embed(b, rows, cols + 1);\n                }\n\n                var halfRows = parseInt(a.rows / 2);\n                var halfCols = parseInt(a.columns / 2);\n                // Subdivide input matrices.\n                var a11 = a.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n                var b11 = b.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n\n                var a12 = a.subMatrix(0, halfRows - 1, halfCols, a.columns - 1);\n                var b12 = b.subMatrix(0, halfRows - 1, halfCols, b.columns - 1);\n\n                var a21 = a.subMatrix(halfRows, a.rows - 1, 0, halfCols - 1);\n                var b21 = b.subMatrix(halfRows, b.rows - 1, 0, halfCols - 1);\n\n                var a22 = a.subMatrix(halfRows, a.rows - 1, halfCols, a.columns - 1);\n                var b22 = b.subMatrix(halfRows, b.rows - 1, halfCols, b.columns - 1);\n\n                // Compute intermediate values.\n                var m1 = blockMult(Matrix.add(a11, a22), Matrix.add(b11, b22), halfRows, halfCols);\n                var m2 = blockMult(Matrix.add(a21, a22), b11, halfRows, halfCols);\n                var m3 = blockMult(a11, Matrix.sub(b12, b22), halfRows, halfCols);\n                var m4 = blockMult(a22, Matrix.sub(b21, b11), halfRows, halfCols);\n                var m5 = blockMult(Matrix.add(a11, a12), b22, halfRows, halfCols);\n                var m6 = blockMult(Matrix.sub(a21, a11), Matrix.add(b11, b12), halfRows, halfCols);\n                var m7 = blockMult(Matrix.sub(a12, a22), Matrix.add(b21, b22), halfRows, halfCols);\n\n                // Combine intermediate values into the output.\n                var c11 = Matrix.add(m1, m4);\n                c11.sub(m5);\n                c11.add(m7);\n                var c12 = Matrix.add(m3, m5);\n                var c21 = Matrix.add(m2, m4);\n                var c22 = Matrix.sub(m1, m2);\n                c22.add(m3);\n                c22.add(m6);\n\n                //Crop output to the desired size (undo dynamic padding).\n                var resultat = Matrix.zeros(2 * c11.rows, 2 * c11.columns);\n                resultat = resultat.setSubMatrix(c11, 0, 0);\n                resultat = resultat.setSubMatrix(c12, c11.rows, 0);\n                resultat = resultat.setSubMatrix(c21, 0, c11.columns);\n                resultat = resultat.setSubMatrix(c22, c11.rows, c11.columns);\n                return resultat.subMatrix(0, rows - 1, 0, cols - 1);\n            }\n            return blockMult(x, y, r, c);\n        }\n\n        /**\n         * Returns a row-by-row scaled matrix\n         * @param {number} [min=0] - Minimum scaled value\n         * @param {number} [max=1] - Maximum scaled value\n         * @return {Matrix} - The scaled matrix\n         */\n        scaleRows(min, max) {\n            min = min === undefined ? 0 : min;\n            max = max === undefined ? 1 : max;\n            if (min >= max) {\n                throw new RangeError('min should be strictly smaller than max');\n            }\n            var newMatrix = this.constructor.empty(this.rows, this.columns);\n            for (var i = 0; i < this.rows; i++) {\n                var scaled = arrayUtils.scale(this.getRow(i), {min, max});\n                newMatrix.setRow(i, scaled);\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns a new column-by-column scaled matrix\n         * @param {number} [min=0] - Minimum scaled value\n         * @param {number} [max=1] - Maximum scaled value\n         * @return {Matrix} - The new scaled matrix\n         * @example\n         * var matrix = new Matrix([[1,2],[-1,0]]);\n         * var scaledMatrix = matrix.scaleColumns(); // [[1,1],[0,0]]\n         */\n        scaleColumns(min, max) {\n            min = min === undefined ? 0 : min;\n            max = max === undefined ? 1 : max;\n            if (min >= max) {\n                throw new RangeError('min should be strictly smaller than max');\n            }\n            var newMatrix = this.constructor.empty(this.rows, this.columns);\n            for (var i = 0; i < this.columns; i++) {\n                var scaled = arrayUtils.scale(this.getColumn(i), {\n                    min: min,\n                    max: max\n                });\n                newMatrix.setColumn(i, scaled);\n            }\n            return newMatrix;\n        }\n\n\n        /**\n         * Returns the Kronecker product (also known as tensor product) between this and other\n         * See https://en.wikipedia.org/wiki/Kronecker_product\n         * @param {Matrix} other\n         * @return {Matrix}\n         */\n        kroneckerProduct(other) {\n            other = this.constructor.checkMatrix(other);\n\n            var m = this.rows;\n            var n = this.columns;\n            var p = other.rows;\n            var q = other.columns;\n\n            var result = new this.constructor[Symbol.species](m * p, n * q);\n            for (var i = 0; i < m; i++) {\n                for (var j = 0; j < n; j++) {\n                    for (var k = 0; k < p; k++) {\n                        for (var l = 0; l < q; l++) {\n                            result[p * i + k][q * j + l] = this.get(i, j) * other.get(k, l);\n                        }\n                    }\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Transposes the matrix and returns a new one containing the result\n         * @return {Matrix}\n         */\n        transpose() {\n            var result = new this.constructor[Symbol.species](this.columns, this.rows);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    result.set(j, i, this.get(i, j));\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Sorts the rows (in place)\n         * @param {function} compareFunction - usual Array.prototype.sort comparison function\n         * @return {Matrix} this\n         */\n        sortRows(compareFunction) {\n            if (compareFunction === undefined) compareFunction = compareNumbers;\n            for (var i = 0; i < this.rows; i++) {\n                this.setRow(i, this.getRow(i).sort(compareFunction));\n            }\n            return this;\n        }\n\n        /**\n         * Sorts the columns (in place)\n         * @param {function} compareFunction - usual Array.prototype.sort comparison function\n         * @return {Matrix} this\n         */\n        sortColumns(compareFunction) {\n            if (compareFunction === undefined) compareFunction = compareNumbers;\n            for (var i = 0; i < this.columns; i++) {\n                this.setColumn(i, this.getColumn(i).sort(compareFunction));\n            }\n            return this;\n        }\n\n        /**\n         * Returns a subset of the matrix\n         * @param {number} startRow - First row index\n         * @param {number} endRow - Last row index\n         * @param {number} startColumn - First column index\n         * @param {number} endColumn - Last column index\n         * @return {Matrix}\n         */\n        subMatrix(startRow, endRow, startColumn, endColumn) {\n            util.checkRange(this, startRow, endRow, startColumn, endColumn);\n            var newMatrix = new this.constructor[Symbol.species](endRow - startRow + 1, endColumn - startColumn + 1);\n            for (var i = startRow; i <= endRow; i++) {\n                for (var j = startColumn; j <= endColumn; j++) {\n                    newMatrix[i - startRow][j - startColumn] = this.get(i, j);\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns a subset of the matrix based on an array of row indices\n         * @param {Array} indices - Array containing the row indices\n         * @param {number} [startColumn = 0] - First column index\n         * @param {number} [endColumn = this.columns-1] - Last column index\n         * @return {Matrix}\n         */\n        subMatrixRow(indices, startColumn, endColumn) {\n            if (startColumn === undefined) startColumn = 0;\n            if (endColumn === undefined) endColumn = this.columns - 1;\n            if ((startColumn > endColumn) || (startColumn < 0) || (startColumn >= this.columns) || (endColumn < 0) || (endColumn >= this.columns)) {\n                throw new RangeError('Argument out of range');\n            }\n\n            var newMatrix = new this.constructor[Symbol.species](indices.length, endColumn - startColumn + 1);\n            for (var i = 0; i < indices.length; i++) {\n                for (var j = startColumn; j <= endColumn; j++) {\n                    if (indices[i] < 0 || indices[i] >= this.rows) {\n                        throw new RangeError('Row index out of range: ' + indices[i]);\n                    }\n                    newMatrix.set(i, j - startColumn, this.get(indices[i], j));\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns a subset of the matrix based on an array of column indices\n         * @param {Array} indices - Array containing the column indices\n         * @param {number} [startRow = 0] - First row index\n         * @param {number} [endRow = this.rows-1] - Last row index\n         * @return {Matrix}\n         */\n        subMatrixColumn(indices, startRow, endRow) {\n            if (startRow === undefined) startRow = 0;\n            if (endRow === undefined) endRow = this.rows - 1;\n            if ((startRow > endRow) || (startRow < 0) || (startRow >= this.rows) || (endRow < 0) || (endRow >= this.rows)) {\n                throw new RangeError('Argument out of range');\n            }\n\n            var newMatrix = new this.constructor[Symbol.species](endRow - startRow + 1, indices.length);\n            for (var i = 0; i < indices.length; i++) {\n                for (var j = startRow; j <= endRow; j++) {\n                    if (indices[i] < 0 || indices[i] >= this.columns) {\n                        throw new RangeError('Column index out of range: ' + indices[i]);\n                    }\n                    newMatrix.set(j - startRow, i, this.get(j, indices[i]));\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Set a part of the matrix to the given sub-matrix\n         * @param {Matrix|Array< Array >} matrix - The source matrix from which to extract values.\n         * @param {number} startRow - The index of the first row to set\n         * @param {number} startColumn - The index of the first column to set\n         * @return {Matrix}\n         */\n        setSubMatrix(matrix, startRow, startColumn) {\n            matrix = this.constructor.checkMatrix(matrix);\n            var endRow = startRow + matrix.rows - 1;\n            var endColumn = startColumn + matrix.columns - 1;\n            util.checkRange(this, startRow, endRow, startColumn, endColumn);\n            for (var i = 0; i < matrix.rows; i++) {\n                for (var j = 0; j < matrix.columns; j++) {\n                    this[startRow + i][startColumn + j] = matrix.get(i, j);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Return a new matrix based on a selection of rows and columns\n         * @param {Array<number>} rowIndices - The row indices to select. Order matters and an index can be more than once.\n         * @param {Array<number>} columnIndices - The column indices to select. Order matters and an index can be use more than once.\n         * @return {Matrix} The new matrix\n         */\n        selection(rowIndices, columnIndices) {\n            var indices = util.checkIndices(this, rowIndices, columnIndices);\n            var newMatrix = new this.constructor[Symbol.species](rowIndices.length, columnIndices.length);\n            for (var i = 0; i < indices.row.length; i++) {\n                var rowIndex = indices.row[i];\n                for (var j = 0; j < indices.column.length; j++) {\n                    var columnIndex = indices.column[j];\n                    newMatrix[i][j] = this.get(rowIndex, columnIndex);\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns the trace of the matrix (sum of the diagonal elements)\n         * @return {number}\n         */\n        trace() {\n            var min = Math.min(this.rows, this.columns);\n            var trace = 0;\n            for (var i = 0; i < min; i++) {\n                trace += this.get(i, i);\n            }\n            return trace;\n        }\n\n        /*\n         Matrix views\n         */\n\n        /**\n         * Returns a view of the transposition of the matrix\n         * @return {MatrixTransposeView}\n         */\n        transposeView() {\n            return new MatrixTransposeView(this);\n        }\n\n        /**\n         * Returns a view of the row vector with the given index\n         * @param {number} row - row index of the vector\n         * @return {MatrixRowView}\n         */\n        rowView(row) {\n            util.checkRowIndex(this, row);\n            return new MatrixRowView(this, row);\n        }\n\n        /**\n         * Returns a view of the column vector with the given index\n         * @param {number} column - column index of the vector\n         * @return {MatrixColumnView}\n         */\n        columnView(column) {\n            util.checkColumnIndex(this, column);\n            return new MatrixColumnView(this, column);\n        }\n\n        /**\n         * Returns a view of the matrix flipped in the row axis\n         * @return {MatrixFlipRowView}\n         */\n        flipRowView() {\n            return new MatrixFlipRowView(this);\n        }\n\n        /**\n         * Returns a view of the matrix flipped in the column axis\n         * @return {MatrixFlipColumnView}\n         */\n        flipColumnView() {\n            return new MatrixFlipColumnView(this);\n        }\n\n        /**\n         * Returns a view of a submatrix giving the index boundaries\n         * @param {number} startRow - first row index of the submatrix\n         * @param {number} endRow - last row index of the submatrix\n         * @param {number} startColumn - first column index of the submatrix\n         * @param {number} endColumn - last column index of the submatrix\n         * @return {MatrixSubView}\n         */\n        subMatrixView(startRow, endRow, startColumn, endColumn) {\n            return new MatrixSubView(this, startRow, endRow, startColumn, endColumn);\n        }\n\n        /**\n         * Returns a view of the cross of the row indices and the column indices\n         * @example\n         * // resulting vector is [[2], [2]]\n         * var matrix = new Matrix([[1,2,3], [4,5,6]]).selectionView([0, 0], [1])\n         * @param {Array<number>} rowIndices\n         * @param {Array<number>} columnIndices\n         * @return {MatrixSelectionView}\n         */\n        selectionView(rowIndices, columnIndices) {\n            return new MatrixSelectionView(this, rowIndices, columnIndices);\n        }\n\n\n        /**\n        * Calculates and returns the determinant of a matrix as a Number\n        * @example\n        *   new Matrix([[1,2,3], [4,5,6]]).det()\n        * @return {number}\n        */\n        det() {\n            if (this.isSquare()) {\n                var a, b, c, d;\n                if (this.columns === 2) {\n                    // 2 x 2 matrix\n                    a = this.get(0, 0);\n                    b = this.get(0, 1);\n                    c = this.get(1, 0);\n                    d = this.get(1, 1);\n\n                    return a * d - (b * c);\n                } else if (this.columns === 3) {\n                    // 3 x 3 matrix\n                    var subMatrix0, subMatrix1, subMatrix2;\n                    subMatrix0 = this.selectionView([1, 2], [1, 2]);\n                    subMatrix1 = this.selectionView([1, 2], [0, 2]);\n                    subMatrix2 = this.selectionView([1, 2], [0, 1]);\n                    a = this.get(0, 0);\n                    b = this.get(0, 1);\n                    c = this.get(0, 2);\n\n                    return a * subMatrix0.det() - b * subMatrix1.det() + c * subMatrix2.det();\n                } else {\n                    // general purpose determinant using the LU decomposition\n                    return new LuDecomposition(this).determinant;\n                }\n\n            } else {\n                throw Error('Determinant can only be calculated for a square matrix.');\n            }\n        }\n\n        /**\n         * Returns inverse of a matrix if it exists or the pseudoinverse\n         * @param {number} threshold - threshold for taking inverse of singular values (default = 1e-15)\n         * @return {Matrix} the (pseudo)inverted matrix.\n         */\n        pseudoInverse(threshold) {\n            if (threshold === undefined) threshold = Number.EPSILON;\n            var svdSolution = new SvDecomposition(this, {autoTranspose: true});\n\n            var U = svdSolution.leftSingularVectors;\n            var V = svdSolution.rightSingularVectors;\n            var s = svdSolution.diagonal;\n\n            for (var i = 0; i < s.length; i++) {\n                if (Math.abs(s[i]) > threshold) {\n                    s[i] = 1.0 / s[i];\n                } else {\n                    s[i] = 0.0;\n                }\n            }\n\n            // convert list to diagonal\n            s = this.constructor[Symbol.species].diag(s);\n            return V.mmul(s.mmul(U.transposeView()));\n        }\n    }\n\n    Matrix.prototype.klass = 'Matrix';\n\n    /**\n     * @private\n     * Check that two matrices have the same dimensions\n     * @param {Matrix} matrix\n     * @param {Matrix} otherMatrix\n     */\n    function checkDimensions(matrix, otherMatrix) { // eslint-disable-line no-unused-vars\n        if (matrix.rows !== otherMatrix.rows ||\n            matrix.columns !== otherMatrix.columns) {\n            throw new RangeError('Matrices dimensions must be equal');\n        }\n    }\n\n    function compareNumbers(a, b) {\n        return a - b;\n    }\n\n    /*\n     Synonyms\n     */\n\n    Matrix.random = Matrix.rand;\n    Matrix.diagonal = Matrix.diag;\n    Matrix.prototype.diagonal = Matrix.prototype.diag;\n    Matrix.identity = Matrix.eye;\n    Matrix.prototype.negate = Matrix.prototype.neg;\n    Matrix.prototype.tensorProduct = Matrix.prototype.kroneckerProduct;\n    Matrix.prototype.determinant = Matrix.prototype.det;\n\n    /*\n     Add dynamically instance and static methods for mathematical operations\n     */\n\n    var inplaceOperator = `\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n`;\n\n    var inplaceOperatorScalar = `\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n`;\n\n    var inplaceOperatorMatrix = `\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n`;\n\n    var staticOperator = `\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n`;\n\n    var inplaceMethod = `\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n`;\n\n    var staticMethod = `\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n`;\n\n    var inplaceMethodWithArgs = `\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n`;\n\n    var staticMethodWithArgs = `\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n`;\n\n\n    var inplaceMethodWithOneArgScalar = `\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n`;\n    var inplaceMethodWithOneArgMatrix = `\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n`;\n\n    var inplaceMethodWithOneArg = `\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n`;\n\n    var staticMethodWithOneArg = staticMethodWithArgs;\n\n    var operators = [\n        // Arithmetic operators\n        ['+', 'add'],\n        ['-', 'sub', 'subtract'],\n        ['*', 'mul', 'multiply'],\n        ['/', 'div', 'divide'],\n        ['%', 'mod', 'modulus'],\n        // Bitwise operators\n        ['&', 'and'],\n        ['|', 'or'],\n        ['^', 'xor'],\n        ['<<', 'leftShift'],\n        ['>>', 'signPropagatingRightShift'],\n        ['>>>', 'rightShift', 'zeroFillRightShift']\n    ];\n\n    var i;\n\n    for (var operator of operators) {\n        var inplaceOp = eval(fillTemplateFunction(inplaceOperator, {name: operator[1], op: operator[0]}));\n        var inplaceOpS = eval(fillTemplateFunction(inplaceOperatorScalar, {name: operator[1] + 'S', op: operator[0]}));\n        var inplaceOpM = eval(fillTemplateFunction(inplaceOperatorMatrix, {name: operator[1] + 'M', op: operator[0]}));\n        var staticOp = eval(fillTemplateFunction(staticOperator, {name: operator[1]}));\n        for (i = 1; i < operator.length; i++) {\n            Matrix.prototype[operator[i]] = inplaceOp;\n            Matrix.prototype[operator[i] + 'S'] = inplaceOpS;\n            Matrix.prototype[operator[i] + 'M'] = inplaceOpM;\n            Matrix[operator[i]] = staticOp;\n        }\n    }\n\n    var methods = [\n        ['~', 'not']\n    ];\n\n    [\n        'abs', 'acos', 'acosh', 'asin', 'asinh', 'atan', 'atanh', 'cbrt', 'ceil',\n        'clz32', 'cos', 'cosh', 'exp', 'expm1', 'floor', 'fround', 'log', 'log1p',\n        'log10', 'log2', 'round', 'sign', 'sin', 'sinh', 'sqrt', 'tan', 'tanh', 'trunc'\n    ].forEach(function (mathMethod) {\n        methods.push(['Math.' + mathMethod, mathMethod]);\n    });\n\n    for (var method of methods) {\n        var inplaceMeth = eval(fillTemplateFunction(inplaceMethod, {name: method[1], method: method[0]}));\n        var staticMeth = eval(fillTemplateFunction(staticMethod, {name: method[1]}));\n        for (i = 1; i < method.length; i++) {\n            Matrix.prototype[method[i]] = inplaceMeth;\n            Matrix[method[i]] = staticMeth;\n        }\n    }\n\n    var methodsWithArgs = [\n        ['Math.pow', 1, 'pow']\n    ];\n\n    for (var methodWithArg of methodsWithArgs) {\n        var args = 'arg0';\n        for (i = 1; i < methodWithArg[1]; i++) {\n            args += `, arg${i}`;\n        }\n        if (methodWithArg[1] !== 1) {\n            var inplaceMethWithArgs = eval(fillTemplateFunction(inplaceMethodWithArgs, {\n                name: methodWithArg[2],\n                method: methodWithArg[0],\n                args: args\n            }));\n            var staticMethWithArgs = eval(fillTemplateFunction(staticMethodWithArgs, {name: methodWithArg[2], args: args}));\n            for (i = 2; i < methodWithArg.length; i++) {\n                Matrix.prototype[methodWithArg[i]] = inplaceMethWithArgs;\n                Matrix[methodWithArg[i]] = staticMethWithArgs;\n            }\n        } else {\n            var tmplVar = {\n                name: methodWithArg[2],\n                args: args,\n                method: methodWithArg[0]\n            };\n            var inplaceMethod2 = eval(fillTemplateFunction(inplaceMethodWithOneArg, tmplVar));\n            var inplaceMethodS = eval(fillTemplateFunction(inplaceMethodWithOneArgScalar, tmplVar));\n            var inplaceMethodM = eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix, tmplVar));\n            var staticMethod2 = eval(fillTemplateFunction(staticMethodWithOneArg, tmplVar));\n            for (i = 2; i < methodWithArg.length; i++) {\n                Matrix.prototype[methodWithArg[i]] = inplaceMethod2;\n                Matrix.prototype[methodWithArg[i] + 'M'] = inplaceMethodM;\n                Matrix.prototype[methodWithArg[i] + 'S'] = inplaceMethodS;\n                Matrix[methodWithArg[i]] = staticMethod2;\n            }\n        }\n    }\n\n    function fillTemplateFunction(template, values) {\n        for (var value in values) {\n            template = template.replace(new RegExp('%' + value + '%', 'g'), values[value]);\n        }\n        return template;\n    }\n\n    return Matrix;\n}\n","'use strict';\n\nvar Matrix = require('../matrix');\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/LuDecomposition.cs\nfunction LuDecomposition(matrix) {\n    if (!(this instanceof LuDecomposition)) {\n        return new LuDecomposition(matrix);\n    }\n\n    matrix = Matrix.Matrix.checkMatrix(matrix);\n\n    var lu = matrix.clone(),\n        rows = lu.rows,\n        columns = lu.columns,\n        pivotVector = new Array(rows),\n        pivotSign = 1,\n        i, j, k, p, s, t, v,\n        LUrowi, LUcolj, kmax;\n\n    for (i = 0; i < rows; i++) {\n        pivotVector[i] = i;\n    }\n\n    LUcolj = new Array(rows);\n\n    for (j = 0; j < columns; j++) {\n\n        for (i = 0; i < rows; i++) {\n            LUcolj[i] = lu[i][j];\n        }\n\n        for (i = 0; i < rows; i++) {\n            LUrowi = lu[i];\n            kmax = Math.min(i, j);\n            s = 0;\n            for (k = 0; k < kmax; k++) {\n                s += LUrowi[k] * LUcolj[k];\n            }\n            LUrowi[j] = LUcolj[i] -= s;\n        }\n\n        p = j;\n        for (i = j + 1; i < rows; i++) {\n            if (Math.abs(LUcolj[i]) > Math.abs(LUcolj[p])) {\n                p = i;\n            }\n        }\n\n        if (p !== j) {\n            for (k = 0; k < columns; k++) {\n                t = lu[p][k];\n                lu[p][k] = lu[j][k];\n                lu[j][k] = t;\n            }\n\n            v = pivotVector[p];\n            pivotVector[p] = pivotVector[j];\n            pivotVector[j] = v;\n\n            pivotSign = -pivotSign;\n        }\n\n        if (j < rows && lu[j][j] !== 0) {\n            for (i = j + 1; i < rows; i++) {\n                lu[i][j] /= lu[j][j];\n            }\n        }\n    }\n\n    this.LU = lu;\n    this.pivotVector = pivotVector;\n    this.pivotSign = pivotSign;\n}\n\nLuDecomposition.prototype = {\n    isSingular: function () {\n        var data = this.LU,\n            col = data.columns;\n        for (var j = 0; j < col; j++) {\n            if (data[j][j] === 0) {\n                return true;\n            }\n        }\n        return false;\n    },\n    get determinant() {\n        var data = this.LU;\n        if (!data.isSquare()) {\n            throw new Error('Matrix must be square');\n        }\n        var determinant = this.pivotSign, col = data.columns;\n        for (var j = 0; j < col; j++) {\n            determinant *= data[j][j];\n        }\n        return determinant;\n    },\n    get lowerTriangularMatrix() {\n        var data = this.LU,\n            rows = data.rows,\n            columns = data.columns,\n            X = new Matrix.Matrix(rows, columns);\n        for (var i = 0; i < rows; i++) {\n            for (var j = 0; j < columns; j++) {\n                if (i > j) {\n                    X[i][j] = data[i][j];\n                } else if (i === j) {\n                    X[i][j] = 1;\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n        return X;\n    },\n    get upperTriangularMatrix() {\n        var data = this.LU,\n            rows = data.rows,\n            columns = data.columns,\n            X = new Matrix.Matrix(rows, columns);\n        for (var i = 0; i < rows; i++) {\n            for (var j = 0; j < columns; j++) {\n                if (i <= j) {\n                    X[i][j] = data[i][j];\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n        return X;\n    },\n    get pivotPermutationVector() {\n        return this.pivotVector.slice();\n    },\n    solve: function (value) {\n        value = Matrix.Matrix.checkMatrix(value);\n\n        var lu = this.LU,\n            rows = lu.rows;\n\n        if (rows !== value.rows) {\n            throw new Error('Invalid matrix dimensions');\n        }\n        if (this.isSingular()) {\n            throw new Error('LU matrix is singular');\n        }\n\n        var count = value.columns;\n        var X = value.subMatrixRow(this.pivotVector, 0, count - 1);\n        var columns = lu.columns;\n        var i, j, k;\n\n        for (k = 0; k < columns; k++) {\n            for (i = k + 1; i < columns; i++) {\n                for (j = 0; j < count; j++) {\n                    X[i][j] -= X[k][j] * lu[i][k];\n                }\n            }\n        }\n        for (k = columns - 1; k >= 0; k--) {\n            for (j = 0; j < count; j++) {\n                X[k][j] /= lu[k][k];\n            }\n            for (i = 0; i < k; i++) {\n                for (j = 0; j < count; j++) {\n                    X[i][j] -= X[k][j] * lu[i][k];\n                }\n            }\n        }\n        return X;\n    }\n};\n\nmodule.exports = LuDecomposition;\n","'use strict';\n\nvar Matrix = require('../matrix');\nvar util = require('./util');\nvar hypotenuse = util.hypotenuse;\nvar getFilled2DArray = util.getFilled2DArray;\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/SingularValueDecomposition.cs\nfunction SingularValueDecomposition(value, options) {\n    if (!(this instanceof SingularValueDecomposition)) {\n        return new SingularValueDecomposition(value, options);\n    }\n    value = Matrix.Matrix.checkMatrix(value);\n\n    options = options || {};\n\n    var m = value.rows,\n        n = value.columns,\n        nu = Math.min(m, n);\n\n    var wantu = true, wantv = true;\n    if (options.computeLeftSingularVectors === false) wantu = false;\n    if (options.computeRightSingularVectors === false) wantv = false;\n    var autoTranspose = options.autoTranspose === true;\n\n    var swapped = false;\n    var a;\n    if (m < n) {\n        if (!autoTranspose) {\n            a = value.clone();\n            // eslint-disable-next-line no-console\n            console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');\n        } else {\n            a = value.transpose();\n            m = a.rows;\n            n = a.columns;\n            swapped = true;\n            var aux = wantu;\n            wantu = wantv;\n            wantv = aux;\n        }\n    } else {\n        a = value.clone();\n    }\n\n    var s = new Array(Math.min(m + 1, n)),\n        U = getFilled2DArray(m, nu, 0),\n        V = getFilled2DArray(n, n, 0),\n        e = new Array(n),\n        work = new Array(m);\n\n    var nct = Math.min(m - 1, n);\n    var nrt = Math.max(0, Math.min(n - 2, m));\n\n    var i, j, k, p, t, ks, f, cs, sn, max, kase,\n        scale, sp, spm1, epm1, sk, ek, b, c, shift, g;\n\n    for (k = 0, max = Math.max(nct, nrt); k < max; k++) {\n        if (k < nct) {\n            s[k] = 0;\n            for (i = k; i < m; i++) {\n                s[k] = hypotenuse(s[k], a[i][k]);\n            }\n            if (s[k] !== 0) {\n                if (a[k][k] < 0) {\n                    s[k] = -s[k];\n                }\n                for (i = k; i < m; i++) {\n                    a[i][k] /= s[k];\n                }\n                a[k][k] += 1;\n            }\n            s[k] = -s[k];\n        }\n\n        for (j = k + 1; j < n; j++) {\n            if ((k < nct) && (s[k] !== 0)) {\n                t = 0;\n                for (i = k; i < m; i++) {\n                    t += a[i][k] * a[i][j];\n                }\n                t = -t / a[k][k];\n                for (i = k; i < m; i++) {\n                    a[i][j] += t * a[i][k];\n                }\n            }\n            e[j] = a[k][j];\n        }\n\n        if (wantu && (k < nct)) {\n            for (i = k; i < m; i++) {\n                U[i][k] = a[i][k];\n            }\n        }\n\n        if (k < nrt) {\n            e[k] = 0;\n            for (i = k + 1; i < n; i++) {\n                e[k] = hypotenuse(e[k], e[i]);\n            }\n            if (e[k] !== 0) {\n                if (e[k + 1] < 0) {\n                    e[k] = 0 - e[k];\n                }\n                for (i = k + 1; i < n; i++) {\n                    e[i] /= e[k];\n                }\n                e[k + 1] += 1;\n            }\n            e[k] = -e[k];\n            if ((k + 1 < m) && (e[k] !== 0)) {\n                for (i = k + 1; i < m; i++) {\n                    work[i] = 0;\n                }\n                for (j = k + 1; j < n; j++) {\n                    for (i = k + 1; i < m; i++) {\n                        work[i] += e[j] * a[i][j];\n                    }\n                }\n                for (j = k + 1; j < n; j++) {\n                    t = -e[j] / e[k + 1];\n                    for (i = k + 1; i < m; i++) {\n                        a[i][j] += t * work[i];\n                    }\n                }\n            }\n            if (wantv) {\n                for (i = k + 1; i < n; i++) {\n                    V[i][k] = e[i];\n                }\n            }\n        }\n    }\n\n    p = Math.min(n, m + 1);\n    if (nct < n) {\n        s[nct] = a[nct][nct];\n    }\n    if (m < p) {\n        s[p - 1] = 0;\n    }\n    if (nrt + 1 < p) {\n        e[nrt] = a[nrt][p - 1];\n    }\n    e[p - 1] = 0;\n\n    if (wantu) {\n        for (j = nct; j < nu; j++) {\n            for (i = 0; i < m; i++) {\n                U[i][j] = 0;\n            }\n            U[j][j] = 1;\n        }\n        for (k = nct - 1; k >= 0; k--) {\n            if (s[k] !== 0) {\n                for (j = k + 1; j < nu; j++) {\n                    t = 0;\n                    for (i = k; i < m; i++) {\n                        t += U[i][k] * U[i][j];\n                    }\n                    t = -t / U[k][k];\n                    for (i = k; i < m; i++) {\n                        U[i][j] += t * U[i][k];\n                    }\n                }\n                for (i = k; i < m; i++) {\n                    U[i][k] = -U[i][k];\n                }\n                U[k][k] = 1 + U[k][k];\n                for (i = 0; i < k - 1; i++) {\n                    U[i][k] = 0;\n                }\n            } else {\n                for (i = 0; i < m; i++) {\n                    U[i][k] = 0;\n                }\n                U[k][k] = 1;\n            }\n        }\n    }\n\n    if (wantv) {\n        for (k = n - 1; k >= 0; k--) {\n            if ((k < nrt) && (e[k] !== 0)) {\n                for (j = k + 1; j < n; j++) {\n                    t = 0;\n                    for (i = k + 1; i < n; i++) {\n                        t += V[i][k] * V[i][j];\n                    }\n                    t = -t / V[k + 1][k];\n                    for (i = k + 1; i < n; i++) {\n                        V[i][j] += t * V[i][k];\n                    }\n                }\n            }\n            for (i = 0; i < n; i++) {\n                V[i][k] = 0;\n            }\n            V[k][k] = 1;\n        }\n    }\n\n    var pp = p - 1,\n        iter = 0,\n        eps = Math.pow(2, -52);\n    while (p > 0) {\n        for (k = p - 2; k >= -1; k--) {\n            if (k === -1) {\n                break;\n            }\n            if (Math.abs(e[k]) <= eps * (Math.abs(s[k]) + Math.abs(s[k + 1]))) {\n                e[k] = 0;\n                break;\n            }\n        }\n        if (k === p - 2) {\n            kase = 4;\n        } else {\n            for (ks = p - 1; ks >= k; ks--) {\n                if (ks === k) {\n                    break;\n                }\n                t = (ks !== p ? Math.abs(e[ks]) : 0) + (ks !== k + 1 ? Math.abs(e[ks - 1]) : 0);\n                if (Math.abs(s[ks]) <= eps * t) {\n                    s[ks] = 0;\n                    break;\n                }\n            }\n            if (ks === k) {\n                kase = 3;\n            } else if (ks === p - 1) {\n                kase = 1;\n            } else {\n                kase = 2;\n                k = ks;\n            }\n        }\n\n        k++;\n\n        switch (kase) {\n            case 1: {\n                f = e[p - 2];\n                e[p - 2] = 0;\n                for (j = p - 2; j >= k; j--) {\n                    t = hypotenuse(s[j], f);\n                    cs = s[j] / t;\n                    sn = f / t;\n                    s[j] = t;\n                    if (j !== k) {\n                        f = -sn * e[j - 1];\n                        e[j - 1] = cs * e[j - 1];\n                    }\n                    if (wantv) {\n                        for (i = 0; i < n; i++) {\n                            t = cs * V[i][j] + sn * V[i][p - 1];\n                            V[i][p - 1] = -sn * V[i][j] + cs * V[i][p - 1];\n                            V[i][j] = t;\n                        }\n                    }\n                }\n                break;\n            }\n            case 2 : {\n                f = e[k - 1];\n                e[k - 1] = 0;\n                for (j = k; j < p; j++) {\n                    t = hypotenuse(s[j], f);\n                    cs = s[j] / t;\n                    sn = f / t;\n                    s[j] = t;\n                    f = -sn * e[j];\n                    e[j] = cs * e[j];\n                    if (wantu) {\n                        for (i = 0; i < m; i++) {\n                            t = cs * U[i][j] + sn * U[i][k - 1];\n                            U[i][k - 1] = -sn * U[i][j] + cs * U[i][k - 1];\n                            U[i][j] = t;\n                        }\n                    }\n                }\n                break;\n            }\n            case 3 : {\n                scale = Math.max(Math.max(Math.max(Math.max(Math.abs(s[p - 1]), Math.abs(s[p - 2])), Math.abs(e[p - 2])), Math.abs(s[k])), Math.abs(e[k]));\n                sp = s[p - 1] / scale;\n                spm1 = s[p - 2] / scale;\n                epm1 = e[p - 2] / scale;\n                sk = s[k] / scale;\n                ek = e[k] / scale;\n                b = ((spm1 + sp) * (spm1 - sp) + epm1 * epm1) / 2;\n                c = (sp * epm1) * (sp * epm1);\n                shift = 0;\n                if ((b !== 0) || (c !== 0)) {\n                    shift = Math.sqrt(b * b + c);\n                    if (b < 0) {\n                        shift = -shift;\n                    }\n                    shift = c / (b + shift);\n                }\n                f = (sk + sp) * (sk - sp) + shift;\n                g = sk * ek;\n                for (j = k; j < p - 1; j++) {\n                    t = hypotenuse(f, g);\n                    cs = f / t;\n                    sn = g / t;\n                    if (j !== k) {\n                        e[j - 1] = t;\n                    }\n                    f = cs * s[j] + sn * e[j];\n                    e[j] = cs * e[j] - sn * s[j];\n                    g = sn * s[j + 1];\n                    s[j + 1] = cs * s[j + 1];\n                    if (wantv) {\n                        for (i = 0; i < n; i++) {\n                            t = cs * V[i][j] + sn * V[i][j + 1];\n                            V[i][j + 1] = -sn * V[i][j] + cs * V[i][j + 1];\n                            V[i][j] = t;\n                        }\n                    }\n                    t = hypotenuse(f, g);\n                    cs = f / t;\n                    sn = g / t;\n                    s[j] = t;\n                    f = cs * e[j] + sn * s[j + 1];\n                    s[j + 1] = -sn * e[j] + cs * s[j + 1];\n                    g = sn * e[j + 1];\n                    e[j + 1] = cs * e[j + 1];\n                    if (wantu && (j < m - 1)) {\n                        for (i = 0; i < m; i++) {\n                            t = cs * U[i][j] + sn * U[i][j + 1];\n                            U[i][j + 1] = -sn * U[i][j] + cs * U[i][j + 1];\n                            U[i][j] = t;\n                        }\n                    }\n                }\n                e[p - 2] = f;\n                iter = iter + 1;\n                break;\n            }\n            case 4: {\n                if (s[k] <= 0) {\n                    s[k] = (s[k] < 0 ? -s[k] : 0);\n                    if (wantv) {\n                        for (i = 0; i <= pp; i++) {\n                            V[i][k] = -V[i][k];\n                        }\n                    }\n                }\n                while (k < pp) {\n                    if (s[k] >= s[k + 1]) {\n                        break;\n                    }\n                    t = s[k];\n                    s[k] = s[k + 1];\n                    s[k + 1] = t;\n                    if (wantv && (k < n - 1)) {\n                        for (i = 0; i < n; i++) {\n                            t = V[i][k + 1];\n                            V[i][k + 1] = V[i][k];\n                            V[i][k] = t;\n                        }\n                    }\n                    if (wantu && (k < m - 1)) {\n                        for (i = 0; i < m; i++) {\n                            t = U[i][k + 1];\n                            U[i][k + 1] = U[i][k];\n                            U[i][k] = t;\n                        }\n                    }\n                    k++;\n                }\n                iter = 0;\n                p--;\n                break;\n            }\n            // no default\n        }\n    }\n\n    if (swapped) {\n        var tmp = V;\n        V = U;\n        U = tmp;\n    }\n\n    this.m = m;\n    this.n = n;\n    this.s = s;\n    this.U = U;\n    this.V = V;\n}\n\nSingularValueDecomposition.prototype = {\n    get condition() {\n        return this.s[0] / this.s[Math.min(this.m, this.n) - 1];\n    },\n    get norm2() {\n        return this.s[0];\n    },\n    get rank() {\n        var eps = Math.pow(2, -52),\n            tol = Math.max(this.m, this.n) * this.s[0] * eps,\n            r = 0,\n            s = this.s;\n        for (var i = 0, ii = s.length; i < ii; i++) {\n            if (s[i] > tol) {\n                r++;\n            }\n        }\n        return r;\n    },\n    get diagonal() {\n        return this.s;\n    },\n    // https://github.com/accord-net/framework/blob/development/Sources/Accord.Math/Decompositions/SingularValueDecomposition.cs\n    get threshold() {\n        return (Math.pow(2, -52) / 2) * Math.max(this.m, this.n) * this.s[0];\n    },\n    get leftSingularVectors() {\n        if (!Matrix.Matrix.isMatrix(this.U)) {\n            this.U = new Matrix.Matrix(this.U);\n        }\n        return this.U;\n    },\n    get rightSingularVectors() {\n        if (!Matrix.Matrix.isMatrix(this.V)) {\n            this.V = new Matrix.Matrix(this.V);\n        }\n        return this.V;\n    },\n    get diagonalMatrix() {\n        return Matrix.Matrix.diag(this.s);\n    },\n    solve: function (value) {\n\n        var Y = value,\n            e = this.threshold,\n            scols = this.s.length,\n            Ls = Matrix.Matrix.zeros(scols, scols),\n            i;\n\n        for (i = 0; i < scols; i++) {\n            if (Math.abs(this.s[i]) <= e) {\n                Ls[i][i] = 0;\n            } else {\n                Ls[i][i] = 1 / this.s[i];\n            }\n        }\n\n        var U = this.U;\n        var V = this.rightSingularVectors;\n\n        var VL = V.mmul(Ls),\n            vrows = V.rows,\n            urows = U.length,\n            VLU = Matrix.Matrix.zeros(vrows, urows),\n            j, k, sum;\n\n        for (i = 0; i < vrows; i++) {\n            for (j = 0; j < urows; j++) {\n                sum = 0;\n                for (k = 0; k < scols; k++) {\n                    sum += VL[i][k] * U[j][k];\n                }\n                VLU[i][j] = sum;\n            }\n        }\n\n        return VLU.mmul(Y);\n    },\n    solveForDiagonal: function (value) {\n        return this.solve(Matrix.Matrix.diag(value));\n    },\n    inverse: function () {\n        var V = this.V;\n        var e = this.threshold,\n            vrows = V.length,\n            vcols = V[0].length,\n            X = new Matrix.Matrix(vrows, this.s.length),\n            i, j;\n\n        for (i = 0; i < vrows; i++) {\n            for (j = 0; j < vcols; j++) {\n                if (Math.abs(this.s[j]) > e) {\n                    X[i][j] = V[i][j] / this.s[j];\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n\n        var U = this.U;\n\n        var urows = U.length,\n            ucols = U[0].length,\n            Y = new Matrix.Matrix(vrows, urows),\n            k, sum;\n\n        for (i = 0; i < vrows; i++) {\n            for (j = 0; j < urows; j++) {\n                sum = 0;\n                for (k = 0; k < ucols; k++) {\n                    sum += X[i][k] * U[j][k];\n                }\n                Y[i][j] = sum;\n            }\n        }\n\n        return Y;\n    }\n};\n\nmodule.exports = SingularValueDecomposition;\n","'use strict';\n\nexports.array = require('./array');\nexports.matrix = require('./matrix');\n","'use strict';\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\n/**\n * Computes the sum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.sum = function sum(values) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n        sum += values[i];\n    }\n    return sum;\n};\n\n/**\n * Computes the maximum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.max = function max(values) {\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] > max) max = values[i];\n    }\n    return max;\n};\n\n/**\n * Computes the minimum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.min = function min(values) {\n    var min = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n    }\n    return min;\n};\n\n/**\n * Computes the min and max of the given values\n * @param {Array} values\n * @returns {{min: number, max: number}}\n */\nexports.minMax = function minMax(values) {\n    var min = values[0];\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n        if (values[i] > max) max = values[i];\n    }\n    return {\n        min: min,\n        max: max\n    };\n};\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.arithmeticMean = function arithmeticMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        sum += values[i];\n    }\n    return sum / l;\n};\n\n/**\n * {@link arithmeticMean}\n */\nexports.mean = exports.arithmeticMean;\n\n/**\n * Computes the geometric mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.geometricMean = function geometricMean(values) {\n    var mul = 1;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        mul *= values[i];\n    }\n    return Math.pow(mul, 1 / l);\n};\n\n/**\n * Computes the mean of the log of the given values\n * If the return value is exponentiated, it gives the same result as the\n * geometric mean.\n * @param {Array} values\n * @returns {number}\n */\nexports.logMean = function logMean(values) {\n    var lnsum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        lnsum += Math.log(values[i]);\n    }\n    return lnsum / l;\n};\n\n/**\n * Computes the weighted grand mean for a list of means and sample sizes\n * @param {Array} means - Mean values for each set of samples\n * @param {Array} samples - Number of original values for each set of samples\n * @returns {number}\n */\nexports.grandMean = function grandMean(means, samples) {\n    var sum = 0;\n    var n = 0;\n    var l = means.length;\n    for (var i = 0; i < l; i++) {\n        sum += samples[i] * means[i];\n        n += samples[i];\n    }\n    return sum / n;\n};\n\n/**\n * Computes the truncated mean of the given values using a given percentage\n * @param {Array} values\n * @param {number} percent - The percentage of values to keep (range: [0,1])\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.truncatedMean = function truncatedMean(values, percent, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var k = Math.floor(l * percent);\n    var sum = 0;\n    for (var i = k; i < (l - k); i++) {\n        sum += values[i];\n    }\n    return sum / (l - 2 * k);\n};\n\n/**\n * Computes the harmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.harmonicMean = function harmonicMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] === 0) {\n            throw new RangeError('value at index ' + i + 'is zero');\n        }\n        sum += 1 / values[i];\n    }\n    return l / sum;\n};\n\n/**\n * Computes the contraharmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.contraHarmonicMean = function contraHarmonicMean(values) {\n    var r1 = 0;\n    var r2 = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        r1 += values[i] * values[i];\n        r2 += values[i];\n    }\n    if (r2 < 0) {\n        throw new RangeError('sum of values is negative');\n    }\n    return r1 / r2;\n};\n\n/**\n * Computes the median of the given values\n * @param {Array} values\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.median = function median(values, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var half = Math.floor(l / 2);\n    if (l % 2 === 0) {\n        return (values[half - 1] + values[half]) * 0.5;\n    } else {\n        return values[half];\n    }\n};\n\n/**\n * Computes the variance of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.variance = function variance(values, unbiased) {\n    if (unbiased === undefined) unbiased = true;\n    var theMean = exports.mean(values);\n    var theVariance = 0;\n    var l = values.length;\n\n    for (var i = 0; i < l; i++) {\n        var x = values[i] - theMean;\n        theVariance += x * x;\n    }\n\n    if (unbiased) {\n        return theVariance / (l - 1);\n    } else {\n        return theVariance / l;\n    }\n};\n\n/**\n * Computes the standard deviation of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.standardDeviation = function standardDeviation(values, unbiased) {\n    return Math.sqrt(exports.variance(values, unbiased));\n};\n\nexports.standardError = function standardError(values) {\n    return exports.standardDeviation(values) / Math.sqrt(values.length);\n};\n\n/**\n * IEEE Transactions on biomedical engineering, vol. 52, no. 1, january 2005, p. 76-\n * Calculate the standard deviation via the Median of the absolute deviation\n *  The formula for the standard deviation only holds for Gaussian random variables.\n * @returns {{mean: number, stdev: number}}\n */\nexports.robustMeanAndStdev = function robustMeanAndStdev(y) {\n    var mean = 0, stdev = 0;\n    var length = y.length, i = 0;\n    for (i = 0; i < length; i++) {\n        mean += y[i];\n    }\n    mean /= length;\n    var averageDeviations = new Array(length);\n    for (i = 0; i < length; i++)\n        averageDeviations[i] = Math.abs(y[i] - mean);\n    averageDeviations.sort(compareNumbers);\n    if (length % 2 === 1) {\n        stdev = averageDeviations[(length - 1) / 2] / 0.6745;\n    } else {\n        stdev = 0.5 * (averageDeviations[length / 2] + averageDeviations[length / 2 - 1]) / 0.6745;\n    }\n\n    return {\n        mean: mean,\n        stdev: stdev\n    };\n};\n\nexports.quartiles = function quartiles(values, alreadySorted) {\n    if (typeof (alreadySorted) === 'undefined') alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n\n    var quart = values.length / 4;\n    var q1 = values[Math.ceil(quart) - 1];\n    var q2 = exports.median(values, true);\n    var q3 = values[Math.ceil(quart * 3) - 1];\n\n    return {q1: q1, q2: q2, q3: q3};\n};\n\nexports.pooledStandardDeviation = function pooledStandardDeviation(samples, unbiased) {\n    return Math.sqrt(exports.pooledVariance(samples, unbiased));\n};\n\nexports.pooledVariance = function pooledVariance(samples, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var sum = 0;\n    var length = 0, l = samples.length;\n    for (var i = 0; i < l; i++) {\n        var values = samples[i];\n        var vari = exports.variance(values);\n\n        sum += (values.length - 1) * vari;\n\n        if (unbiased)\n            length += values.length - 1;\n        else\n            length += values.length;\n    }\n    return sum / length;\n};\n\nexports.mode = function mode(values) {\n    var l = values.length,\n        itemCount = new Array(l),\n        i;\n    for (i = 0; i < l; i++) {\n        itemCount[i] = 0;\n    }\n    var itemArray = new Array(l);\n    var count = 0;\n\n    for (i = 0; i < l; i++) {\n        var index = itemArray.indexOf(values[i]);\n        if (index >= 0)\n            itemCount[index]++;\n        else {\n            itemArray[count] = values[i];\n            itemCount[count] = 1;\n            count++;\n        }\n    }\n\n    var maxValue = 0, maxIndex = 0;\n    for (i = 0; i < count; i++) {\n        if (itemCount[i] > maxValue) {\n            maxValue = itemCount[i];\n            maxIndex = i;\n        }\n    }\n\n    return itemArray[maxIndex];\n};\n\nexports.covariance = function covariance(vector1, vector2, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var mean1 = exports.mean(vector1);\n    var mean2 = exports.mean(vector2);\n\n    if (vector1.length !== vector2.length)\n        throw 'Vectors do not have the same dimensions';\n\n    var cov = 0, l = vector1.length;\n    for (var i = 0; i < l; i++) {\n        var x = vector1[i] - mean1;\n        var y = vector2[i] - mean2;\n        cov += x * y;\n    }\n\n    if (unbiased)\n        return cov / (l - 1);\n    else\n        return cov / l;\n};\n\nexports.skewness = function skewness(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n\n    var s2 = 0, s3 = 0, l = values.length;\n    for (var i = 0; i < l; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s3 += dev * dev * dev;\n    }\n    var m2 = s2 / l;\n    var m3 = s3 / l;\n\n    var g = m3 / (Math.pow(m2, 3 / 2.0));\n    if (unbiased) {\n        var a = Math.sqrt(l * (l - 1));\n        var b = l - 2;\n        return (a / b) * g;\n    } else {\n        return g;\n    }\n};\n\nexports.kurtosis = function kurtosis(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n    var n = values.length, s2 = 0, s4 = 0;\n\n    for (var i = 0; i < n; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s4 += dev * dev * dev * dev;\n    }\n    var m2 = s2 / n;\n    var m4 = s4 / n;\n\n    if (unbiased) {\n        var v = s2 / (n - 1);\n        var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n        var b = s4 / (v * v);\n        var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n\n        return a * b - 3 * c;\n    } else {\n        return m4 / (m2 * m2) - 3;\n    }\n};\n\nexports.entropy = function entropy(values, eps) {\n    if (typeof (eps) === 'undefined') eps = 0;\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * Math.log(values[i] + eps);\n    return -sum;\n};\n\nexports.weightedMean = function weightedMean(values, weights) {\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * weights[i];\n    return sum;\n};\n\nexports.weightedStandardDeviation = function weightedStandardDeviation(values, weights) {\n    return Math.sqrt(exports.weightedVariance(values, weights));\n};\n\nexports.weightedVariance = function weightedVariance(values, weights) {\n    var theMean = exports.weightedMean(values, weights);\n    var vari = 0, l = values.length;\n    var a = 0, b = 0;\n\n    for (var i = 0; i < l; i++) {\n        var z = values[i] - theMean;\n        var w = weights[i];\n\n        vari += w * (z * z);\n        b += w;\n        a += w * w;\n    }\n\n    return vari * (b / (b * b - a));\n};\n\nexports.center = function center(values, inPlace) {\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n\n    var result = values;\n    if (!inPlace)\n        result = [].concat(values);\n\n    var theMean = exports.mean(result), l = result.length;\n    for (var i = 0; i < l; i++)\n        result[i] -= theMean;\n};\n\nexports.standardize = function standardize(values, standardDev, inPlace) {\n    if (typeof (standardDev) === 'undefined') standardDev = exports.standardDeviation(values);\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n    var l = values.length;\n    var result = inPlace ? values : new Array(l);\n    for (var i = 0; i < l; i++)\n        result[i] = values[i] / standardDev;\n    return result;\n};\n\nexports.cumulativeSum = function cumulativeSum(array) {\n    var l = array.length;\n    var result = new Array(l);\n    result[0] = array[0];\n    for (var i = 1; i < l; i++)\n        result[i] = result[i - 1] + array[i];\n    return result;\n};\n","'use strict';\n\nfunction squaredEuclidean(p, q) {\n    var d = 0;\n    for (var i = 0; i < p.length; i++) {\n        d += (p[i] - q[i]) * (p[i] - q[i]);\n    }\n    return d;\n}\n\nfunction euclidean(p, q) {\n    return Math.sqrt(squaredEuclidean(p, q));\n}\n\nmodule.exports = euclidean;\neuclidean.squared = squaredEuclidean;\n","'use strict';\n\nconst Cluster = require('./Cluster');\nconst util = require('util');\n\nfunction ClusterLeaf(index) {\n    Cluster.call(this);\n    this.index = index;\n    this.distance = 0;\n    this.children = [];\n}\n\nutil.inherits(ClusterLeaf, Cluster);\n\nmodule.exports = ClusterLeaf;\n","/**\n * Created by acastillo on 8/8/16.\n */\n'use strict';\n\nconst defOptions = {\n    threshold:0,\n    out:\"assignment\"\n};\n//TODO Consider a matrix of distances too\nmodule.exports = function fullClusterGenerator(conMat, opt) {\n    const options = Object.assign({}, defOptions, opt);\n    var clList, i, j, k;\n    if(typeof conMat[0] === \"number\"){\n        clList = fullClusterGeneratorVector(conMat);\n    }\n    else{\n        if(typeof conMat[0] === \"object\"){\n            var nRows = conMat.length;\n            var conn = new Array(nRows*(nRows+1)/2);\n            var index = 0;\n            for(var i=0;i<nRows;i++){\n                for(var j=i;j<nRows;j++){\n                    if(conMat[i][j]>options.threshold)\n                        conn[index++]= 1;\n                    else\n                        conn[index++]= 0;\n                }\n            }\n            clList = fullClusterGeneratorVector(conn);\n        }\n    }\n    if (options.out === \"indexes\" || options.out === \"values\") {\n        var result = new Array(clList.length);\n        for(i=0;i<clList.length;i++){\n            result[i] = [];\n            for(j=0;j<clList[i].length;j++){\n                if(clList[i][j] != 0){\n                    result[i].push(j);\n                }\n            }\n        }\n        if (options.out === \"values\") {\n            var resultAsMatrix = new Array(result.length);\n            for (i = 0; i<result.length;i++){\n                resultAsMatrix[i]=new Array(result[i].length);\n                for(j = 0; j < result[i].length; j++){\n                    resultAsMatrix[i][j]=new Array(result[i].length);\n                    for(k = 0; k < result[i].length; k++){\n                        resultAsMatrix[i][j][k]=conMat[result[i][j]][result[i][k]];\n                    }\n                }\n            }\n            return resultAsMatrix;\n        }\n        else{\n            return result;\n        }\n    }\n\n    return clList;\n\n}\n\nfunction fullClusterGeneratorVector(conn){\n    var nRows = Math.sqrt(conn.length*2+0.25)-0.5;\n    var clusterList = [];\n    var available = new Array(nRows);\n    var remaining = nRows, i=0;\n    var cluster = [];\n    //Mark all the elements as available\n    for(i=nRows-1;i>=0;i--){\n        available[i]=1;\n    }\n    var nextAv=-1;\n    var toInclude = [];\n    while(remaining>0){\n        if(toInclude.length===0){\n            //If there is no more elements to include. Start a new cluster\n            cluster = new Array(nRows);\n            for(i = 0;i < nRows ;i++)\n                cluster[i]=0;\n            clusterList.push(cluster);\n            for(nextAv = 0;available[nextAv]==0;nextAv++){};\n        }\n        else{\n            nextAv=toInclude.splice(0,1);\n        }\n        cluster[nextAv]=1;\n        available[nextAv]=0;\n        remaining--;\n        //Copy the next available row\n        var row = new Array(nRows);\n        for( i = 0;i < nRows;i++){\n            var c=Math.max(nextAv,i);\n            var r=Math.min(nextAv,i);\n            //The element in the conn matrix\n            //console.log(\"index: \"+r*(2*nRows-r-1)/2+c)\n            row[i]=conn[r*(2*nRows-r-1)/2+c];\n            //There is new elements to include in this row?\n            //Then, include it to the current cluster\n            if(row[i]==1&&available[i]==1&&cluster[i]==0){\n                toInclude.push(i);\n                cluster[i]=1;\n            }\n        }\n    }\n    return clusterList;\n}","'use strict';\n\nexports.agnes = require('./agnes');\nexports.diana = require('./diana');\n//exports.birch = require('./birch');\n//exports.cure = require('./cure');\n//exports.chameleon = require('./chameleon');\n","'use strict';\n\nmodule.exports = require('nmr-simulation');\n","'use strict';\n\nif (!Symbol.species) {\n    Symbol.species = Symbol.for('@@species');\n}\n","module.exports = exports = require('./ArrayUtils');\n\n\nexports.getEquallySpacedData = require('./getEquallySpaced').getEquallySpacedData;\nexports.SNV = require('./snv').SNV;\n","'use strict';\n\nconst Stat = require('ml-stat').array;\n/**\n * Function that returns an array of points given 1D array as follows:\n *\n * [x1, y1, .. , x2, y2, ..]\n *\n * And receive the number of dimensions of each point.\n * @param array\n * @param dimensions\n * @returns {Array} - Array of points.\n */\nfunction coordArrayToPoints(array, dimensions) {\n    if(array.length % dimensions !== 0) {\n        throw new RangeError('Dimensions number must be accordance with the size of the array.');\n    }\n\n    var length = array.length / dimensions;\n    var pointsArr = new Array(length);\n\n    var k = 0;\n    for(var i = 0; i < array.length; i += dimensions) {\n        var point = new Array(dimensions);\n        for(var j = 0; j < dimensions; ++j) {\n            point[j] = array[i + j];\n        }\n\n        pointsArr[k] = point;\n        k++;\n    }\n\n    return pointsArr;\n}\n\n\n/**\n * Function that given an array as follows:\n * [x1, y1, .. , x2, y2, ..]\n *\n * Returns an array as follows:\n * [[x1, x2, ..], [y1, y2, ..], [ .. ]]\n *\n * And receives the number of dimensions of each coordinate.\n * @param array\n * @param dimensions\n * @returns {Array} - Matrix of coordinates\n */\nfunction coordArrayToCoordMatrix(array, dimensions) {\n    if(array.length % dimensions !== 0) {\n        throw new RangeError('Dimensions number must be accordance with the size of the array.');\n    }\n\n    var coordinatesArray = new Array(dimensions);\n    var points = array.length / dimensions;\n    for (var i = 0; i < coordinatesArray.length; i++) {\n        coordinatesArray[i] = new Array(points);\n    }\n\n    for(i = 0; i < array.length; i += dimensions) {\n        for(var j = 0; j < dimensions; ++j) {\n            var currentPoint = Math.floor(i / dimensions);\n            coordinatesArray[j][currentPoint] = array[i + j];\n        }\n    }\n\n    return coordinatesArray;\n}\n\n/**\n * Function that receives a coordinate matrix as follows:\n * [[x1, x2, ..], [y1, y2, ..], [ .. ]]\n *\n * Returns an array of coordinates as follows:\n * [x1, y1, .. , x2, y2, ..]\n *\n * @param coordMatrix\n * @returns {Array}\n */\nfunction coordMatrixToCoordArray(coordMatrix) {\n    var coodinatesArray = new Array(coordMatrix.length * coordMatrix[0].length);\n    var k = 0;\n    for(var i = 0; i < coordMatrix[0].length; ++i) {\n        for(var j = 0; j < coordMatrix.length; ++j) {\n            coodinatesArray[k] = coordMatrix[j][i];\n            ++k;\n        }\n    }\n\n    return coodinatesArray;\n}\n\n/**\n * Tranpose a matrix, this method is for coordMatrixToPoints and\n * pointsToCoordMatrix, that because only transposing the matrix\n * you can change your representation.\n *\n * @param matrix\n * @returns {Array}\n */\nfunction transpose(matrix) {\n    var resultMatrix = new Array(matrix[0].length);\n    for(var i = 0; i < resultMatrix.length; ++i) {\n        resultMatrix[i] = new Array(matrix.length);\n    }\n\n    for (i = 0; i < matrix.length; ++i) {\n        for(var j = 0; j < matrix[0].length; ++j) {\n            resultMatrix[j][i] = matrix[i][j];\n        }\n    }\n\n    return resultMatrix;\n}\n\n/**\n * Function that transform an array of points into a coordinates array\n * as follows:\n * [x1, y1, .. , x2, y2, ..]\n *\n * @param points\n * @returns {Array}\n */\nfunction pointsToCoordArray(points) {\n    var coodinatesArray = new Array(points.length * points[0].length);\n    var k = 0;\n    for(var i = 0; i < points.length; ++i) {\n        for(var j = 0; j < points[0].length; ++j) {\n            coodinatesArray[k] = points[i][j];\n            ++k;\n        }\n    }\n\n    return coodinatesArray;\n}\n\n/**\n * Apply the dot product between the smaller vector and a subsets of the\n * largest one.\n *\n * @param firstVector\n * @param secondVector\n * @returns {Array} each dot product of size of the difference between the\n *                  larger and the smallest one.\n */\nfunction applyDotProduct(firstVector, secondVector) {\n    var largestVector, smallestVector;\n    if(firstVector.length <= secondVector.length) {\n        smallestVector = firstVector;\n        largestVector = secondVector;\n    } else {\n        smallestVector = secondVector;\n        largestVector = firstVector;\n    }\n\n    var difference = largestVector.length - smallestVector.length + 1;\n    var dotProductApplied = new Array(difference);\n\n    for (var i = 0; i < difference; ++i) {\n        var sum = 0;\n        for (var j = 0; j < smallestVector.length; ++j) {\n            sum += smallestVector[j] * largestVector[i + j];\n        }\n        dotProductApplied[i] = sum;\n    }\n\n    return dotProductApplied;\n}\n/**\n * To scale the input array between the specified min and max values. The operation is performed inplace\n * if the options.inplace is specified. If only one of the min or max parameters is specified, then the scaling\n * will multiply the input array by min/min(input) or max/max(input)\n * @param input\n * @param options\n * @returns {*}\n */\nfunction scale(input, options){\n    var y;\n    if(options.inPlace){\n        y = input;\n    }\n    else{\n        y = new Array(input.length);\n    }\n    const max = options.max;\n    const min = options.min;\n    if(typeof max === \"number\"){\n        if(typeof min === \"number\"){\n            var minMax = Stat.minMax(input);\n            var factor = (max - min)/(minMax.max-minMax.min);\n            for(var i=0;i< y.length;i++){\n                y[i]=(input[i]-minMax.min)*factor+min;\n            }\n        }\n        else{\n            var currentMin = Stat.max(input);\n            var factor = max/currentMin;\n            for(var i=0;i< y.length;i++){\n                y[i] = input[i]*factor;\n            }\n        }\n    }\n    else{\n        if(typeof min === \"number\"){\n            var currentMin = Stat.min(input);\n            var factor = min/currentMin;\n            for(var i=0;i< y.length;i++){\n                y[i] = input[i]*factor;\n            }\n        }\n    }\n    return y;\n}\n\nmodule.exports = {\n    coordArrayToPoints: coordArrayToPoints,\n    coordArrayToCoordMatrix: coordArrayToCoordMatrix,\n    coordMatrixToCoordArray: coordMatrixToCoordArray,\n    coordMatrixToPoints: transpose,\n    pointsToCoordArray: pointsToCoordArray,\n    pointsToCoordMatrix: transpose,\n    applyDotProduct: applyDotProduct,\n    scale:scale\n};\n\n","'use strict';\n\nvar arrayStat = require('./array');\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\nexports.max = function max(matrix) {\n    var max = -Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] > max) max = matrix[i][j];\n        }\n    }\n    return max;\n};\n\nexports.min = function min(matrix) {\n    var min = Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] < min) min = matrix[i][j];\n        }\n    }\n    return min;\n};\n\nexports.minMax = function minMax(matrix) {\n    var min = Infinity;\n    var max = -Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] < min) min = matrix[i][j];\n            if (matrix[i][j] > max) max = matrix[i][j];\n        }\n    }\n    return {\n        min:min,\n        max:max\n    };\n};\n\nexports.entropy = function entropy(matrix, eps) {\n    if (typeof (eps) === 'undefined') {\n        eps = 0;\n    }\n    var sum = 0,\n        l1 = matrix.length,\n        l2 = matrix[0].length;\n    for (var i = 0; i < l1; i++) {\n        for (var j = 0; j < l2; j++) {\n            sum += matrix[i][j] * Math.log(matrix[i][j] + eps);\n        }\n    }\n    return -sum;\n};\n\nexports.mean = function mean(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theMean, N, i, j;\n\n    if (dimension === -1) {\n        theMean = [0];\n        N = rows * cols;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theMean[0] += matrix[i][j];\n            }\n        }\n        theMean[0] /= N;\n    } else if (dimension === 0) {\n        theMean = new Array(cols);\n        N = rows;\n        for (j = 0; j < cols; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < rows; i++) {\n                theMean[j] += matrix[i][j];\n            }\n            theMean[j] /= N;\n        }\n    } else if (dimension === 1) {\n        theMean = new Array(rows);\n        N = cols;\n        for (j = 0; j < rows; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < cols; i++) {\n                theMean[j] += matrix[j][i];\n            }\n            theMean[j] /= N;\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theMean;\n};\n\nexports.sum = function sum(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theSum, i, j;\n\n    if (dimension === -1) {\n        theSum = [0];\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theSum[0] += matrix[i][j];\n            }\n        }\n    } else if (dimension === 0) {\n        theSum = new Array(cols);\n        for (j = 0; j < cols; j++) {\n            theSum[j] = 0;\n            for (i = 0; i < rows; i++) {\n                theSum[j] += matrix[i][j];\n            }\n        }\n    } else if (dimension === 1) {\n        theSum = new Array(rows);\n        for (j = 0; j < rows; j++) {\n            theSum[j] = 0;\n            for (i = 0; i < cols; i++) {\n                theSum[j] += matrix[j][i];\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theSum;\n};\n\nexports.product = function product(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theProduct, i, j;\n\n    if (dimension === -1) {\n        theProduct = [1];\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theProduct[0] *= matrix[i][j];\n            }\n        }\n    } else if (dimension === 0) {\n        theProduct = new Array(cols);\n        for (j = 0; j < cols; j++) {\n            theProduct[j] = 1;\n            for (i = 0; i < rows; i++) {\n                theProduct[j] *= matrix[i][j];\n            }\n        }\n    } else if (dimension === 1) {\n        theProduct = new Array(rows);\n        for (j = 0; j < rows; j++) {\n            theProduct[j] = 1;\n            for (i = 0; i < cols; i++) {\n                theProduct[j] *= matrix[j][i];\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theProduct;\n};\n\nexports.standardDeviation = function standardDeviation(matrix, means, unbiased) {\n    var vari = exports.variance(matrix, means, unbiased), l = vari.length;\n    for (var i = 0; i < l; i++) {\n        vari[i] = Math.sqrt(vari[i]);\n    }\n    return vari;\n};\n\nexports.variance = function variance(matrix, means, unbiased) {\n    if (typeof (unbiased) === 'undefined') {\n        unbiased = true;\n    }\n    means = means || exports.mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum1 = 0, sum2 = 0, x = 0;\n        for (var i = 0; i < rows; i++) {\n            x = matrix[i][j] - means[j];\n            sum1 += x;\n            sum2 += x * x;\n        }\n        if (unbiased) {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / (rows - 1);\n        } else {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / rows;\n        }\n    }\n    return vari;\n};\n\nexports.median = function median(matrix) {\n    var rows = matrix.length, cols = matrix[0].length;\n    var medians = new Array(cols);\n\n    for (var i = 0; i < cols; i++) {\n        var data = new Array(rows);\n        for (var j = 0; j < rows; j++) {\n            data[j] = matrix[j][i];\n        }\n        data.sort(compareNumbers);\n        var N = data.length;\n        if (N % 2 === 0) {\n            medians[i] = (data[N / 2] + data[(N / 2) - 1]) * 0.5;\n        } else {\n            medians[i] = data[Math.floor(N / 2)];\n        }\n    }\n    return medians;\n};\n\nexports.mode = function mode(matrix) {\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        modes = new Array(cols),\n        i, j;\n    for (i = 0; i < cols; i++) {\n        var itemCount = new Array(rows);\n        for (var k = 0; k < rows; k++) {\n            itemCount[k] = 0;\n        }\n        var itemArray = new Array(rows);\n        var count = 0;\n\n        for (j = 0; j < rows; j++) {\n            var index = itemArray.indexOf(matrix[j][i]);\n            if (index >= 0) {\n                itemCount[index]++;\n            } else {\n                itemArray[count] = matrix[j][i];\n                itemCount[count] = 1;\n                count++;\n            }\n        }\n\n        var maxValue = 0, maxIndex = 0;\n        for (j = 0; j < count; j++) {\n            if (itemCount[j] > maxValue) {\n                maxValue = itemCount[j];\n                maxIndex = j;\n            }\n        }\n\n        modes[i] = itemArray[maxIndex];\n    }\n    return modes;\n};\n\nexports.skewness = function skewness(matrix, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var means = exports.mean(matrix);\n    var n = matrix.length, l = means.length;\n    var skew = new Array(l);\n\n    for (var j = 0; j < l; j++) {\n        var s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s3 += dev * dev * dev;\n        }\n\n        var m2 = s2 / n;\n        var m3 = s3 / n;\n        var g = m3 / Math.pow(m2, 3 / 2);\n\n        if (unbiased) {\n            var a = Math.sqrt(n * (n - 1));\n            var b = n - 2;\n            skew[j] = (a / b) * g;\n        } else {\n            skew[j] = g;\n        }\n    }\n    return skew;\n};\n\nexports.kurtosis = function kurtosis(matrix, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var means = exports.mean(matrix);\n    var n = matrix.length, m = matrix[0].length;\n    var kurt = new Array(m);\n\n    for (var j = 0; j < m; j++) {\n        var s2 = 0, s4 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s4 += dev * dev * dev * dev;\n        }\n        var m2 = s2 / n;\n        var m4 = s4 / n;\n\n        if (unbiased) {\n            var v = s2 / (n - 1);\n            var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n            var b = s4 / (v * v);\n            var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n            kurt[j] = a * b - 3 * c;\n        } else {\n            kurt[j] = m4 / (m2 * m2) - 3;\n        }\n    }\n    return kurt;\n};\n\nexports.standardError = function standardError(matrix) {\n    var samples = matrix.length;\n    var standardDeviations = exports.standardDeviation(matrix);\n    var l = standardDeviations.length;\n    var standardErrors = new Array(l);\n    var sqrtN = Math.sqrt(samples);\n\n    for (var i = 0; i < l; i++) {\n        standardErrors[i] = standardDeviations[i] / sqrtN;\n    }\n    return standardErrors;\n};\n\nexports.covariance = function covariance(matrix, dimension) {\n    return exports.scatter(matrix, undefined, dimension);\n};\n\nexports.scatter = function scatter(matrix, divisor, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    if (typeof (divisor) === 'undefined') {\n        if (dimension === 0) {\n            divisor = matrix.length - 1;\n        } else if (dimension === 1) {\n            divisor = matrix[0].length - 1;\n        }\n    }\n    var means = exports.mean(matrix, dimension);\n    var rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, s, k;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n};\n\nexports.correlation = function correlation(matrix) {\n    var means = exports.mean(matrix),\n        standardDeviations = exports.standardDeviation(matrix, true, means),\n        scores = exports.zScores(matrix, means, standardDeviations),\n        rows = matrix.length,\n        cols = matrix[0].length,\n        i, j;\n\n    var cor = new Array(cols);\n    for (i = 0; i < cols; i++) {\n        cor[i] = new Array(cols);\n    }\n    for (i = 0; i < cols; i++) {\n        for (j = i; j < cols; j++) {\n            var c = 0;\n            for (var k = 0, l = scores.length; k < l; k++) {\n                c += scores[k][j] * scores[k][i];\n            }\n            c /= rows - 1;\n            cor[i][j] = c;\n            cor[j][i] = c;\n        }\n    }\n    return cor;\n};\n\nexports.zScores = function zScores(matrix, means, standardDeviations) {\n    means = means || exports.mean(matrix);\n    if (typeof (standardDeviations) === 'undefined') standardDeviations = exports.standardDeviation(matrix, true, means);\n    return exports.standardize(exports.center(matrix, means, false), standardDeviations, true);\n};\n\nexports.center = function center(matrix, means, inPlace) {\n    means = means || exports.mean(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var row = result[i];\n        for (j = 0, jj = row.length; j < jj; j++) {\n            row[j] = matrix[i][j] - means[j];\n        }\n    }\n    return result;\n};\n\nexports.standardize = function standardize(matrix, standardDeviations, inPlace) {\n    if (typeof (standardDeviations) === 'undefined') standardDeviations = exports.standardDeviation(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var resultRow = result[i];\n        var sourceRow = matrix[i];\n        for (j = 0, jj = resultRow.length; j < jj; j++) {\n            if (standardDeviations[j] !== 0 && !isNaN(standardDeviations[j])) {\n                resultRow[j] = sourceRow[j] / standardDeviations[j];\n            }\n        }\n    }\n    return result;\n};\n\nexports.weightedVariance = function weightedVariance(matrix, weights) {\n    var means = exports.mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum = 0;\n        var a = 0, b = 0;\n\n        for (var i = 0; i < rows; i++) {\n            var z = matrix[i][j] - means[j];\n            var w = weights[i];\n\n            sum += w * (z * z);\n            b += w;\n            a += w * w;\n        }\n\n        vari[j] = sum * (b / (b * b - a));\n    }\n\n    return vari;\n};\n\nexports.weightedMean = function weightedMean(matrix, weights, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length,\n        means, i, ii, j, w, row;\n\n    if (dimension === 0) {\n        means = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            means[i] = 0;\n        }\n        for (i = 0; i < rows; i++) {\n            row = matrix[i];\n            w = weights[i];\n            for (j = 0; j < cols; j++) {\n                means[j] += row[j] * w;\n            }\n        }\n    } else if (dimension === 1) {\n        means = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            means[i] = 0;\n        }\n        for (j = 0; j < rows; j++) {\n            row = matrix[j];\n            w = weights[j];\n            for (i = 0; i < cols; i++) {\n                means[j] += row[i] * w;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    var weightSum = arrayStat.sum(weights);\n    if (weightSum !== 0) {\n        for (i = 0, ii = means.length; i < ii; i++) {\n            means[i] /= weightSum;\n        }\n    }\n    return means;\n};\n\nexports.weightedCovariance = function weightedCovariance(matrix, weights, means, dimension) {\n    dimension = dimension || 0;\n    means = means || exports.weightedMean(matrix, weights, dimension);\n    var s1 = 0, s2 = 0;\n    for (var i = 0, ii = weights.length; i < ii; i++) {\n        s1 += weights[i];\n        s2 += weights[i] * weights[i];\n    }\n    var factor = s1 / (s1 * s1 - s2);\n    return exports.weightedScatter(matrix, weights, means, factor, dimension);\n};\n\nexports.weightedScatter = function weightedScatter(matrix, weights, means, factor, dimension) {\n    dimension = dimension || 0;\n    means = means || exports.weightedMean(matrix, weights, dimension);\n    if (typeof (factor) === 'undefined') {\n        factor = 1;\n    }\n    var rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, k, s;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += weights[k] * (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += weights[k] * (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n};\n","'use strict';\n\n/**\n *\n * Function that returns a Number array of equally spaced numberOfPoints\n * containing a representation of intensities of the spectra arguments x\n * and y.\n *\n * The options parameter contains an object in the following form:\n * from: starting point\n * to: last point\n * numberOfPoints: number of points between from and to\n * variant: \"slot\" or \"smooth\" - smooth is the default option\n *\n * The slot variant consist that each point in the new array is calculated\n * averaging the existing points between the slot that belongs to the current\n * value. The smooth variant is the same but takes the integral of the range\n * of the slot and divide by the step size between two points in the new array.\n *\n * @param x - sorted increasing x values\n * @param y\n * @param options\n * @returns {Array} new array with the equally spaced data.\n *\n */\nfunction getEquallySpacedData(x, y, options) {\n    if (x.length>1 && x[0]>x[1]) {\n        x=x.slice().reverse();\n        y=y.slice().reverse();\n    }\n\n    var xLength = x.length;\n    if(xLength !== y.length)\n        throw new RangeError(\"the x and y vector doesn't have the same size.\");\n\n    if (options === undefined) options = {};\n\n    var from = options.from === undefined ? x[0] : options.from\n    if (isNaN(from) || !isFinite(from)) {\n        throw new RangeError(\"'From' value must be a number\");\n    }\n    var to = options.to === undefined ? x[x.length - 1] : options.to;\n    if (isNaN(to) || !isFinite(to)) {\n        throw new RangeError(\"'To' value must be a number\");\n    }\n\n    var reverse = from > to;\n    if(reverse) {\n        var temp = from;\n        from = to;\n        to = temp;\n    }\n\n    var numberOfPoints = options.numberOfPoints === undefined ? 100 : options.numberOfPoints;\n    if (isNaN(numberOfPoints) || !isFinite(numberOfPoints)) {\n        throw new RangeError(\"'Number of points' value must be a number\");\n    }\n    if(numberOfPoints < 1)\n        throw new RangeError(\"the number of point must be higher than 1\");\n\n    var algorithm = options.variant === \"slot\" ? \"slot\" : \"smooth\"; // default value: smooth\n\n    var output = algorithm === \"slot\" ? getEquallySpacedSlot(x, y, from, to, numberOfPoints) : getEquallySpacedSmooth(x, y, from, to, numberOfPoints);\n\n    return reverse ? output.reverse() : output;\n}\n\n/**\n * function that retrieves the getEquallySpacedData with the variant \"smooth\"\n *\n * @param x\n * @param y\n * @param from - Initial point\n * @param to - Final point\n * @param numberOfPoints\n * @returns {Array} - Array of y's equally spaced with the variant \"smooth\"\n */\nfunction getEquallySpacedSmooth(x, y, from, to, numberOfPoints) {\n    var xLength = x.length;\n\n    var step = (to - from) / (numberOfPoints - 1);\n    var halfStep = step / 2;\n\n    var start = from - halfStep;\n    var output = new Array(numberOfPoints);\n\n    var initialOriginalStep = x[1] - x[0];\n    var lastOriginalStep = x[x.length - 1] - x[x.length - 2];\n\n    // Init main variables\n    var min = start;\n    var max = start + step;\n\n    var previousX = Number.MIN_VALUE;\n    var previousY = 0;\n    var nextX = x[0] - initialOriginalStep;\n    var nextY = 0;\n\n    var currentValue = 0;\n    var slope = 0;\n    var intercept = 0;\n    var sumAtMin = 0;\n    var sumAtMax = 0;\n\n    var i = 0; // index of input\n    var j = 0; // index of output\n\n    function getSlope(x0, y0, x1, y1) {\n        return (y1 - y0) / (x1 - x0);\n    }\n\n    main: while(true) {\n        while (nextX - max >= 0) {\n            // no overlap with original point, just consume current value\n            var add = integral(0, max - previousX, slope, previousY);\n            sumAtMax = currentValue + add;\n\n            output[j] = (sumAtMax - sumAtMin) / step;\n            j++;\n\n            if (j === numberOfPoints)\n                break main;\n\n            min = max;\n            max += step;\n            sumAtMin = sumAtMax;\n        }\n\n        if(previousX <= min && min <= nextX) {\n            add = integral(0, min - previousX, slope, previousY);\n            sumAtMin = currentValue + add;\n        }\n\n        currentValue += integral(previousX, nextX, slope, intercept);\n\n        previousX = nextX;\n        previousY = nextY;\n\n        if (i < xLength) {\n            nextX = x[i];\n            nextY = y[i];\n            i++;\n        } else if (i === xLength) {\n            nextX += lastOriginalStep;\n            nextY = 0;\n        }\n        // updating parameters\n        slope = getSlope(previousX, previousY, nextX, nextY);\n        intercept = -slope*previousX + previousY;\n    }\n\n    return output;\n}\n\n/**\n * function that retrieves the getEquallySpacedData with the variant \"slot\"\n *\n * @param x\n * @param y\n * @param from - Initial point\n * @param to - Final point\n * @param numberOfPoints\n * @returns {Array} - Array of y's equally spaced with the variant \"slot\"\n */\nfunction getEquallySpacedSlot(x, y, from, to, numberOfPoints) {\n    var xLength = x.length;\n\n    var step = (to - from) / (numberOfPoints - 1);\n    var halfStep = step / 2;\n    var lastStep = x[x.length - 1] - x[x.length - 2];\n\n    var start = from - halfStep;\n    var output = new Array(numberOfPoints);\n\n    // Init main variables\n    var min = start;\n    var max = start + step;\n\n    var previousX = -Number.MAX_VALUE;\n    var previousY = 0;\n    var nextX = x[0];\n    var nextY = y[0];\n    var frontOutsideSpectra = 0;\n    var backOutsideSpectra = true;\n\n    var currentValue = 0;\n\n    // for slot algorithm\n    var currentPoints = 0;\n\n    var i = 1; // index of input\n    var j = 0; // index of output\n\n    main: while(true) {\n        if (previousX>=nextX) throw (new Error('x must be an increasing serie'));\n        while (previousX - max > 0) {\n            // no overlap with original point, just consume current value\n            if(backOutsideSpectra) {\n                currentPoints++;\n                backOutsideSpectra = false;\n            }\n\n            output[j] = currentPoints <= 0 ? 0 : currentValue / currentPoints;\n            j++;\n\n            if (j === numberOfPoints)\n                break main;\n\n            min = max;\n            max += step;\n            currentValue = 0;\n            currentPoints = 0;\n        }\n\n        if(previousX > min) {\n            currentValue += previousY;\n            currentPoints++;\n        }\n\n        if(previousX === -Number.MAX_VALUE || frontOutsideSpectra > 1)\n            currentPoints--;\n\n        previousX = nextX;\n        previousY = nextY;\n\n        if (i < xLength) {\n            nextX = x[i];\n            nextY = y[i];\n            i++;\n        } else {\n            nextX += lastStep;\n            nextY = 0;\n            frontOutsideSpectra++;\n        }\n    }\n\n    return output;\n}\n/**\n * Function that calculates the integral of the line between two\n * x-coordinates, given the slope and intercept of the line.\n *\n * @param x0\n * @param x1\n * @param slope\n * @param intercept\n * @returns {number} integral value.\n */\nfunction integral(x0, x1, slope, intercept) {\n    return (0.5 * slope * x1 * x1 + intercept * x1) - (0.5 * slope * x0 * x0 + intercept * x0);\n}\n\nexports.getEquallySpacedData = getEquallySpacedData;\nexports.integral = integral;","'use strict';\n\nexports.SNV = SNV;\nvar Stat = require('ml-stat').array;\n\n/**\n * Function that applies the standard normal variate (SNV) to an array of values.\n *\n * @param data - Array of values.\n * @returns {Array} - applied the SNV.\n */\nfunction SNV(data) {\n    var mean = Stat.mean(data);\n    var std = Stat.standardDeviation(data);\n    var result = data.slice();\n    for (var i = 0; i < data.length; i++) {\n        result[i] = (result[i] - mean) / std;\n    }\n    return result;\n}\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixTransposeView extends BaseView {\n    constructor(matrix) {\n        super(matrix, matrix.columns, matrix.rows);\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(columnIndex, rowIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(columnIndex, rowIndex);\n    }\n}\n\nmodule.exports = MatrixTransposeView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixRowView extends BaseView {\n    constructor(matrix, row) {\n        super(matrix, 1, matrix.columns);\n        this.row = row;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.row, columnIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.row, columnIndex);\n    }\n}\n\nmodule.exports = MatrixRowView;\n","'use strict';\n\nvar BaseView = require('./base');\nvar util = require('../util');\n\nclass MatrixSubView extends BaseView {\n    constructor(matrix, startRow, endRow, startColumn, endColumn) {\n        util.checkRange(matrix, startRow, endRow, startColumn, endColumn);\n        super(matrix, endRow - startRow + 1, endColumn - startColumn + 1);\n        this.startRow = startRow;\n        this.startColumn = startColumn;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.startRow + rowIndex, this.startColumn + columnIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.startRow + rowIndex, this.startColumn + columnIndex);\n    }\n}\n\nmodule.exports = MatrixSubView;\n","'use strict';\n\nvar BaseView = require('./base');\nvar util = require('../util');\n\nclass MatrixSelectionView extends BaseView {\n    constructor(matrix, rowIndices, columnIndices) {\n        var indices = util.checkIndices(matrix, rowIndices, columnIndices);\n        super(matrix, indices.row.length, indices.column.length);\n        this.rowIndices = indices.row;\n        this.columnIndices = indices.column;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.rowIndices[rowIndex], this.columnIndices[columnIndex], value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.rowIndices[rowIndex], this.columnIndices[columnIndex]);\n    }\n}\n\nmodule.exports = MatrixSelectionView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixColumnView extends BaseView {\n    constructor(matrix, column) {\n        super(matrix, matrix.rows, 1);\n        this.column = column;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(rowIndex, this.column, value);\n        return this;\n    }\n\n    get(rowIndex) {\n        return this.matrix.get(rowIndex, this.column);\n    }\n}\n\nmodule.exports = MatrixColumnView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixFlipRowView extends BaseView {\n    constructor(matrix) {\n        super(matrix, matrix.rows, matrix.columns);\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.rows - rowIndex - 1, columnIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.rows - rowIndex - 1, columnIndex);\n    }\n}\n\nmodule.exports = MatrixFlipRowView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixFlipColumnView extends BaseView {\n    constructor(matrix) {\n        super(matrix, matrix.rows, matrix.columns);\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(rowIndex, this.columns - columnIndex - 1, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(rowIndex, this.columns - columnIndex - 1);\n    }\n}\n\nmodule.exports = MatrixFlipColumnView;\n","'use strict';\n\nvar Matrix = require('./matrix').Matrix;\n\nvar SingularValueDecomposition = require('./dc/svd');\nvar EigenvalueDecomposition = require('./dc/evd');\nvar LuDecomposition = require('./dc/lu');\nvar QrDecomposition = require('./dc/qr');\nvar CholeskyDecomposition = require('./dc/cholesky');\n\nfunction inverse(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    return solve(matrix, Matrix.eye(matrix.rows));\n}\n\n/**\n * Returns the inverse\n * @memberOf Matrix\n * @static\n * @param {Matrix} matrix\n * @return {Matrix} matrix\n * @alias inv\n */\nMatrix.inverse = Matrix.inv = inverse;\n\n/**\n * Returns the inverse\n * @memberOf Matrix\n * @static\n * @param {Matrix} matrix\n * @return {Matrix} matrix\n * @alias inv\n */\nMatrix.prototype.inverse = Matrix.prototype.inv = function () {\n    return inverse(this);\n};\n\nfunction solve(leftHandSide, rightHandSide) {\n    leftHandSide = Matrix.checkMatrix(leftHandSide);\n    rightHandSide = Matrix.checkMatrix(rightHandSide);\n    return leftHandSide.isSquare() ? new LuDecomposition(leftHandSide).solve(rightHandSide) : new QrDecomposition(leftHandSide).solve(rightHandSide);\n}\n\nMatrix.solve = solve;\nMatrix.prototype.solve = function (other) {\n    return solve(this, other);\n};\n\nmodule.exports = {\n    SingularValueDecomposition: SingularValueDecomposition,\n    SVD: SingularValueDecomposition,\n    EigenvalueDecomposition: EigenvalueDecomposition,\n    EVD: EigenvalueDecomposition,\n    LuDecomposition: LuDecomposition,\n    LU: LuDecomposition,\n    QrDecomposition: QrDecomposition,\n    QR: QrDecomposition,\n    CholeskyDecomposition: CholeskyDecomposition,\n    CHO: CholeskyDecomposition,\n    inverse: inverse,\n    solve: solve\n};\n","'use strict';\n\nconst Matrix = require('../matrix').Matrix;\nconst util = require('./util');\nconst hypotenuse = util.hypotenuse;\nconst getFilled2DArray = util.getFilled2DArray;\n\nconst defaultOptions = {\n    assumeSymmetric: false\n};\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/EigenvalueDecomposition.cs\nfunction EigenvalueDecomposition(matrix, options) {\n    options = Object.assign({}, defaultOptions, options);\n    if (!(this instanceof EigenvalueDecomposition)) {\n        return new EigenvalueDecomposition(matrix, options);\n    }\n    matrix = Matrix.checkMatrix(matrix);\n    if (!matrix.isSquare()) {\n        throw new Error('Matrix is not a square matrix');\n    }\n\n    var n = matrix.columns,\n        V = getFilled2DArray(n, n, 0),\n        d = new Array(n),\n        e = new Array(n),\n        value = matrix,\n        i, j;\n\n    var isSymmetric = false;\n    if (options.assumeSymmetric) {\n        isSymmetric = true;\n    } else {\n        isSymmetric = matrix.isSymmetric();\n    }\n\n    if (isSymmetric) {\n        for (i = 0; i < n; i++) {\n            for (j = 0; j < n; j++) {\n                V[i][j] = value.get(i, j);\n            }\n        }\n        tred2(n, e, d, V);\n        tql2(n, e, d, V);\n    } else {\n        var H = getFilled2DArray(n, n, 0),\n            ort = new Array(n);\n        for (j = 0; j < n; j++) {\n            for (i = 0; i < n; i++) {\n                H[i][j] = value.get(i, j);\n            }\n        }\n        orthes(n, H, ort, V);\n        hqr2(n, e, d, V, H);\n    }\n\n    this.n = n;\n    this.e = e;\n    this.d = d;\n    this.V = V;\n}\n\nEigenvalueDecomposition.prototype = {\n    get realEigenvalues() {\n        return this.d;\n    },\n    get imaginaryEigenvalues() {\n        return this.e;\n    },\n    get eigenvectorMatrix() {\n        if (!Matrix.isMatrix(this.V)) {\n            this.V = new Matrix(this.V);\n        }\n        return this.V;\n    },\n    get diagonalMatrix() {\n        var n = this.n,\n            e = this.e,\n            d = this.d,\n            X = new Matrix(n, n),\n            i, j;\n        for (i = 0; i < n; i++) {\n            for (j = 0; j < n; j++) {\n                X[i][j] = 0;\n            }\n            X[i][i] = d[i];\n            if (e[i] > 0) {\n                X[i][i + 1] = e[i];\n            } else if (e[i] < 0) {\n                X[i][i - 1] = e[i];\n            }\n        }\n        return X;\n    }\n};\n\nfunction tred2(n, e, d, V) {\n\n    var f, g, h, i, j, k,\n        hh, scale;\n\n    for (j = 0; j < n; j++) {\n        d[j] = V[n - 1][j];\n    }\n\n    for (i = n - 1; i > 0; i--) {\n        scale = 0;\n        h = 0;\n        for (k = 0; k < i; k++) {\n            scale = scale + Math.abs(d[k]);\n        }\n\n        if (scale === 0) {\n            e[i] = d[i - 1];\n            for (j = 0; j < i; j++) {\n                d[j] = V[i - 1][j];\n                V[i][j] = 0;\n                V[j][i] = 0;\n            }\n        } else {\n            for (k = 0; k < i; k++) {\n                d[k] /= scale;\n                h += d[k] * d[k];\n            }\n\n            f = d[i - 1];\n            g = Math.sqrt(h);\n            if (f > 0) {\n                g = -g;\n            }\n\n            e[i] = scale * g;\n            h = h - f * g;\n            d[i - 1] = f - g;\n            for (j = 0; j < i; j++) {\n                e[j] = 0;\n            }\n\n            for (j = 0; j < i; j++) {\n                f = d[j];\n                V[j][i] = f;\n                g = e[j] + V[j][j] * f;\n                for (k = j + 1; k <= i - 1; k++) {\n                    g += V[k][j] * d[k];\n                    e[k] += V[k][j] * f;\n                }\n                e[j] = g;\n            }\n\n            f = 0;\n            for (j = 0; j < i; j++) {\n                e[j] /= h;\n                f += e[j] * d[j];\n            }\n\n            hh = f / (h + h);\n            for (j = 0; j < i; j++) {\n                e[j] -= hh * d[j];\n            }\n\n            for (j = 0; j < i; j++) {\n                f = d[j];\n                g = e[j];\n                for (k = j; k <= i - 1; k++) {\n                    V[k][j] -= (f * e[k] + g * d[k]);\n                }\n                d[j] = V[i - 1][j];\n                V[i][j] = 0;\n            }\n        }\n        d[i] = h;\n    }\n\n    for (i = 0; i < n - 1; i++) {\n        V[n - 1][i] = V[i][i];\n        V[i][i] = 1;\n        h = d[i + 1];\n        if (h !== 0) {\n            for (k = 0; k <= i; k++) {\n                d[k] = V[k][i + 1] / h;\n            }\n\n            for (j = 0; j <= i; j++) {\n                g = 0;\n                for (k = 0; k <= i; k++) {\n                    g += V[k][i + 1] * V[k][j];\n                }\n                for (k = 0; k <= i; k++) {\n                    V[k][j] -= g * d[k];\n                }\n            }\n        }\n\n        for (k = 0; k <= i; k++) {\n            V[k][i + 1] = 0;\n        }\n    }\n\n    for (j = 0; j < n; j++) {\n        d[j] = V[n - 1][j];\n        V[n - 1][j] = 0;\n    }\n\n    V[n - 1][n - 1] = 1;\n    e[0] = 0;\n}\n\nfunction tql2(n, e, d, V) {\n\n    var g, h, i, j, k, l, m, p, r,\n        dl1, c, c2, c3, el1, s, s2,\n        iter;\n\n    for (i = 1; i < n; i++) {\n        e[i - 1] = e[i];\n    }\n\n    e[n - 1] = 0;\n\n    var f = 0,\n        tst1 = 0,\n        eps = Math.pow(2, -52);\n\n    for (l = 0; l < n; l++) {\n        tst1 = Math.max(tst1, Math.abs(d[l]) + Math.abs(e[l]));\n        m = l;\n        while (m < n) {\n            if (Math.abs(e[m]) <= eps * tst1) {\n                break;\n            }\n            m++;\n        }\n\n        if (m > l) {\n            iter = 0;\n            do {\n                iter = iter + 1;\n\n                g = d[l];\n                p = (d[l + 1] - g) / (2 * e[l]);\n                r = hypotenuse(p, 1);\n                if (p < 0) {\n                    r = -r;\n                }\n\n                d[l] = e[l] / (p + r);\n                d[l + 1] = e[l] * (p + r);\n                dl1 = d[l + 1];\n                h = g - d[l];\n                for (i = l + 2; i < n; i++) {\n                    d[i] -= h;\n                }\n\n                f = f + h;\n\n                p = d[m];\n                c = 1;\n                c2 = c;\n                c3 = c;\n                el1 = e[l + 1];\n                s = 0;\n                s2 = 0;\n                for (i = m - 1; i >= l; i--) {\n                    c3 = c2;\n                    c2 = c;\n                    s2 = s;\n                    g = c * e[i];\n                    h = c * p;\n                    r = hypotenuse(p, e[i]);\n                    e[i + 1] = s * r;\n                    s = e[i] / r;\n                    c = p / r;\n                    p = c * d[i] - s * g;\n                    d[i + 1] = h + s * (c * g + s * d[i]);\n\n                    for (k = 0; k < n; k++) {\n                        h = V[k][i + 1];\n                        V[k][i + 1] = s * V[k][i] + c * h;\n                        V[k][i] = c * V[k][i] - s * h;\n                    }\n                }\n\n                p = -s * s2 * c3 * el1 * e[l] / dl1;\n                e[l] = s * p;\n                d[l] = c * p;\n\n            }\n            while (Math.abs(e[l]) > eps * tst1);\n        }\n        d[l] = d[l] + f;\n        e[l] = 0;\n    }\n\n    for (i = 0; i < n - 1; i++) {\n        k = i;\n        p = d[i];\n        for (j = i + 1; j < n; j++) {\n            if (d[j] < p) {\n                k = j;\n                p = d[j];\n            }\n        }\n\n        if (k !== i) {\n            d[k] = d[i];\n            d[i] = p;\n            for (j = 0; j < n; j++) {\n                p = V[j][i];\n                V[j][i] = V[j][k];\n                V[j][k] = p;\n            }\n        }\n    }\n}\n\nfunction orthes(n, H, ort, V) {\n\n    var low = 0,\n        high = n - 1,\n        f, g, h, i, j, m,\n        scale;\n\n    for (m = low + 1; m <= high - 1; m++) {\n        scale = 0;\n        for (i = m; i <= high; i++) {\n            scale = scale + Math.abs(H[i][m - 1]);\n        }\n\n        if (scale !== 0) {\n            h = 0;\n            for (i = high; i >= m; i--) {\n                ort[i] = H[i][m - 1] / scale;\n                h += ort[i] * ort[i];\n            }\n\n            g = Math.sqrt(h);\n            if (ort[m] > 0) {\n                g = -g;\n            }\n\n            h = h - ort[m] * g;\n            ort[m] = ort[m] - g;\n\n            for (j = m; j < n; j++) {\n                f = 0;\n                for (i = high; i >= m; i--) {\n                    f += ort[i] * H[i][j];\n                }\n\n                f = f / h;\n                for (i = m; i <= high; i++) {\n                    H[i][j] -= f * ort[i];\n                }\n            }\n\n            for (i = 0; i <= high; i++) {\n                f = 0;\n                for (j = high; j >= m; j--) {\n                    f += ort[j] * H[i][j];\n                }\n\n                f = f / h;\n                for (j = m; j <= high; j++) {\n                    H[i][j] -= f * ort[j];\n                }\n            }\n\n            ort[m] = scale * ort[m];\n            H[m][m - 1] = scale * g;\n        }\n    }\n\n    for (i = 0; i < n; i++) {\n        for (j = 0; j < n; j++) {\n            V[i][j] = (i === j ? 1 : 0);\n        }\n    }\n\n    for (m = high - 1; m >= low + 1; m--) {\n        if (H[m][m - 1] !== 0) {\n            for (i = m + 1; i <= high; i++) {\n                ort[i] = H[i][m - 1];\n            }\n\n            for (j = m; j <= high; j++) {\n                g = 0;\n                for (i = m; i <= high; i++) {\n                    g += ort[i] * V[i][j];\n                }\n\n                g = (g / ort[m]) / H[m][m - 1];\n                for (i = m; i <= high; i++) {\n                    V[i][j] += g * ort[i];\n                }\n            }\n        }\n    }\n}\n\nfunction hqr2(nn, e, d, V, H) {\n    var n = nn - 1,\n        low = 0,\n        high = nn - 1,\n        eps = Math.pow(2, -52),\n        exshift = 0,\n        norm = 0,\n        p = 0,\n        q = 0,\n        r = 0,\n        s = 0,\n        z = 0,\n        iter = 0,\n        i, j, k, l, m, t, w, x, y,\n        ra, sa, vr, vi,\n        notlast, cdivres;\n\n    for (i = 0; i < nn; i++) {\n        if (i < low || i > high) {\n            d[i] = H[i][i];\n            e[i] = 0;\n        }\n\n        for (j = Math.max(i - 1, 0); j < nn; j++) {\n            norm = norm + Math.abs(H[i][j]);\n        }\n    }\n\n    while (n >= low) {\n        l = n;\n        while (l > low) {\n            s = Math.abs(H[l - 1][l - 1]) + Math.abs(H[l][l]);\n            if (s === 0) {\n                s = norm;\n            }\n            if (Math.abs(H[l][l - 1]) < eps * s) {\n                break;\n            }\n            l--;\n        }\n\n        if (l === n) {\n            H[n][n] = H[n][n] + exshift;\n            d[n] = H[n][n];\n            e[n] = 0;\n            n--;\n            iter = 0;\n        } else if (l === n - 1) {\n            w = H[n][n - 1] * H[n - 1][n];\n            p = (H[n - 1][n - 1] - H[n][n]) / 2;\n            q = p * p + w;\n            z = Math.sqrt(Math.abs(q));\n            H[n][n] = H[n][n] + exshift;\n            H[n - 1][n - 1] = H[n - 1][n - 1] + exshift;\n            x = H[n][n];\n\n            if (q >= 0) {\n                z = (p >= 0) ? (p + z) : (p - z);\n                d[n - 1] = x + z;\n                d[n] = d[n - 1];\n                if (z !== 0) {\n                    d[n] = x - w / z;\n                }\n                e[n - 1] = 0;\n                e[n] = 0;\n                x = H[n][n - 1];\n                s = Math.abs(x) + Math.abs(z);\n                p = x / s;\n                q = z / s;\n                r = Math.sqrt(p * p + q * q);\n                p = p / r;\n                q = q / r;\n\n                for (j = n - 1; j < nn; j++) {\n                    z = H[n - 1][j];\n                    H[n - 1][j] = q * z + p * H[n][j];\n                    H[n][j] = q * H[n][j] - p * z;\n                }\n\n                for (i = 0; i <= n; i++) {\n                    z = H[i][n - 1];\n                    H[i][n - 1] = q * z + p * H[i][n];\n                    H[i][n] = q * H[i][n] - p * z;\n                }\n\n                for (i = low; i <= high; i++) {\n                    z = V[i][n - 1];\n                    V[i][n - 1] = q * z + p * V[i][n];\n                    V[i][n] = q * V[i][n] - p * z;\n                }\n            } else {\n                d[n - 1] = x + p;\n                d[n] = x + p;\n                e[n - 1] = z;\n                e[n] = -z;\n            }\n\n            n = n - 2;\n            iter = 0;\n        } else {\n            x = H[n][n];\n            y = 0;\n            w = 0;\n            if (l < n) {\n                y = H[n - 1][n - 1];\n                w = H[n][n - 1] * H[n - 1][n];\n            }\n\n            if (iter === 10) {\n                exshift += x;\n                for (i = low; i <= n; i++) {\n                    H[i][i] -= x;\n                }\n                s = Math.abs(H[n][n - 1]) + Math.abs(H[n - 1][n - 2]);\n                x = y = 0.75 * s;\n                w = -0.4375 * s * s;\n            }\n\n            if (iter === 30) {\n                s = (y - x) / 2;\n                s = s * s + w;\n                if (s > 0) {\n                    s = Math.sqrt(s);\n                    if (y < x) {\n                        s = -s;\n                    }\n                    s = x - w / ((y - x) / 2 + s);\n                    for (i = low; i <= n; i++) {\n                        H[i][i] -= s;\n                    }\n                    exshift += s;\n                    x = y = w = 0.964;\n                }\n            }\n\n            iter = iter + 1;\n\n            m = n - 2;\n            while (m >= l) {\n                z = H[m][m];\n                r = x - z;\n                s = y - z;\n                p = (r * s - w) / H[m + 1][m] + H[m][m + 1];\n                q = H[m + 1][m + 1] - z - r - s;\n                r = H[m + 2][m + 1];\n                s = Math.abs(p) + Math.abs(q) + Math.abs(r);\n                p = p / s;\n                q = q / s;\n                r = r / s;\n                if (m === l) {\n                    break;\n                }\n                if (Math.abs(H[m][m - 1]) * (Math.abs(q) + Math.abs(r)) < eps * (Math.abs(p) * (Math.abs(H[m - 1][m - 1]) + Math.abs(z) + Math.abs(H[m + 1][m + 1])))) {\n                    break;\n                }\n                m--;\n            }\n\n            for (i = m + 2; i <= n; i++) {\n                H[i][i - 2] = 0;\n                if (i > m + 2) {\n                    H[i][i - 3] = 0;\n                }\n            }\n\n            for (k = m; k <= n - 1; k++) {\n                notlast = (k !== n - 1);\n                if (k !== m) {\n                    p = H[k][k - 1];\n                    q = H[k + 1][k - 1];\n                    r = (notlast ? H[k + 2][k - 1] : 0);\n                    x = Math.abs(p) + Math.abs(q) + Math.abs(r);\n                    if (x !== 0) {\n                        p = p / x;\n                        q = q / x;\n                        r = r / x;\n                    }\n                }\n\n                if (x === 0) {\n                    break;\n                }\n\n                s = Math.sqrt(p * p + q * q + r * r);\n                if (p < 0) {\n                    s = -s;\n                }\n\n                if (s !== 0) {\n                    if (k !== m) {\n                        H[k][k - 1] = -s * x;\n                    } else if (l !== m) {\n                        H[k][k - 1] = -H[k][k - 1];\n                    }\n\n                    p = p + s;\n                    x = p / s;\n                    y = q / s;\n                    z = r / s;\n                    q = q / p;\n                    r = r / p;\n\n                    for (j = k; j < nn; j++) {\n                        p = H[k][j] + q * H[k + 1][j];\n                        if (notlast) {\n                            p = p + r * H[k + 2][j];\n                            H[k + 2][j] = H[k + 2][j] - p * z;\n                        }\n\n                        H[k][j] = H[k][j] - p * x;\n                        H[k + 1][j] = H[k + 1][j] - p * y;\n                    }\n\n                    for (i = 0; i <= Math.min(n, k + 3); i++) {\n                        p = x * H[i][k] + y * H[i][k + 1];\n                        if (notlast) {\n                            p = p + z * H[i][k + 2];\n                            H[i][k + 2] = H[i][k + 2] - p * r;\n                        }\n\n                        H[i][k] = H[i][k] - p;\n                        H[i][k + 1] = H[i][k + 1] - p * q;\n                    }\n\n                    for (i = low; i <= high; i++) {\n                        p = x * V[i][k] + y * V[i][k + 1];\n                        if (notlast) {\n                            p = p + z * V[i][k + 2];\n                            V[i][k + 2] = V[i][k + 2] - p * r;\n                        }\n\n                        V[i][k] = V[i][k] - p;\n                        V[i][k + 1] = V[i][k + 1] - p * q;\n                    }\n                }\n            }\n        }\n    }\n\n    if (norm === 0) {\n        return;\n    }\n\n    for (n = nn - 1; n >= 0; n--) {\n        p = d[n];\n        q = e[n];\n\n        if (q === 0) {\n            l = n;\n            H[n][n] = 1;\n            for (i = n - 1; i >= 0; i--) {\n                w = H[i][i] - p;\n                r = 0;\n                for (j = l; j <= n; j++) {\n                    r = r + H[i][j] * H[j][n];\n                }\n\n                if (e[i] < 0) {\n                    z = w;\n                    s = r;\n                } else {\n                    l = i;\n                    if (e[i] === 0) {\n                        H[i][n] = (w !== 0) ? (-r / w) : (-r / (eps * norm));\n                    } else {\n                        x = H[i][i + 1];\n                        y = H[i + 1][i];\n                        q = (d[i] - p) * (d[i] - p) + e[i] * e[i];\n                        t = (x * s - z * r) / q;\n                        H[i][n] = t;\n                        H[i + 1][n] = (Math.abs(x) > Math.abs(z)) ? ((-r - w * t) / x) : ((-s - y * t) / z);\n                    }\n\n                    t = Math.abs(H[i][n]);\n                    if ((eps * t) * t > 1) {\n                        for (j = i; j <= n; j++) {\n                            H[j][n] = H[j][n] / t;\n                        }\n                    }\n                }\n            }\n        } else if (q < 0) {\n            l = n - 1;\n\n            if (Math.abs(H[n][n - 1]) > Math.abs(H[n - 1][n])) {\n                H[n - 1][n - 1] = q / H[n][n - 1];\n                H[n - 1][n] = -(H[n][n] - p) / H[n][n - 1];\n            } else {\n                cdivres = cdiv(0, -H[n - 1][n], H[n - 1][n - 1] - p, q);\n                H[n - 1][n - 1] = cdivres[0];\n                H[n - 1][n] = cdivres[1];\n            }\n\n            H[n][n - 1] = 0;\n            H[n][n] = 1;\n            for (i = n - 2; i >= 0; i--) {\n                ra = 0;\n                sa = 0;\n                for (j = l; j <= n; j++) {\n                    ra = ra + H[i][j] * H[j][n - 1];\n                    sa = sa + H[i][j] * H[j][n];\n                }\n\n                w = H[i][i] - p;\n\n                if (e[i] < 0) {\n                    z = w;\n                    r = ra;\n                    s = sa;\n                } else {\n                    l = i;\n                    if (e[i] === 0) {\n                        cdivres = cdiv(-ra, -sa, w, q);\n                        H[i][n - 1] = cdivres[0];\n                        H[i][n] = cdivres[1];\n                    } else {\n                        x = H[i][i + 1];\n                        y = H[i + 1][i];\n                        vr = (d[i] - p) * (d[i] - p) + e[i] * e[i] - q * q;\n                        vi = (d[i] - p) * 2 * q;\n                        if (vr === 0 && vi === 0) {\n                            vr = eps * norm * (Math.abs(w) + Math.abs(q) + Math.abs(x) + Math.abs(y) + Math.abs(z));\n                        }\n                        cdivres = cdiv(x * r - z * ra + q * sa, x * s - z * sa - q * ra, vr, vi);\n                        H[i][n - 1] = cdivres[0];\n                        H[i][n] = cdivres[1];\n                        if (Math.abs(x) > (Math.abs(z) + Math.abs(q))) {\n                            H[i + 1][n - 1] = (-ra - w * H[i][n - 1] + q * H[i][n]) / x;\n                            H[i + 1][n] = (-sa - w * H[i][n] - q * H[i][n - 1]) / x;\n                        } else {\n                            cdivres = cdiv(-r - y * H[i][n - 1], -s - y * H[i][n], z, q);\n                            H[i + 1][n - 1] = cdivres[0];\n                            H[i + 1][n] = cdivres[1];\n                        }\n                    }\n\n                    t = Math.max(Math.abs(H[i][n - 1]), Math.abs(H[i][n]));\n                    if ((eps * t) * t > 1) {\n                        for (j = i; j <= n; j++) {\n                            H[j][n - 1] = H[j][n - 1] / t;\n                            H[j][n] = H[j][n] / t;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    for (i = 0; i < nn; i++) {\n        if (i < low || i > high) {\n            for (j = i; j < nn; j++) {\n                V[i][j] = H[i][j];\n            }\n        }\n    }\n\n    for (j = nn - 1; j >= low; j--) {\n        for (i = low; i <= high; i++) {\n            z = 0;\n            for (k = low; k <= Math.min(j, high); k++) {\n                z = z + V[i][k] * H[k][j];\n            }\n            V[i][j] = z;\n        }\n    }\n}\n\nfunction cdiv(xr, xi, yr, yi) {\n    var r, d;\n    if (Math.abs(yr) > Math.abs(yi)) {\n        r = yi / yr;\n        d = yr + r * yi;\n        return [(xr + r * xi) / d, (xi - r * xr) / d];\n    } else {\n        r = yr / yi;\n        d = yi + r * yr;\n        return [(r * xr + xi) / d, (r * xi - xr) / d];\n    }\n}\n\nmodule.exports = EigenvalueDecomposition;\n","'use strict';\n\nvar Matrix = require('../matrix').Matrix;\nvar hypotenuse = require('./util').hypotenuse;\n\n//https://github.com/lutzroeder/Mapack/blob/master/Source/QrDecomposition.cs\nfunction QrDecomposition(value) {\n    if (!(this instanceof QrDecomposition)) {\n        return new QrDecomposition(value);\n    }\n    value = Matrix.checkMatrix(value);\n\n    var qr = value.clone(),\n        m = value.rows,\n        n = value.columns,\n        rdiag = new Array(n),\n        i, j, k, s;\n\n    for (k = 0; k < n; k++) {\n        var nrm = 0;\n        for (i = k; i < m; i++) {\n            nrm = hypotenuse(nrm, qr[i][k]);\n        }\n        if (nrm !== 0) {\n            if (qr[k][k] < 0) {\n                nrm = -nrm;\n            }\n            for (i = k; i < m; i++) {\n                qr[i][k] /= nrm;\n            }\n            qr[k][k] += 1;\n            for (j = k + 1; j < n; j++) {\n                s = 0;\n                for (i = k; i < m; i++) {\n                    s += qr[i][k] * qr[i][j];\n                }\n                s = -s / qr[k][k];\n                for (i = k; i < m; i++) {\n                    qr[i][j] += s * qr[i][k];\n                }\n            }\n        }\n        rdiag[k] = -nrm;\n    }\n\n    this.QR = qr;\n    this.Rdiag = rdiag;\n}\n\nQrDecomposition.prototype = {\n    solve: function (value) {\n        value = Matrix.checkMatrix(value);\n\n        var qr = this.QR,\n            m = qr.rows;\n\n        if (value.rows !== m) {\n            throw new Error('Matrix row dimensions must agree');\n        }\n        if (!this.isFullRank()) {\n            throw new Error('Matrix is rank deficient');\n        }\n\n        var count = value.columns;\n        var X = value.clone();\n        var n = qr.columns;\n        var i, j, k, s;\n\n        for (k = 0; k < n; k++) {\n            for (j = 0; j < count; j++) {\n                s = 0;\n                for (i = k; i < m; i++) {\n                    s += qr[i][k] * X[i][j];\n                }\n                s = -s / qr[k][k];\n                for (i = k; i < m; i++) {\n                    X[i][j] += s * qr[i][k];\n                }\n            }\n        }\n        for (k = n - 1; k >= 0; k--) {\n            for (j = 0; j < count; j++) {\n                X[k][j] /= this.Rdiag[k];\n            }\n            for (i = 0; i < k; i++) {\n                for (j = 0; j < count; j++) {\n                    X[i][j] -= X[k][j] * qr[i][k];\n                }\n            }\n        }\n\n        return X.subMatrix(0, n - 1, 0, count - 1);\n    },\n    isFullRank: function () {\n        var columns = this.QR.columns;\n        for (var i = 0; i < columns; i++) {\n            if (this.Rdiag[i] === 0) {\n                return false;\n            }\n        }\n        return true;\n    },\n    get upperTriangularMatrix() {\n        var qr = this.QR,\n            n = qr.columns,\n            X = new Matrix(n, n),\n            i, j;\n        for (i = 0; i < n; i++) {\n            for (j = 0; j < n; j++) {\n                if (i < j) {\n                    X[i][j] = qr[i][j];\n                } else if (i === j) {\n                    X[i][j] = this.Rdiag[i];\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n        return X;\n    },\n    get orthogonalMatrix() {\n        var qr = this.QR,\n            rows = qr.rows,\n            columns = qr.columns,\n            X = new Matrix(rows, columns),\n            i, j, k, s;\n\n        for (k = columns - 1; k >= 0; k--) {\n            for (i = 0; i < rows; i++) {\n                X[i][k] = 0;\n            }\n            X[k][k] = 1;\n            for (j = k; j < columns; j++) {\n                if (qr[k][k] !== 0) {\n                    s = 0;\n                    for (i = k; i < rows; i++) {\n                        s += qr[i][k] * X[i][j];\n                    }\n\n                    s = -s / qr[k][k];\n\n                    for (i = k; i < rows; i++) {\n                        X[i][j] += s * qr[i][k];\n                    }\n                }\n            }\n        }\n        return X;\n    }\n};\n\nmodule.exports = QrDecomposition;\n","'use strict';\n\nvar Matrix = require('../matrix').Matrix;\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/CholeskyDecomposition.cs\nfunction CholeskyDecomposition(value) {\n    if (!(this instanceof CholeskyDecomposition)) {\n        return new CholeskyDecomposition(value);\n    }\n    value = Matrix.checkMatrix(value);\n    if (!value.isSymmetric()) {\n        throw new Error('Matrix is not symmetric');\n    }\n\n    var a = value,\n        dimension = a.rows,\n        l = new Matrix(dimension, dimension),\n        positiveDefinite = true,\n        i, j, k;\n\n    for (j = 0; j < dimension; j++) {\n        var Lrowj = l[j];\n        var d = 0;\n        for (k = 0; k < j; k++) {\n            var Lrowk = l[k];\n            var s = 0;\n            for (i = 0; i < k; i++) {\n                s += Lrowk[i] * Lrowj[i];\n            }\n            Lrowj[k] = s = (a[j][k] - s) / l[k][k];\n            d = d + s * s;\n        }\n\n        d = a[j][j] - d;\n\n        positiveDefinite &= (d > 0);\n        l[j][j] = Math.sqrt(Math.max(d, 0));\n        for (k = j + 1; k < dimension; k++) {\n            l[j][k] = 0;\n        }\n    }\n\n    if (!positiveDefinite) {\n        throw new Error('Matrix is not positive definite');\n    }\n\n    this.L = l;\n}\n\nCholeskyDecomposition.prototype = {\n    get lowerTriangularMatrix() {\n        return this.L;\n    },\n    solve: function (value) {\n        value = Matrix.checkMatrix(value);\n\n        var l = this.L,\n            dimension = l.rows;\n\n        if (value.rows !== dimension) {\n            throw new Error('Matrix dimensions do not match');\n        }\n\n        var count = value.columns,\n            B = value.clone(),\n            i, j, k;\n\n        for (k = 0; k < dimension; k++) {\n            for (j = 0; j < count; j++) {\n                for (i = 0; i < k; i++) {\n                    B[k][j] -= B[i][j] * l[k][i];\n                }\n                B[k][j] /= l[k][k];\n            }\n        }\n\n        for (k = dimension - 1; k >= 0; k--) {\n            for (j = 0; j < count; j++) {\n                for (i = k + 1; i < dimension; i++) {\n                    B[k][j] -= B[i][j] * l[i][k];\n                }\n                B[k][j] /= l[k][k];\n            }\n        }\n\n        return B;\n    }\n};\n\nmodule.exports = CholeskyDecomposition;\n","'use strict';\n\nconst euclidean = require('ml-distance-euclidean');\nconst ClusterLeaf = require('./ClusterLeaf');\nconst Cluster = require('./Cluster');\nconst distanceMatrix = require('ml-distance-matrix');\n\n/**\n * @private\n * @param cluster1\n * @param cluster2\n * @param disFun\n * @returns {number}\n */\nfunction simpleLink(cluster1, cluster2, disFun) {\n    var m = 10e100;\n    for (var i = 0; i < cluster1.length; i++) {\n        for (var j = 0; j < cluster2.length; j++) {\n            var d = disFun[cluster1[i]][ cluster2[j]];\n            m = Math.min(d, m);\n        }\n    }\n    return m;\n}\n\n/**\n * @private\n * @param cluster1\n * @param cluster2\n * @param disFun\n * @returns {number}\n */\nfunction completeLink(cluster1, cluster2, disFun) {\n    var m = -1;\n    for (var i = 0; i < cluster1.length; i++) {\n        for (var j = 0; j < cluster2.length; j++) {\n            var d = disFun[cluster1[i]][ cluster2[j]];\n            m = Math.max(d, m);\n        }\n    }\n    return m;\n}\n\n/**\n * @private\n * @param cluster1\n * @param cluster2\n * @param disFun\n * @returns {number}\n */\nfunction averageLink(cluster1, cluster2, disFun) {\n    var m = 0;\n    for (var i = 0; i < cluster1.length; i++) {\n        for (var j = 0; j < cluster2.length; j++) {\n            m += disFun[cluster1[i]][ cluster2[j]];\n        }\n    }\n    return m / (cluster1.length * cluster2.length);\n}\n\n/**\n * @private\n * @param cluster1\n * @param cluster2\n * @param disFun\n * @returns {*}\n */\nfunction centroidLink(cluster1, cluster2, disFun) {\n    var dist = new Array(cluster1.length * cluster2.length);\n    for (var i = 0; i < cluster1.length; i++) {\n        for (var j = 0; j < cluster2.length; j++) {\n            dist[i * cluster2.length + j] = (disFun[cluster1[i]][ cluster2[j]]);\n        }\n    }\n    return median(dist);\n}\n\n/**\n * @private\n * @param cluster1\n * @param cluster2\n * @param disFun\n * @returns {number}\n */\nfunction wardLink(cluster1, cluster2, disFun) {\n    return centroidLink(cluster1, cluster2, disFun)\n        * cluster1.length * cluster2.length / (cluster1.length + cluster2.length);\n}\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\nfunction median(values, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var half = Math.floor(l / 2);\n    if (l % 2 === 0) {\n        return (values[half - 1] + values[half]) * 0.5;\n    } else {\n        return values[half];\n    }\n}\n\nvar defaultOptions = {\n    disFunc: euclidean,\n    kind: 'single',\n    isDistanceMatrix: false\n\n};\n\n/**\n * Continuously merge nodes that have the least dissimilarity\n * @param {Array <Array <number>>} distance - Array of points to be clustered\n * @param {json} options\n * @option isDistanceMatrix: Is the input a distance matrix?\n * @constructor\n */\nfunction agnes(data, options) {\n    options = Object.assign({}, defaultOptions, options);\n    var len = data.length;\n    var distance = data;//If source\n    if (!options.isDistanceMatrix) {\n        distance = distanceMatrix(data, options.disFunc);\n    }\n\n\n    // allows to use a string or a given function\n    if (typeof options.kind === 'string') {\n        switch (options.kind) {\n            case 'single':\n                options.kind = simpleLink;\n                break;\n            case 'complete':\n                options.kind = completeLink;\n                break;\n            case 'average':\n                options.kind = averageLink;\n                break;\n            case 'centroid':\n                options.kind = centroidLink;\n                break;\n            case 'ward':\n                options.kind = wardLink;\n                break;\n            default:\n                throw new RangeError('Unknown kind of similarity');\n        }\n    } else if (typeof options.kind !== 'function') {\n        throw new TypeError('Undefined kind of similarity');\n    }\n\n    var list = new Array(len);\n    for (var i = 0; i < distance.length; i++) {\n        list[i] = new ClusterLeaf(i);\n    }\n    var min = 10e5,\n        d = {},\n        dis = 0;\n\n    while (list.length > 1) {\n        // calculates the minimum distance\n        d = {};\n        min = 10e5;\n        for (var j = 0; j < list.length; j++) {\n            for (var k = j + 1; k < list.length; k++) {\n                var fdistance, sdistance;\n                if (list[j] instanceof ClusterLeaf) {\n                    fdistance = [list[j].index];\n                } else {\n                    fdistance = new Array(list[j].index.length);\n                    for (var e = 0; e < fdistance.length; e++) {\n                        fdistance[e] = list[j].index[e].index;\n                    }\n                }\n                if (list[k] instanceof ClusterLeaf) {\n                    sdistance = [list[k].index];\n                } else {\n                    sdistance = new Array(list[k].index.length);\n                    for (var f = 0; f < sdistance.length; f++) {\n                        sdistance[f] = list[k].index[f].index;\n                    }\n                }\n                dis = options.kind(fdistance, sdistance, distance).toFixed(4);\n                if (dis in d) {\n                    d[dis].push([list[j], list[k]]);\n                } else {\n                    d[dis] = [[list[j], list[k]]];\n                }\n                min = Math.min(dis, min);\n            }\n        }\n        // cluster dots\n        var dmin = d[min.toFixed(4)];\n        var clustered = new Array(dmin.length);\n        var aux,\n            count = 0;\n        while (dmin.length > 0) {\n            aux = dmin.shift();\n            for (var q = 0; q < dmin.length; q++) {\n                var int = dmin[q].filter(function (n) {\n                    //noinspection JSReferencingMutableVariableFromClosure\n                    return aux.indexOf(n) !== -1;\n                });\n                if (int.length > 0) {\n                    var diff = dmin[q].filter(function (n) {\n                        //noinspection JSReferencingMutableVariableFromClosure\n                        return aux.indexOf(n) === -1;\n                    });\n                    aux = aux.concat(diff);\n                    dmin.splice(q--, 1);\n                }\n            }\n            clustered[count++] = aux;\n        }\n        clustered.length = count;\n\n        for (var ii = 0; ii < clustered.length; ii++) {\n            var obj = new Cluster();\n            obj.children = clustered[ii].concat();\n            obj.distance = min;\n            obj.index = new Array(len);\n            var indCount = 0;\n            for (var jj = 0; jj < clustered[ii].length; jj++) {\n                if (clustered[ii][jj] instanceof ClusterLeaf) {\n                    obj.index[indCount++] = clustered[ii][jj];\n                } else {\n                    indCount += clustered[ii][jj].index.length;\n                    obj.index = clustered[ii][jj].index.concat(obj.index);\n                }\n                list.splice((list.indexOf(clustered[ii][jj])), 1);\n            }\n            obj.index.length = indCount;\n            list.push(obj);\n        }\n    }\n    return list[0];\n}\n\nmodule.exports = agnes;\n","module.exports = require('./lib/heap');\n","// Generated by CoffeeScript 1.8.0\n(function() {\n  var Heap, defaultCmp, floor, heapify, heappop, heappush, heappushpop, heapreplace, insort, min, nlargest, nsmallest, updateItem, _siftdown, _siftup;\n\n  floor = Math.floor, min = Math.min;\n\n\n  /*\n  Default comparison function to be used\n   */\n\n  defaultCmp = function(x, y) {\n    if (x < y) {\n      return -1;\n    }\n    if (x > y) {\n      return 1;\n    }\n    return 0;\n  };\n\n\n  /*\n  Insert item x in list a, and keep it sorted assuming a is sorted.\n  \n  If x is already in a, insert it to the right of the rightmost x.\n  \n  Optional args lo (default 0) and hi (default a.length) bound the slice\n  of a to be searched.\n   */\n\n  insort = function(a, x, lo, hi, cmp) {\n    var mid;\n    if (lo == null) {\n      lo = 0;\n    }\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    if (lo < 0) {\n      throw new Error('lo must be non-negative');\n    }\n    if (hi == null) {\n      hi = a.length;\n    }\n    while (lo < hi) {\n      mid = floor((lo + hi) / 2);\n      if (cmp(x, a[mid]) < 0) {\n        hi = mid;\n      } else {\n        lo = mid + 1;\n      }\n    }\n    return ([].splice.apply(a, [lo, lo - lo].concat(x)), x);\n  };\n\n\n  /*\n  Push item onto heap, maintaining the heap invariant.\n   */\n\n  heappush = function(array, item, cmp) {\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    array.push(item);\n    return _siftdown(array, 0, array.length - 1, cmp);\n  };\n\n\n  /*\n  Pop the smallest item off the heap, maintaining the heap invariant.\n   */\n\n  heappop = function(array, cmp) {\n    var lastelt, returnitem;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    lastelt = array.pop();\n    if (array.length) {\n      returnitem = array[0];\n      array[0] = lastelt;\n      _siftup(array, 0, cmp);\n    } else {\n      returnitem = lastelt;\n    }\n    return returnitem;\n  };\n\n\n  /*\n  Pop and return the current smallest value, and add the new item.\n  \n  This is more efficient than heappop() followed by heappush(), and can be\n  more appropriate when using a fixed size heap. Note that the value\n  returned may be larger than item! That constrains reasonable use of\n  this routine unless written as part of a conditional replacement:\n      if item > array[0]\n        item = heapreplace(array, item)\n   */\n\n  heapreplace = function(array, item, cmp) {\n    var returnitem;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    returnitem = array[0];\n    array[0] = item;\n    _siftup(array, 0, cmp);\n    return returnitem;\n  };\n\n\n  /*\n  Fast version of a heappush followed by a heappop.\n   */\n\n  heappushpop = function(array, item, cmp) {\n    var _ref;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    if (array.length && cmp(array[0], item) < 0) {\n      _ref = [array[0], item], item = _ref[0], array[0] = _ref[1];\n      _siftup(array, 0, cmp);\n    }\n    return item;\n  };\n\n\n  /*\n  Transform list into a heap, in-place, in O(array.length) time.\n   */\n\n  heapify = function(array, cmp) {\n    var i, _i, _j, _len, _ref, _ref1, _results, _results1;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    _ref1 = (function() {\n      _results1 = [];\n      for (var _j = 0, _ref = floor(array.length / 2); 0 <= _ref ? _j < _ref : _j > _ref; 0 <= _ref ? _j++ : _j--){ _results1.push(_j); }\n      return _results1;\n    }).apply(this).reverse();\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      i = _ref1[_i];\n      _results.push(_siftup(array, i, cmp));\n    }\n    return _results;\n  };\n\n\n  /*\n  Update the position of the given item in the heap.\n  This function should be called every time the item is being modified.\n   */\n\n  updateItem = function(array, item, cmp) {\n    var pos;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    pos = array.indexOf(item);\n    if (pos === -1) {\n      return;\n    }\n    _siftdown(array, 0, pos, cmp);\n    return _siftup(array, pos, cmp);\n  };\n\n\n  /*\n  Find the n largest elements in a dataset.\n   */\n\n  nlargest = function(array, n, cmp) {\n    var elem, result, _i, _len, _ref;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    result = array.slice(0, n);\n    if (!result.length) {\n      return result;\n    }\n    heapify(result, cmp);\n    _ref = array.slice(n);\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      elem = _ref[_i];\n      heappushpop(result, elem, cmp);\n    }\n    return result.sort(cmp).reverse();\n  };\n\n\n  /*\n  Find the n smallest elements in a dataset.\n   */\n\n  nsmallest = function(array, n, cmp) {\n    var elem, i, los, result, _i, _j, _len, _ref, _ref1, _results;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    if (n * 10 <= array.length) {\n      result = array.slice(0, n).sort(cmp);\n      if (!result.length) {\n        return result;\n      }\n      los = result[result.length - 1];\n      _ref = array.slice(n);\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elem = _ref[_i];\n        if (cmp(elem, los) < 0) {\n          insort(result, elem, 0, null, cmp);\n          result.pop();\n          los = result[result.length - 1];\n        }\n      }\n      return result;\n    }\n    heapify(array, cmp);\n    _results = [];\n    for (i = _j = 0, _ref1 = min(n, array.length); 0 <= _ref1 ? _j < _ref1 : _j > _ref1; i = 0 <= _ref1 ? ++_j : --_j) {\n      _results.push(heappop(array, cmp));\n    }\n    return _results;\n  };\n\n  _siftdown = function(array, startpos, pos, cmp) {\n    var newitem, parent, parentpos;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    newitem = array[pos];\n    while (pos > startpos) {\n      parentpos = (pos - 1) >> 1;\n      parent = array[parentpos];\n      if (cmp(newitem, parent) < 0) {\n        array[pos] = parent;\n        pos = parentpos;\n        continue;\n      }\n      break;\n    }\n    return array[pos] = newitem;\n  };\n\n  _siftup = function(array, pos, cmp) {\n    var childpos, endpos, newitem, rightpos, startpos;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    endpos = array.length;\n    startpos = pos;\n    newitem = array[pos];\n    childpos = 2 * pos + 1;\n    while (childpos < endpos) {\n      rightpos = childpos + 1;\n      if (rightpos < endpos && !(cmp(array[childpos], array[rightpos]) < 0)) {\n        childpos = rightpos;\n      }\n      array[pos] = array[childpos];\n      pos = childpos;\n      childpos = 2 * pos + 1;\n    }\n    array[pos] = newitem;\n    return _siftdown(array, startpos, pos, cmp);\n  };\n\n  Heap = (function() {\n    Heap.push = heappush;\n\n    Heap.pop = heappop;\n\n    Heap.replace = heapreplace;\n\n    Heap.pushpop = heappushpop;\n\n    Heap.heapify = heapify;\n\n    Heap.updateItem = updateItem;\n\n    Heap.nlargest = nlargest;\n\n    Heap.nsmallest = nsmallest;\n\n    function Heap(cmp) {\n      this.cmp = cmp != null ? cmp : defaultCmp;\n      this.nodes = [];\n    }\n\n    Heap.prototype.push = function(x) {\n      return heappush(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.pop = function() {\n      return heappop(this.nodes, this.cmp);\n    };\n\n    Heap.prototype.peek = function() {\n      return this.nodes[0];\n    };\n\n    Heap.prototype.contains = function(x) {\n      return this.nodes.indexOf(x) !== -1;\n    };\n\n    Heap.prototype.replace = function(x) {\n      return heapreplace(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.pushpop = function(x) {\n      return heappushpop(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.heapify = function() {\n      return heapify(this.nodes, this.cmp);\n    };\n\n    Heap.prototype.updateItem = function(x) {\n      return updateItem(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.clear = function() {\n      return this.nodes = [];\n    };\n\n    Heap.prototype.empty = function() {\n      return this.nodes.length === 0;\n    };\n\n    Heap.prototype.size = function() {\n      return this.nodes.length;\n    };\n\n    Heap.prototype.clone = function() {\n      var heap;\n      heap = new Heap();\n      heap.nodes = this.nodes.slice(0);\n      return heap;\n    };\n\n    Heap.prototype.toArray = function() {\n      return this.nodes.slice(0);\n    };\n\n    Heap.prototype.insert = Heap.prototype.push;\n\n    Heap.prototype.top = Heap.prototype.peek;\n\n    Heap.prototype.front = Heap.prototype.peek;\n\n    Heap.prototype.has = Heap.prototype.contains;\n\n    Heap.prototype.copy = Heap.prototype.clone;\n\n    return Heap;\n\n  })();\n\n  (function(root, factory) {\n    if (typeof define === 'function' && define.amd) {\n      return define([], factory);\n    } else if (typeof exports === 'object') {\n      return module.exports = factory();\n    } else {\n      return root.Heap = factory();\n    }\n  })(this, function() {\n    return Heap;\n  });\n\n}).call(this);\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","'use strict';\n\n\n/**\n * Computes a distance/similarity matrix given an array of data and a distance/similarity function.\n * @param {Array} data An array of data\n * @param {function} distanceFn  A function that accepts two arguments and computes a distance/similarity between them\n * @return {Array<Array>} The similarity matrix. The similarity matrix is square and has a size equal to the length of\n * the data array\n */\nfunction distanceMatrix(data, distanceFn) {\n    const length = data.length;\n    let result = Array.from({length}).map(() => Array.from({length}));\n\n    // Compute upper distance matrix\n    for (let i = 0; i < length; i++) {\n        for (let j = 0; j <= i; j++) {\n            result[i][j] = distanceFn(data[i], data[j]);\n        }\n    }\n\n    // Copy to lower distance matrix\n    for (let i = 0; i < length; i++) {\n        for (let j = i + 1; j < length; j++) {\n            result[i][j] = result[j][i];\n        }\n    }\n\n    return result;\n}\n\nmodule.exports = distanceMatrix;\n","'use strict';\n\nconst euclidean = require('ml-distance-euclidean');\nconst ClusterLeaf = require('./ClusterLeaf');\nconst Cluster = require('./Cluster');\n\n/**\n * @private\n * @param {Array <Array <number>>} cluster1\n * @param {Array <Array <number>>} cluster2\n * @param {function} disFun\n * @returns {number}\n */\nfunction simpleLink(cluster1, cluster2, disFun) {\n    var m = 10e100;\n    for (var i = 0; i < cluster1.length; i++) {\n        for (var j = i; j < cluster2.length; j++) {\n            var d = disFun(cluster1[i], cluster2[j]);\n            m = Math.min(d, m);\n        }\n    }\n    return m;\n}\n\n/**\n * @private\n * @param {Array <Array <number>>} cluster1\n * @param {Array <Array <number>>} cluster2\n * @param {function} disFun\n * @returns {number}\n */\nfunction completeLink(cluster1, cluster2, disFun) {\n    var m = -1;\n    for (var i = 0; i < cluster1.length; i++) {\n        for (var j = i; j < cluster2.length; j++) {\n            var d = disFun(cluster1[i], cluster2[j]);\n            m = Math.max(d, m);\n        }\n    }\n    return m;\n}\n\n/**\n * @private\n * @param {Array <Array <number>>} cluster1\n * @param {Array <Array <number>>} cluster2\n * @param {function} disFun\n * @returns {number}\n */\nfunction averageLink(cluster1, cluster2, disFun) {\n    var m = 0;\n    for (var i = 0; i < cluster1.length; i++) {\n        for (var j = 0; j < cluster2.length; j++) {\n            m += disFun(cluster1[i], cluster2[j]);\n        }\n    }\n    return m / (cluster1.length * cluster2.length);\n}\n\n/**\n * @private\n * @param {Array <Array <number>>} cluster1\n * @param {Array <Array <number>>} cluster2\n * @param {function} disFun\n * @returns {number}\n */\nfunction centroidLink(cluster1, cluster2, disFun) {\n    var x1 = 0,\n        y1 = 0,\n        x2 = 0,\n        y2 = 0;\n    for (var i = 0; i < cluster1.length; i++) {\n        x1 += cluster1[i][0];\n        y1 += cluster1[i][1];\n    }\n    for (var j = 0; j < cluster2.length; j++) {\n        x2 += cluster2[j][0];\n        y2 += cluster2[j][1];\n    }\n    x1 /= cluster1.length;\n    y1 /= cluster1.length;\n    x2 /= cluster2.length;\n    y2 /= cluster2.length;\n    return disFun([x1, y1], [x2, y2]);\n}\n\n/**\n * @private\n * @param {Array <Array <number>>} cluster1\n * @param {Array <Array <number>>} cluster2\n * @param {function} disFun\n * @returns {number}\n */\nfunction wardLink(cluster1, cluster2, disFun) {\n    var x1 = 0,\n        y1 = 0,\n        x2 = 0,\n        y2 = 0;\n    for (var i = 0; i < cluster1.length; i++) {\n        x1 += cluster1[i][0];\n        y1 += cluster1[i][1];\n    }\n    for (var j = 0; j < cluster2.length; j++) {\n        x2 += cluster2[j][0];\n        y2 += cluster2[j][1];\n    }\n    x1 /= cluster1.length;\n    y1 /= cluster1.length;\n    x2 /= cluster2.length;\n    y2 /= cluster2.length;\n    return disFun([x1, y1], [x2, y2]) * cluster1.length * cluster2.length / (cluster1.length + cluster2.length);\n}\n\n/**\n * @private\n * Returns the most distant point and his distance\n * @param {Array <Array <number>>} splitting - Clusters to split\n * @param {Array <Array <number>>} data - Original data\n * @param {function} disFun - Distance function\n * @returns {{d: number, p: number}} - d: maximum difference between points, p: the point more distant\n */\nfunction diff(splitting, data, disFun) {\n    var ans = {\n        d: 0,\n        p: 0\n    };\n\n    var Ci = new Array(splitting[0].length);\n    for (var e = 0; e < splitting[0].length; e++) {\n        Ci[e] = data[splitting[0][e]];\n    }\n    var Cj = new Array(splitting[1].length);\n    for (var f = 0; f < splitting[1].length; f++) {\n        Cj[f] = data[splitting[1][f]];\n    }\n\n    var dist, ndist;\n    for (var i = 0; i < Ci.length; i++) {\n        dist = 0;\n        for (var j = 0; j < Ci.length; j++) {\n            if (i !== j) {\n                dist += disFun(Ci[i], Ci[j]);\n            }\n        }\n        dist /= (Ci.length - 1);\n        ndist = 0;\n        for (var k = 0; k < Cj.length; k++) {\n            ndist += disFun(Ci[i], Cj[k]);\n        }\n        ndist /= Cj.length;\n        if ((dist - ndist) > ans.d) {\n            ans.d = (dist - ndist);\n            ans.p = i;\n        }\n    }\n    return ans;\n}\n\nvar defaultOptions = {\n    dist: euclidean,\n    kind: 'single'\n};\n\n/**\n * @private\n * Intra-cluster distance\n * @param {Array} index\n * @param {Array} data\n * @param {function} disFun\n * @returns {number}\n */\nfunction intrDist(index, data, disFun) {\n    var dist = 0,\n        count = 0;\n    for (var i = 0; i < index.length; i++) {\n        for (var j = i; j < index.length; j++) {\n            dist += disFun(data[index[i].index], data[index[j].index]);\n            count++;\n        }\n    }\n    return dist / count;\n}\n\n/**\n * Splits the higher level clusters\n * @param {Array <Array <number>>} data - Array of points to be clustered\n * @param {json} options\n * @constructor\n */\nfunction diana(data, options) {\n    options = Object.assign({}, defaultOptions, options);\n    if (typeof options.kind === 'string') {\n        switch (options.kind) {\n            case 'single':\n                options.kind = simpleLink;\n                break;\n            case 'complete':\n                options.kind = completeLink;\n                break;\n            case 'average':\n                options.kind = averageLink;\n                break;\n            case 'centroid':\n                options.kind = centroidLink;\n                break;\n            case 'ward':\n                options.kind = wardLink;\n                break;\n            default:\n                throw new RangeError('Unknown kind of similarity');\n        }\n    } else if (typeof options.kind !== 'function') {\n        throw new TypeError('Undefined kind of similarity');\n    }\n    var tree = new Cluster();\n    tree.children = new Array(data.length);\n    tree.index = new Array(data.length);\n    for (var ind = 0; ind < data.length; ind++) {\n        tree.children[ind] = new ClusterLeaf(ind);\n        tree.index[ind] = new ClusterLeaf(ind);\n    }\n\n    tree.distance = intrDist(tree.index, data, options.dist);\n    var m, M, clId,\n        dist, rebel;\n    var list = [tree];\n    while (list.length > 0) {\n        M = 0;\n        clId = 0;\n        for (var i = 0; i < list.length; i++) {\n            m = 0;\n            for (var j = 0; j < list[i].length; j++) {\n                for (var l = (j + 1); l < list[i].length; l++) {\n                    m = Math.max(options.dist(data[list[i].index[j].index], data[list[i].index[l].index]), m);\n                }\n            }\n            if (m > M) {\n                M = m;\n                clId = i;\n            }\n        }\n        M = 0;\n        if (list[clId].index.length === 2) {\n            list[clId].children = [list[clId].index[0], list[clId].index[1]];\n            list[clId].distance = options.dist(data[list[clId].index[0].index], data[list[clId].index[1].index]);\n        } else if (list[clId].index.length === 3) {\n            list[clId].children = [list[clId].index[0], list[clId].index[1], list[clId].index[2]];\n            var d = [\n                options.dist(data[list[clId].index[0].index], data[list[clId].index[1].index]),\n                options.dist(data[list[clId].index[1].index], data[list[clId].index[2].index])\n            ];\n            list[clId].distance = (d[0] + d[1]) / 2;\n        } else {\n            var C = new Cluster();\n            var sG = new Cluster();\n            var splitting = [new Array(list[clId].index.length), []];\n            for (var spl = 0; spl < splitting[0].length; spl++) {\n                splitting[0][spl] = spl;\n            }\n            for (var ii = 0; ii < splitting[0].length; ii++) {\n                dist = 0;\n                for (var jj = 0; jj < splitting[0].length; jj++) {\n                    if (ii !== jj) {\n                        dist += options.dist(data[list[clId].index[splitting[0][jj]].index], data[list[clId].index[splitting[0][ii]].index]);\n                    }\n                }\n                dist /= (splitting[0].length - 1);\n                if (dist > M) {\n                    M = dist;\n                    rebel = ii;\n                }\n            }\n            splitting[1] = [rebel];\n            splitting[0].splice(rebel, 1);\n            dist = diff(splitting, data, options.dist);\n            while (dist.d > 0) {\n                splitting[1].push(splitting[0][dist.p]);\n                splitting[0].splice(dist.p, 1);\n                dist = diff(splitting, data, options.dist);\n            }\n            var fData = new Array(splitting[0].length);\n            C.index = new Array(splitting[0].length);\n            for (var e = 0; e < fData.length; e++) {\n                fData[e] = data[list[clId].index[splitting[0][e]].index];\n                C.index[e] = list[clId].index[splitting[0][e]];\n                C.children[e] = list[clId].index[splitting[0][e]];\n            }\n            var sData = new Array(splitting[1].length);\n            sG.index = new Array(splitting[1].length);\n            for (var f = 0; f < sData.length; f++) {\n                sData[f] = data[list[clId].index[splitting[1][f]].index];\n                sG.index[f] = list[clId].index[splitting[1][f]];\n                sG.children[f] = list[clId].index[splitting[1][f]];\n            }\n            C.distance = intrDist(C.index, data, options.dist);\n            sG.distance = intrDist(sG.index, data, options.dist);\n            list.push(C);\n            list.push(sG);\n            list[clId].children = [C, sG];\n        }\n        list.splice(clId, 1);\n    }\n    return tree;\n}\n\nmodule.exports = diana;\n","'use strict';\n\nconst newArray = require('new-array');\n\nconst primeFinder = require('./primeFinder');\nconst nextPrime = primeFinder.nextPrime;\nconst largestPrime = primeFinder.largestPrime;\n\nconst FREE = 0;\nconst FULL = 1;\nconst REMOVED = 2;\n\nconst defaultInitialCapacity = 150;\nconst defaultMinLoadFactor = 1 / 6;\nconst defaultMaxLoadFactor = 2 / 3;\n\nclass HashTable {\n    constructor(options = {}) {\n        if (options instanceof HashTable) {\n            this.table = options.table.slice();\n            this.values = options.values.slice();\n            this.state = options.state.slice();\n            this.minLoadFactor = options.minLoadFactor;\n            this.maxLoadFactor = options.maxLoadFactor;\n            this.distinct = options.distinct;\n            this.freeEntries = options.freeEntries;\n            this.lowWaterMark = options.lowWaterMark;\n            this.highWaterMark = options.maxLoadFactor;\n            return;\n        }\n\n        const initialCapacity = options.initialCapacity === undefined ? defaultInitialCapacity : options.initialCapacity;\n        if (initialCapacity < 0) {\n            throw new RangeError(`initial capacity must not be less than zero: ${initialCapacity}`);\n        }\n\n        const minLoadFactor = options.minLoadFactor === undefined ? defaultMinLoadFactor : options.minLoadFactor;\n        const maxLoadFactor = options.maxLoadFactor === undefined ? defaultMaxLoadFactor : options.maxLoadFactor;\n        if (minLoadFactor < 0 || minLoadFactor >= 1) {\n            throw new RangeError(`invalid minLoadFactor: ${minLoadFactor}`);\n        }\n        if (maxLoadFactor <= 0 || maxLoadFactor >= 1) {\n            throw new RangeError(`invalid maxLoadFactor: ${maxLoadFactor}`);\n        }\n        if (minLoadFactor >= maxLoadFactor) {\n            throw new RangeError(`minLoadFactor (${minLoadFactor}) must be smaller than maxLoadFactor (${maxLoadFactor})`);\n        }\n\n        let capacity = initialCapacity;\n        // User wants to put at least capacity elements. We need to choose the size based on the maxLoadFactor to\n        // avoid the need to rehash before this capacity is reached.\n        // actualCapacity * maxLoadFactor >= capacity\n        capacity = (capacity / maxLoadFactor) | 0;\n        capacity = nextPrime(capacity);\n        if (capacity === 0) capacity = 1;\n\n        this.table = newArray(capacity, 0);\n        this.values = newArray(capacity, 0);\n        this.state = newArray(capacity, 0);\n\n        this.minLoadFactor = minLoadFactor;\n        if (capacity === largestPrime) {\n            this.maxLoadFactor = 1;\n        } else {\n            this.maxLoadFactor = maxLoadFactor;\n        }\n\n        this.distinct = 0;\n        this.freeEntries = capacity;\n\n        this.lowWaterMark = 0;\n        this.highWaterMark = chooseHighWaterMark(capacity, this.maxLoadFactor);\n    }\n\n    clone() {\n        return new HashTable(this);\n    }\n\n    get size() {\n        return this.distinct;\n    }\n\n    get(key) {\n        const i = this.indexOfKey(key);\n        if (i < 0) return 0;\n        return this.values[i];\n    }\n\n    set(key, value) {\n        let i = this.indexOfInsertion(key);\n        if (i < 0) {\n            i = -i - 1;\n            this.values[i] = value;\n            return false;\n        }\n\n        if (this.distinct > this.highWaterMark) {\n            const newCapacity = chooseGrowCapacity(this.distinct + 1, this.minLoadFactor, this.maxLoadFactor);\n            this.rehash(newCapacity);\n            return this.set(key, value);\n        }\n\n        this.table[i] = key;\n        this.values[i] = value;\n        if (this.state[i] === FREE) this.freeEntries--;\n        this.state[i] = FULL;\n        this.distinct++;\n\n        if (this.freeEntries < 1) {\n            const newCapacity = chooseGrowCapacity(this.distinct + 1, this.minLoadFactor, this.maxLoadFactor);\n            this.rehash(newCapacity);\n        }\n\n        return true;\n    }\n    \n    remove(key, noRehash) {\n        const i = this.indexOfKey(key);\n        if (i < 0) return false;\n\n        this.state[i] = REMOVED;\n        this.distinct--;\n\n        if (!noRehash) this.maybeShrinkCapacity();\n\n        return true;\n    }\n\n    delete(key, noRehash) {\n        const i = this.indexOfKey(key);\n        if (i < 0) return false;\n\n        this.state[i] = FREE;\n        this.distinct--;\n\n        if (!noRehash) this.maybeShrinkCapacity();\n\n        return true;\n    }\n\n    maybeShrinkCapacity() {\n        if (this.distinct < this.lowWaterMark) {\n            const newCapacity = chooseShrinkCapacity(this.distinct, this.minLoadFactor, this.maxLoadFactor);\n            this.rehash(newCapacity);\n        }\n    }\n\n    containsKey(key) {\n        return this.indexOfKey(key) >= 0;\n    }\n\n    indexOfKey(key) {\n        const table = this.table;\n        const state = this.state;\n        const length = this.table.length;\n\n        const hash = key & 0x7fffffff;\n        let i = hash % length;\n        let decrement = hash % (length - 2);\n        if (decrement === 0) decrement = 1;\n\n        while (state[i] !== FREE && (state[i] === REMOVED || table[i] !== key)) {\n            i -= decrement;\n            if (i < 0) i += length;\n        }\n\n        if (state[i] === FREE) return -1;\n        return i;\n    }\n\n    containsValue(value) {\n        return this.indexOfValue(value) >= 0;\n    }\n\n    indexOfValue(value) {\n        const values = this.values;\n        const state = this.state;\n\n        for (var i = 0; i < state.length; i++) {\n            if (state[i] === FULL && values[i] === value) {\n                return i;\n            }\n        }\n\n        return -1;\n    }\n\n    indexOfInsertion(key) {\n        const table = this.table;\n        const state = this.state;\n        const length = table.length;\n\n\n        const hash = key & 0x7fffffff;\n        let i = hash % length;\n        let decrement = hash % (length - 2);\n        if (decrement === 0) decrement = 1;\n\n        while (state[i] === FULL && table[i] !== key) {\n            i -= decrement;\n            if (i < 0) i += length;\n        }\n\n        if (state[i] === REMOVED) {\n            const j = i;\n            while (state[i] !== FREE && (state[i] === REMOVED || table[i] !== key)) {\n                i -= decrement;\n                if (i < 0) i += length;\n            }\n            if (state[i] === FREE) i = j;\n        }\n\n        if (state[i] === FULL) {\n            return -i - 1;\n        }\n\n        return i;\n    }\n\n    ensureCapacity(minCapacity) {\n        if (this.table.length < minCapacity) {\n            const newCapacity = nextPrime(minCapacity);\n            this.rehash(newCapacity);\n        }\n    }\n\n    rehash(newCapacity) {\n        const oldCapacity = this.table.length;\n\n        if (newCapacity <= this.distinct) throw new Error('Unexpected');\n\n        const oldTable = this.table;\n        const oldValues = this.values;\n        const oldState = this.state;\n\n        const newTable = newArray(newCapacity, 0);\n        const newValues = newArray(newCapacity, 0);\n        const newState = newArray(newCapacity, 0);\n\n        this.lowWaterMark = chooseLowWaterMark(newCapacity, this.minLoadFactor);\n        this.highWaterMark = chooseHighWaterMark(newCapacity, this.maxLoadFactor);\n\n        this.table = newTable;\n        this.values = newValues;\n        this.state = newState;\n        this.freeEntries = newCapacity - this.distinct;\n\n        for (var i = 0; i < oldCapacity; i++) {\n            if (oldState[i] === FULL) {\n                var element = oldTable[i];\n                var index = this.indexOfInsertion(element);\n                newTable[index] = element;\n                newValues[index] = oldValues[i];\n                newState[index] = FULL;\n            }\n        }\n    }\n\n    forEachKey(callback) {\n        for (var i = 0; i < this.state.length; i++) {\n            if (this.state[i] === FULL) {\n                if (!callback(this.table[i])) return false;\n            }\n        }\n        return true;\n    }\n\n    forEachValue(callback) {\n        for (var i = 0; i < this.state.length; i++) {\n            if (this.state[i] === FULL) {\n                if (!callback(this.values[i])) return false;\n            }\n        }\n        return true;\n    }\n\n    forEachPair(callback) {\n        for (var i = 0; i < this.state.length; i++) {\n            if (this.state[i] === FULL) {\n                if (!callback(this.table[i], this.values[i])) return false;\n            }\n        }\n        return true;\n    }\n}\n\nmodule.exports = HashTable;\n\nfunction chooseLowWaterMark(capacity, minLoad) {\n    return (capacity * minLoad) | 0;\n}\n\nfunction chooseHighWaterMark(capacity, maxLoad) {\n    return Math.min(capacity - 2, (capacity * maxLoad) | 0);\n}\n\nfunction chooseGrowCapacity(size, minLoad, maxLoad) {\n    return nextPrime(Math.max(size + 1, (4 * size / (3 * minLoad + maxLoad)) | 0));\n}\n\nfunction chooseShrinkCapacity(size, minLoad, maxLoad) {\n    return nextPrime(Math.max(size + 1, (4 * size / (minLoad + 3 * maxLoad)) | 0));\n}\n","const binarySearch = require('binary-search');\nconst sortAsc = require('num-sort').asc;\n\nconst largestPrime = 0x7fffffff;\n\nconst primeNumbers = [\n    //chunk #0\n    largestPrime, // 2^31-1\n\n    //chunk #1\n    5, 11, 23, 47, 97, 197, 397, 797, 1597, 3203, 6421, 12853, 25717, 51437, 102877, 205759,\n    411527, 823117, 1646237, 3292489, 6584983, 13169977, 26339969, 52679969, 105359939,\n    210719881, 421439783, 842879579, 1685759167,\n\n    //chunk #2\n    433, 877, 1759, 3527, 7057, 14143, 28289, 56591, 113189, 226379, 452759, 905551, 1811107,\n    3622219, 7244441, 14488931, 28977863, 57955739, 115911563, 231823147, 463646329, 927292699,\n    1854585413,\n\n    //chunk #3\n    953, 1907, 3821, 7643, 15287, 30577, 61169, 122347, 244703, 489407, 978821, 1957651, 3915341,\n    7830701, 15661423, 31322867, 62645741, 125291483, 250582987, 501165979, 1002331963,\n    2004663929,\n\n    //chunk #4\n    1039, 2081, 4177, 8363, 16729, 33461, 66923, 133853, 267713, 535481, 1070981, 2141977, 4283963,\n    8567929, 17135863, 34271747, 68543509, 137087021, 274174111, 548348231, 1096696463,\n\n    //chunk #5\n    31, 67, 137, 277, 557, 1117, 2237, 4481, 8963, 17929, 35863, 71741, 143483, 286973, 573953,\n    1147921, 2295859, 4591721, 9183457, 18366923, 36733847, 73467739, 146935499, 293871013,\n    587742049, 1175484103,\n\n    //chunk #6\n    599, 1201, 2411, 4831, 9677, 19373, 38747, 77509, 155027, 310081, 620171, 1240361, 2480729,\n    4961459, 9922933, 19845871, 39691759, 79383533, 158767069, 317534141, 635068283, 1270136683,\n\n    //chunk #7\n    311, 631, 1277, 2557, 5119, 10243, 20507, 41017, 82037, 164089, 328213, 656429, 1312867,\n    2625761, 5251529, 10503061, 21006137, 42012281, 84024581, 168049163, 336098327, 672196673,\n    1344393353,\n\n    //chunk #8\n    3, 7, 17, 37, 79, 163, 331, 673, 1361, 2729, 5471, 10949, 21911, 43853, 87719, 175447, 350899,\n    701819, 1403641, 2807303, 5614657, 11229331, 22458671, 44917381, 89834777, 179669557,\n    359339171, 718678369, 1437356741,\n\n    //chunk #9\n    43, 89, 179, 359, 719, 1439, 2879, 5779, 11579, 23159, 46327, 92657, 185323, 370661, 741337,\n    1482707, 2965421, 5930887, 11861791, 23723597, 47447201, 94894427, 189788857, 379577741,\n    759155483, 1518310967,\n\n    //chunk #10\n    379, 761, 1523, 3049, 6101, 12203, 24407, 48817, 97649, 195311, 390647, 781301, 1562611,\n    3125257, 6250537, 12501169, 25002389, 50004791, 100009607, 200019221, 400038451, 800076929,\n    1600153859,\n\n    //chunk #11\n    13, 29, 59, 127, 257, 521, 1049, 2099, 4201, 8419, 16843, 33703, 67409, 134837, 269683,\n    539389, 1078787, 2157587, 4315183, 8630387, 17260781, 34521589, 69043189, 138086407,\n    276172823, 552345671, 1104691373,\n\n    //chunk #12\n    19, 41, 83, 167, 337, 677,\n    1361, 2729, 5471, 10949, 21911, 43853, 87719, 175447, 350899,\n    701819, 1403641, 2807303, 5614657, 11229331, 22458671, 44917381, 89834777, 179669557,\n    359339171, 718678369, 1437356741,\n\n    //chunk #13\n    53, 107, 223, 449, 907, 1823, 3659, 7321, 14653, 29311, 58631, 117269,\n    234539, 469099, 938207, 1876417, 3752839, 7505681, 15011389, 30022781,\n    60045577, 120091177, 240182359, 480364727, 960729461, 1921458943\n];\n\nprimeNumbers.sort(sortAsc);\n\nfunction nextPrime(value) {\n    let index = binarySearch(primeNumbers, value, sortAsc);\n    if (index < 0) {\n        index = ~index;\n    }\n    return primeNumbers[index];\n}\n\nexports.nextPrime = nextPrime;\nexports.largestPrime = largestPrime;\n","'use strict';\nmodule.exports = Number.isNaN || function (x) {\n\treturn x !== x;\n};\n","import Matrix from 'ml-matrix';\nimport newArray from 'new-array';\nimport simpleClustering from 'ml-simple-clustering';\nimport hlClust from 'ml-hclust';\n\nexport default class SpinSystem {\n  constructor(chemicalShifts, couplingConstants, multiplicity) {\n    this.chemicalShifts = chemicalShifts;\n    this.couplingConstants = couplingConstants;\n    this.multiplicity = multiplicity;\n    this.nSpins = chemicalShifts.length;\n    this._initConnectivity();\n    this._initClusters();\n  }\n\n  static fromSpinusPrediction(result) {\n    var lines = result.split('\\n');\n    var nspins = lines.length - 1;\n    var cs = new Array(nspins);\n    var integrals = new Array(nspins);\n    var ids = {};\n    var jc = Matrix.zeros(nspins, nspins);\n    for (let i = 0; i < nspins; i++) {\n      var tokens = lines[i].split('\\t');\n      cs[i] = +tokens[2];\n      ids[tokens[0] - 1] = i;\n      integrals[i] = +tokens[5];// Is it always 1??\n    }\n    for (let i = 0; i < nspins; i++) {\n      tokens = lines[i].split('\\t');\n      var nCoup = (tokens.length - 4) / 3;\n      for (j = 0; j < nCoup; j++) {\n        var withID = tokens[4 + 3 * j] - 1;\n        var idx = ids[withID];\n        jc[i][idx] = +tokens[6 + 3 * j];\n      }\n    }\n\n    for (var j = 0; j < nspins; j++) {\n      for (var i = j; i < nspins; i++) {\n        jc[j][i] = jc[i][j];\n      }\n    }\n    return new SpinSystem(cs, jc, newArray(nspins, 2));\n  }\n\n  static fromPrediction(input) {\n    let predictions = SpinSystem.ungroupAtoms(input);\n    const nSpins = predictions.length;\n    const cs = new Array(nSpins);\n    const jc = Matrix.zeros(nSpins, nSpins);\n    const multiplicity = new Array(nSpins);\n    const ids = {};\n    var i, k, j;\n    for (i = 0; i < nSpins; i++) {\n      cs[i] = predictions[i].delta;\n      ids[predictions[i].atomIDs[0]] = i;\n    }\n    for (i = 0; i < nSpins; i++) {\n      cs[i] = predictions[i].delta;\n      j = predictions[i].j;\n      for (k = 0; k < j.length; k++) {\n        jc[ids[predictions[i].atomIDs[0]]][ids[j[k].assignment]] = j[k].coupling;\n        jc[ids[j[k].assignment]][ids[predictions[i].atomIDs[0]]] = j[k].coupling;\n      }\n      multiplicity[i] = predictions[i].integral + 1;\n    }\n\n    return new SpinSystem(cs, jc, multiplicity);\n  }\n\n\n  static ungroupAtoms(prediction) {\n    let result = [];\n    prediction.forEach((pred) => {\n      let atomIDs = pred.atomIDs;\n      if (atomIDs instanceof Array) {\n        for (let i = 0; i < atomIDs.length; i++) {\n          let tempPred = JSON.parse(JSON.stringify(pred));\n          let nmrJ = [];\n          tempPred.atomIDs = [atomIDs[i]];\n          tempPred.integral = 1;\n          if (tempPred.j instanceof Array) {\n            for (let j = 0; j < tempPred.j.length; j++) {\n              let assignment = tempPred.j[j].assignment;\n              if (assignment instanceof Array) {\n                for (let k = 0; k < assignment.length; k++) {\n                  let tempJ = JSON.parse(JSON.stringify(tempPred.j[j]));\n                  tempJ.assignment = assignment[k];\n                  nmrJ.push(tempJ);\n                }\n              }\n            }\n          }\n          tempPred.j = nmrJ;\n          delete tempPred.nbAtoms;\n          result.push(tempPred);\n        }\n      }\n    });\n\n    return result;\n  }\n\n\n  _initClusters() {\n    this.clusters = simpleClustering(this.connectivity, { out: 'indexes' });\n  }\n\n  _initConnectivity() {\n    const couplings = this.couplingConstants;\n    const connectivity = Matrix.ones(couplings.length, couplings.length);\n    for (var i = 0; i < couplings.length; i++) {\n      for (var j = i; j < couplings[i].length; j++) {\n        if (couplings[i][j] === 0) {\n          connectivity[i][j] = 0;\n          connectivity[j][i] = 0;\n        }\n      }\n    }\n    this.connectivity = connectivity;\n  }\n\n\n  _calculateBetas(J, frequency) {\n    var betas = Matrix.zeros(J.length, J.length);\n    // Before clustering, we must add hidden J, we could use molecular information if available\n    var i, j;\n    for (i = 0; i < J.rows; i++) {\n      for (j = i; j < J.columns; j++) {\n        if ((this.chemicalShifts[i] - this.chemicalShifts[j]) !== 0) {\n          betas[i][j] = 1 - Math.abs(J[i][j] / ((this.chemicalShifts[i] - this.chemicalShifts[j]) * frequency));\n          betas[j][i] = betas[i][j];\n        } else if (!(i === j || J[i][j] !== 0)) {\n          betas[i][j] = 1;\n          betas[j][i] = 1;\n        }\n      }\n    }\n    return betas;\n  }\n\n  ensureClusterSize(options) {\n    var betas = this._calculateBetas(this.couplingConstants, options.frequency || 400);\n    var cluster = hlClust.agnes(betas, { isDistanceMatrix: true });\n    var list = [];\n    this._splitCluster(cluster, list, options.maxClusterSize || 8, false);\n    var clusters = this._mergeClusters(list);\n    this.nClusters = clusters.length;\n    // console.log(clusters);\n    this.clusters = new Array(clusters.length);\n    // System.out.println(this.conmatrix);\n    for (var j = 0; j < this.nClusters; j++) {\n      this.clusters[j] = [];\n      for (var i = 0; i < this.nSpins; i++) {\n        if (clusters[j][i] !== 0) {\n          if (clusters[j][i] < 0) {\n            this.clusters[j].push(-(i + 1));\n          } else {\n            this.clusters[j].push(i);\n          }\n        }\n      }\n    }\n  }\n\n  /**\n     * Recursively split the clusters until the maxClusterSize criteria has been ensured.\n     * @param {Array} cluster\n     * @param {Array} clusterList\n     * @param {number} maxClusterSize\n     * @param  {boolean} force\n     */\n  _splitCluster(cluster, clusterList, maxClusterSize, force) {\n    if (!force && cluster.index.length <= maxClusterSize) {\n      clusterList.push(this._getMembers(cluster));\n    } else {\n      for (var child of cluster.children) {\n        if (!isNaN(child.index) || child.index.length <= maxClusterSize) {\n          var members = this._getMembers(child);\n          // Add the neighbors that shares at least 1 coupling with the given cluster\n          var count = 0;\n          for (var i = 0; i < this.nSpins; i++) {\n            if (members[i] === 1) {\n              count++;\n              for (var j = 0; j < this.nSpins; j++) {\n                if (this.connectivity[i][j] === 1 && members[j] === 0) {\n                  members[j] = -1;\n                  count++;\n                }\n              }\n            }\n          }\n\n          if (count <= maxClusterSize) {\n            clusterList.push(members);\n          } else {\n            if (isNaN(child.index)) {\n              this._splitCluster(child, clusterList, maxClusterSize, true);\n            } else {\n              // We have to threat this spin alone and use the resurrection algorithm instead of the simulation\n              members[child.index] = 2;\n              clusterList.push(members);\n            }\n          }\n        } else {\n          this._splitCluster(child, clusterList, maxClusterSize, false);\n        }\n      }\n    }\n  }\n  /**\n     * Recursively gets the cluster members\n     * @param cluster\n     * @param members\n     */\n\n  _getMembers(cluster) {\n    var members = new Array(this.nSpins);\n    for (var i = 0; i < this.nSpins; i++) {\n      members[i] = 0;\n    }\n    if (!isNaN(cluster.index)) {\n      members[cluster.index * 1] = 1;\n    } else {\n      for (var index of cluster.index) {\n        members[index.index * 1] = 1;\n      }\n    }\n    return members;\n  }\n\n  _mergeClusters(list) {\n    var nElements = 0;\n    var clusterA, clusterB, i, j, index, common, count;\n    for (i = list.length - 1; i >= 0; i--) {\n      clusterA = list[i];\n      nElements = clusterA.length;\n      index = 0;\n\n      // Is it a candidate to be merged?\n      while (index < nElements && clusterA[index++] !== -1);\n\n      if (index < nElements) {\n        for (j = list.length - 1; j >= i + 1; j--) {\n          clusterB = list[j];\n          // Do they have common elements?\n          index = 0;\n          common = 0;\n          count = 0;\n          while (index < nElements) {\n            if (clusterA[index] * clusterB[index] === -1) {\n              common++;\n            }\n            if (clusterA[index] !== 0 || clusterB[index] !== 0) {\n              count++;\n            }\n            index++;\n          }\n\n          if (common > 0 && count <= this.maxClusterSize) {\n            // Then we can merge those 2 clusters\n            index = 0;\n            while (index < nElements) {\n              if (clusterB[index] === 1) {\n                clusterA[index] = 1;\n              } else {\n                if (clusterB[index] === -1 && clusterA[index] !== 1) {\n                  clusterA[index] = -1;\n                }\n              }\n              index++;\n            }\n            // list.remove(clusterB);\n            list.splice(j, 1);\n            j++;\n          }\n        }\n      }\n    }\n\n    return list;\n  }\n}\n","import SparseMatrix from 'ml-sparse-matrix';\n\nfunction createPauli(mult) {\n  const spin = (mult - 1) / 2;\n  const prjs = new Array(mult);\n  const temp = new Array(mult);\n  for (var i = 0; i < mult; i++) {\n    prjs[i] = (mult - 1) - i - spin;\n    temp[i] = Math.sqrt(spin * (spin + 1) - prjs[i] * (prjs[i] + 1));\n  }\n  const p = diag(temp, 1, mult, mult);\n  for (i = 0; i < mult; i++) {\n    temp[i] = Math.sqrt(spin * (spin + 1) - prjs[i] * (prjs[i] - 1));\n  }\n  const m = diag(temp, -1, mult, mult);\n  const x = p.clone().add(m).mul(0.5);\n  const y = m.clone().mul(-1).add(p).mul(-0.5);\n  const z = diag(prjs, 0, mult, mult);\n  return { x, y, z, m, p };\n}\n\nfunction diag(A, d, n, m) {\n  const diag = new SparseMatrix(n, m, { initialCapacity: 20 });\n  for (var i = 0; i < A.length; i++) {\n    if ((i - d) >= 0 && (i - d) < n && i < m) {\n      diag.set(i - d, i, A[i]);\n    }\n  }\n  return diag;\n}\n\nconst pauli2 = createPauli(2);\n\nexport default function getPauli(mult) {\n  if (mult === 2) return pauli2;\n  else return createPauli(mult);\n}\n","import Matrix from 'ml-matrix';\nimport SparseMatrix from 'ml-sparse-matrix';\nimport binarySearch from 'binary-search';\nimport { asc as sortAsc } from 'num-sort';\n\nimport getPauli from './pauli';\n\nconst smallValue = 1e-2;\n\n\n/**\n * This function simulates a one dimensional nmr spectrum. This function returns an array containing the relative intensities of the spectrum in the specified simulation window (from-to).\n * @param {object} spinSystem - The SpinSystem object to be simulated\n * @param {object} options\n * @param {number} options.frequency - The frequency in Mhz of the fake spectrometer that records the spectrum. 400 by default\n * @param {number} options.from - The low limit of the ordinate variable. 0 by default\n * @param {number} options.to - The upper limit of the ordinate variable. 10 by default|\n * @param {number} options.lineWidth - The linewidth of the output spectrum, expresed in Hz. 1Hz by default\n * @param {number} options.nbPoints - Number of points of the output spectrum. 1024 by default\n * @param {number} options.maxClusterSize - Maximum number of atoms on each cluster that can be considered to be simulated together. It affects the the quality and speed of the simulation. 10 by default\n * @param {number} options.output - ['y' or 'xy'] it specify the output format. if 'y' is specified, the output of the simulation will be a single vector containing the y data of the spectrum. if 'xy' is specified, the output of the simulation will be an object containing {x,[], y:[]}, the x, y of the spectrum. 'y' by default\n * @return {object}\n */\nexport default function simulate1d(spinSystem, options) {\n  var i, j;\n  var {\n    lineWidth = 1,\n    nbPoints = 1024,\n    maxClusterSize = 10,\n    output = 'y',\n    frequency: frequencyMHz = 400,\n    noiseFactor = 1\n  } = options;\n\n  nbPoints = Number(nbPoints);\n\n  const from = options.from * frequencyMHz || 0;\n  const to = (options.to || 10) * frequencyMHz;\n\n  const chemicalShifts = spinSystem.chemicalShifts.slice();\n  for (i = 0; i < chemicalShifts.length; i++) {\n    chemicalShifts[i] = chemicalShifts[i] * frequencyMHz;\n  }\n\n  //Prepare pseudo voigt\n  let lineWidthPointsG = (nbPoints * lineWidth / Math.abs(to - from)) / 2.355;\n  let lineWidthPointsL = (nbPoints * lineWidth / Math.abs(to - from)) / 2;\n  let lnPoints = lineWidthPointsL * 40;\n\n  const gaussianLength = lnPoints | 0;\n  const gaussian = new Array(gaussianLength);\n  const b = lnPoints / 2;\n  const c = lineWidthPointsG * lineWidthPointsG * 2;\n  const l2 = lineWidthPointsL * lineWidthPointsL;\n  const g2pi = lineWidthPointsG * Math.sqrt(2 * Math.PI);\n  for (i = 0; i < gaussianLength; i++) {\n    let x2 = (i - b) * (i - b);\n    gaussian[i] = 10e9 * (Math.exp(-x2 / c) / g2pi + lineWidthPointsL / ((x2 + l2) * Math.PI));\n  }\n\n  var result = options.withNoise ? [...new Array(nbPoints)].map(() => Math.random() * noiseFactor) : new Array(nbPoints).fill(0);\n\n  const multiplicity = spinSystem.multiplicity;\n  for (var h = 0; h < spinSystem.clusters.length; h++) {\n    const cluster = spinSystem.clusters[h];\n\n    var clusterFake = new Array(cluster.length);\n    for (i = 0; i < cluster.length; i++) {\n      clusterFake[i] = cluster[i] < 0 ? -cluster[i] - 1 : cluster[i];\n    }\n\n    var weight = 1;\n    var sumI = 0;\n    const frequencies = [];\n    const intensities = [];\n    if (cluster.length > maxClusterSize) {\n      // This is a single spin, but the cluster exceeds the maxClusterSize criteria\n      // we use the simple multiplicity algorithm\n      // Add the central peak. It will be split with every single J coupling.\n      var index = 0;\n      while (cluster[index++] < 0);\n      index = cluster[index - 1];\n      var currentSize, jc;\n      frequencies.push(-chemicalShifts[index]);\n      for (i = 0; i < cluster.length; i++) {\n        if (cluster[i] < 0) {\n          jc = spinSystem.couplingConstants[index][clusterFake[i]] / 2;\n          currentSize = frequencies.length;\n          for (j = 0; j < currentSize; j++) {\n            frequencies.push(frequencies[j] + jc);\n            frequencies[j] -= jc;\n          }\n        }\n      }\n\n      frequencies.sort(sortAsc);\n      sumI = frequencies.length;\n      weight = 1;\n\n      for (i = 0; i < sumI; i++) {\n        intensities.push(1);\n      }\n    } else {\n      const hamiltonian = getHamiltonian(\n        chemicalShifts,\n        spinSystem.couplingConstants,\n        multiplicity,\n        spinSystem.connectivity,\n        clusterFake\n      );\n\n      const hamSize = hamiltonian.rows;\n      const evd = new Matrix.DC.EVD(hamiltonian);\n      const V = evd.eigenvectorMatrix;\n      const diagB = evd.realEigenvalues;\n      const assignmentMatrix = new SparseMatrix(hamSize, hamSize);\n      const multLen = cluster.length;\n      weight = 0;\n      for (var n = 0; n < multLen; n++) {\n        const L = getPauli(multiplicity[clusterFake[n]]);\n\n        let temp = 1;\n        for (j = 0; j < n; j++) {\n          temp *= multiplicity[clusterFake[j]];\n        }\n        const A = SparseMatrix.eye(temp);\n\n        temp = 1;\n        for (j = n + 1; j < multLen; j++) {\n          temp *= multiplicity[clusterFake[j]];\n        }\n        const B = SparseMatrix.eye(temp);\n        const tempMat = A.kroneckerProduct(L.m).kroneckerProduct(B);\n        if (cluster[n] >= 0) {\n          assignmentMatrix.add(tempMat.mul(cluster[n] + 1));\n          weight++;\n        } else {\n          assignmentMatrix.add(tempMat.mul(cluster[n]));\n        }\n      }\n\n      let rhoip = Matrix.zeros(hamSize, hamSize);\n      assignmentMatrix.forEachNonZero((i, j, v) => {\n        if (v > 0) {\n          const row = V[j];\n          for (var k = 0; k < row.length; k++) {\n            if (row[k] !== 0) {\n              rhoip.set(i, k, rhoip.get(i, k) + row[k]);\n            }\n          }\n        }\n        return v;\n      });\n\n      let rhoip2 = rhoip.clone();\n      assignmentMatrix.forEachNonZero((i, j, v) => {\n        if (v < 0) {\n          const row = V[j];\n          for (var k = 0; k < row.length; k++) {\n            if (row[k] !== 0) {\n              rhoip2.set(i, k, rhoip2.get(i, k) + row[k]);\n            }\n          }\n        }\n        return v;\n      });\n\n      const tV = V.transpose();\n      rhoip = tV.mmul(rhoip);\n      rhoip = new SparseMatrix(rhoip, { threshold: smallValue });\n      triuTimesAbs(rhoip, smallValue);\n      rhoip2 = tV.mmul(rhoip2);\n      rhoip2 = new SparseMatrix(rhoip2, { threshold: smallValue });\n      triuTimesAbs(rhoip2, smallValue);\n      // eslint-disable-next-line no-loop-func\n      rhoip2.forEachNonZero((i, j, v) => {\n        var val = rhoip.get(i, j);\n        val = Math.min(Math.abs(val), Math.abs(v));\n        val *= val;\n\n        sumI += val;\n        var valFreq = diagB[i] - diagB[j];\n        var insertIn = binarySearch(frequencies, valFreq, sortAsc);\n        if (insertIn < 0) {\n          frequencies.splice(-1 - insertIn, 0, valFreq);\n          intensities.splice(-1 - insertIn, 0, val);\n        } else {\n          intensities[insertIn] += val;\n        }\n      });\n    }\n    const numFreq = frequencies.length;\n    if (numFreq > 0) {\n      weight = weight / sumI;\n      const diff = lineWidth / 64;\n      let valFreq = frequencies[0];\n      let inte = intensities[0];\n      let count = 1;\n      for (i = 1; i < numFreq; i++) {\n        if (Math.abs(frequencies[i] - valFreq / count) < diff) {\n          inte += intensities[i];\n          valFreq += frequencies[i];\n          count++;\n        } else {\n          addPeak(result, valFreq / count, inte * weight, from, to, nbPoints, gaussian);\n          valFreq = frequencies[i];\n          inte = intensities[i];\n          count = 1;\n        }\n      }\n      addPeak(result, valFreq / count, inte * weight, from, to, nbPoints, gaussian);\n    }\n  }\n  if (output === 'xy') {\n    return { x: _getX(options.from, options.to, nbPoints), y: result };\n  }\n  if (output === 'y') {\n    return result;\n  }\n  throw new RangeError('wrong output option');\n}\n/**\n * Add a new peak to the current array\n * @param {Array} result - Array of numbers\n * @param {number} freq - center of the peak\n * @param {*} height - peak height\n * @param {*} from - start point of the peak\n * @param {*} to - end point of the peak\n * @param {*} nbPoints - number of points to add\n * @param {*} gaussian - Shape to fill with\n */\nfunction addPeak(result, freq, height, from, to, nbPoints, gaussian) {\n  const center = (nbPoints * (-freq - from) / (to - from)) | 0;\n  const lnPoints = gaussian.length;\n  var index = 0;\n  var indexLorentz = 0;\n  for (var i = center - lnPoints / 2; i < center + lnPoints / 2; i++) {\n    index = i | 0;\n    if (i >= 0 && i < nbPoints) {\n      result[index] = result[index] + gaussian[indexLorentz] * height;\n    }\n    indexLorentz++;\n  }\n}\n\nfunction triuTimesAbs(A, val) {\n  A.forEachNonZero((i, j, v) => {\n    if (i > j) return 0;\n    if (Math.abs(v) <= val) return 0;\n    return v;\n  });\n}\n/**\n * Create a hamiltonian matrix for the given spinsystem\n * @param {Array} chemicalShifts - An array containing the chemical shift in Hz\n * @param {Array} couplingConstants - An array containing the coupling constants in Hz\n * @param {Array} multiplicity - An array specifiying the multiplicities of each scalar coupling\n * @param {Array} conMatrix - A one step connectivity matrix for the given spin system\n * @param {Array} cluster - An binary array specifiying the spins to be considered for this hamiltonial\n * @return {object}\n */\nfunction getHamiltonian(chemicalShifts, couplingConstants, multiplicity, conMatrix, cluster) {\n  let hamSize = 1;\n  for (var i = 0; i < cluster.length; i++) {\n    hamSize *= multiplicity[cluster[i]];\n  }\n\n  const clusterHam = new SparseMatrix(hamSize, hamSize);\n\n  for (var pos = 0; pos < cluster.length; pos++) {\n    var n = cluster[pos];\n\n    const L = getPauli(multiplicity[n]);\n\n    let A1, B1;\n    let temp = 1;\n    for (let i = 0; i < pos; i++) {\n      temp *= multiplicity[cluster[i]];\n    }\n    A1 = SparseMatrix.eye(temp);\n\n    temp = 1;\n    for (let i = pos + 1; i < cluster.length; i++) {\n      temp *= multiplicity[cluster[i]];\n    }\n    B1 = SparseMatrix.eye(temp);\n\n    const alpha = chemicalShifts[n];\n    const kronProd = A1.kroneckerProduct(L.z).kroneckerProduct(B1);\n    clusterHam.add(kronProd.mul(alpha));\n\n    for (var pos2 = 0; pos2 < cluster.length; pos2++) {\n      const k = cluster[pos2];\n      if (conMatrix[n][k] === 1) {\n        const S = getPauli(multiplicity[k]);\n\n        let A2, B2;\n        let temp = 1;\n        for (let i = 0; i < pos2; i++) {\n          temp *= multiplicity[cluster[i]];\n        }\n        A2 = SparseMatrix.eye(temp);\n\n        temp = 1;\n        for (let i = pos2 + 1; i < cluster.length; i++) {\n          temp *= multiplicity[cluster[i]];\n        }\n        B2 = SparseMatrix.eye(temp);\n\n        const kron1 = A1.kroneckerProduct(L.x).kroneckerProduct(B1).mmul(A2.kroneckerProduct(S.x).kroneckerProduct(B2));\n        kron1.add(A1.kroneckerProduct(L.y).kroneckerProduct(B1).mul(-1).mmul(A2.kroneckerProduct(S.y).kroneckerProduct(B2)));\n        kron1.add(A1.kroneckerProduct(L.z).kroneckerProduct(B1).mmul(A2.kroneckerProduct(S.z).kroneckerProduct(B2)));\n\n        clusterHam.add(kron1.mul(couplingConstants[n][k] / 2));\n      }\n    }\n  }\n\n  return clusterHam;\n}\n\nfunction _getX(from, to, nbPoints) {\n  const x = new Array(nbPoints);\n  const dx = (to - from) / (nbPoints - 1);\n  for (var i = 0; i < nbPoints; i++) {\n    x[i] = from + i * dx;\n  }\n  return x;\n}\n","import Matrix from 'ml-matrix';\n\nlet defOptions = {\n  H: { frequency: 400, lineWidth: 10 },\n  C: { frequency: 100, lineWidth: 10 }\n};\n\nexport default function simule2DNmrSpectrum(table, options) {\n  var i;\n  const fromLabel = table[0].fromAtomLabel;\n  const toLabel = table[0].toLabel;\n  const frequencyX = options.frequencyX || defOptions[fromLabel].frequency;\n  const frequencyY = options.frequencyY || defOptions[toLabel].frequency;\n  var lineWidthX = options.lineWidthX || defOptions[fromLabel].lineWidth;\n  var lineWidthY = options.lineWidthY || defOptions[toLabel].lineWidth;\n  let symmetrize = options.symmetrize || false;\n\n  var sigmaX = lineWidthX / frequencyX;\n  var sigmaY = lineWidthY / frequencyY;\n\n  var minX = table[0].fromChemicalShift;\n  var maxX = table[0].fromChemicalShift;\n  var minY = table[0].toChemicalShift;\n  var maxY = table[0].toChemicalShift;\n  i = 1;\n  while (i < table.length) {\n    minX = Math.min(minX, table[i].fromChemicalShift);\n    maxX = Math.max(maxX, table[i].fromChemicalShift);\n    minY = Math.min(minY, table[i].toChemicalShift);\n    maxY = Math.max(maxY, table[i].toChemicalShift);\n    i++;\n  }\n\n  if (options.firstX !== null && !isNaN(options.firstX)) {\n    minX = options.firstX;\n  }\n  if (options.firstY !== null && !isNaN(options.firstY)) {\n    minY = options.firstY;\n  }\n  if (options.lastX !== null && !isNaN(options.lastX)) {\n    maxX = options.lastX;\n  }\n  if (options.lastY !== null && !isNaN(options.lastY)) {\n    maxY = options.lastY;\n  }\n\n  var nbPointsX = options.nbPointsX || 512;\n  var nbPointsY = options.nbPointsY || 512;\n\n  var spectraMatrix = new Matrix(nbPointsY, nbPointsX).fill(0);\n  i = 0;\n  while (i < table.length) {\n    // parameters.couplingConstant = table[i].j;\n    // parameters.pathLength = table[i].pathLength;\n    let peak = {\n      x: unitsToArrayPoints(table[i].fromChemicalShift, minX, maxX, nbPointsX),\n      y: unitsToArrayPoints(table[i].toChemicalShift, minY, maxY, nbPointsY),\n      z: table[i].fromAtoms.length + table[i].toAtoms.length,\n      widthX: unitsToArrayPoints(sigmaX + minX, minX, maxX, nbPointsX),\n      widthY: unitsToArrayPoints(sigmaY + minY, minY, maxY, nbPointsY)\n    };\n    addPeak(spectraMatrix, peak);\n    if (symmetrize) {\n      addPeak(spectraMatrix, { x: peak.y, y: peak.x, z: peak.z, widthX: peak.widthY, widthY: peak.widthX });\n    }\n    i++;\n  }\n  return spectraMatrix;\n}\n\nfunction unitsToArrayPoints(x, from, to, nbPoints) {\n  return ((x - from) * (nbPoints - 1)) / (to - from);\n}\n\nfunction addPeak(matrix, peak) {\n  var nSigma = 4;\n  var fromX = Math.max(0, Math.round(peak.x - peak.widthX * nSigma));\n  var toX = Math.min(matrix[0].length - 1, Math.round(peak.x + peak.widthX * nSigma));\n  var fromY = Math.max(0, Math.round(peak.y - peak.widthY * nSigma));\n  var toY = Math.min(matrix.length - 1, Math.round(peak.y + peak.widthY * nSigma));\n\n  var squareSigmaX = peak.widthX * peak.widthX;\n  var squareSigmaY = peak.widthY * peak.widthY;\n  for (var j = fromY; j < toY; j++) {\n    for (var i = fromX; i < toX; i++) {\n      var exponent = Math.pow(peak.x - i, 2) / squareSigmaX +\n                Math.pow(peak.y - j, 2) / squareSigmaY;\n      var result = 10000 * peak.z * Math.exp(-exponent);\n      matrix[j][i] += result;\n    }\n  }\n}\n","export { default as SpinSystem } from './SpinSystem';\nexport { default as simulate1D } from './simulate1D';\nexport { default as simulate2D } from './simulate2D';\n"],"sourceRoot":""}