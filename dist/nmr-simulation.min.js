!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.nmrSimulation=r():t.nmrSimulation=r()}("undefined"!=typeof self?self:this,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var i in t)e.d(n,i,function(r){return t[r]}.bind(null,i));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=19)}([function(module,exports,__webpack_require__){const HashTable=__webpack_require__(46);class SparseMatrix{constructor(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t instanceof SparseMatrix){const r=t;this._init(r.rows,r.columns,r.elements.clone(),r.threshold)}else if(Array.isArray(t)){const s=t;t=s.length,e=r||{},r=s[0].length,this._init(t,r,new HashTable(e),e.threshold);for(var n=0;n<t;n++)for(var i=0;i<r;i++){var o=s[n][i];this.threshold&&Math.abs(o)<this.threshold&&(o=0),0!==o&&this.elements.set(n*r+i,s[n][i])}}else this._init(t,r,new HashTable(e),e.threshold)}_init(t,r,e,n){this.rows=t,this.columns=r,this.elements=e,this.threshold=n||0}static eye(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const e=Math.min(t,r),n=new SparseMatrix(t,r,{initialCapacity:e});for(var i=0;i<e;i++)n.set(i,i,1);return n}clone(){return new SparseMatrix(this)}to2DArray(){const t=new Array(this.rows);for(var r=0;r<this.rows;r++){t[r]=new Array(this.columns);for(var e=0;e<this.columns;e++)t[r][e]=this.get(r,e)}return t}isSquare(){return this.rows===this.columns}isSymmetric(){if(!this.isSquare())return!1;var t=!0;return this.forEachNonZero((r,e,n)=>this.get(e,r)!==n?(t=!1,!1):n),t}get cardinality(){return this.elements.size}get size(){return this.rows*this.columns}get(t,r){return this.elements.get(t*this.columns+r)}set(t,r,e){return this.threshold&&Math.abs(e)<this.threshold&&(e=0),0===e?this.elements.remove(t*this.columns+r):this.elements.set(t*this.columns+r,e),this}mmul(t){this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");const r=this.rows,e=t.columns,n=new SparseMatrix(r,e);return this.forEachNonZero((r,e,i)=>(t.forEachNonZero((t,o,s)=>(e===t&&n.set(r,o,n.get(r,o)+i*s),s)),i)),n}kroneckerProduct(t){const r=this.rows,e=this.columns,n=t.rows,i=t.columns,o=new SparseMatrix(r*n,e*i,{initialCapacity:this.cardinality*t.cardinality});return this.forEachNonZero((r,e,s)=>(t.forEachNonZero((t,a,h)=>(o.set(n*r+t,i*e+a,s*h),h)),s)),o}forEachNonZero(t){return this.elements.forEachPair((r,e)=>{const n=r/this.columns|0,i=r%this.columns;let o=t(n,i,e);return!1!==o&&(this.threshold&&Math.abs(o)<this.threshold&&(o=0),o!==e&&(0===o?this.elements.remove(r,!0):this.elements.set(r,o)),!0)}),this.elements.maybeShrinkCapacity(),this}getNonZeros(){const t=this.cardinality,r=new Array(t),e=new Array(t),n=new Array(t);var i=0;return this.forEachNonZero((t,o,s)=>(r[i]=t,e[i]=o,n[i]=s,i++,s)),{rows:r,columns:e,values:n}}setThreshold(t){return 0!==t&&t!==this.threshold&&(this.threshold=t,this.forEachNonZero((t,r,e)=>e)),this}}SparseMatrix.prototype.klass="Matrix",SparseMatrix.identity=SparseMatrix.eye,SparseMatrix.prototype.tensorProduct=SparseMatrix.prototype.kroneckerProduct,module.exports=SparseMatrix;var inplaceOperator="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",inplaceOperatorScalar="\n(function %name%S(value) {\n    this.forEachNonZero((i, j, v) => v %op% value);\n    return this;\n})\n",inplaceOperatorMatrix="\n(function %name%M(matrix) {\n    matrix.forEachNonZero((i, j, v) => {\n        this.set(i, j, this.get(i, j) %op% v);\n        return v;\n    });\n    return this;\n})\n",staticOperator="\n(function %name%(matrix, value) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%(value);\n})\n",inplaceMethod="\n(function %name%() {\n    this.forEachNonZero((i, j, v) => %method%(v));\n    return this;\n})\n",staticMethod="\n(function %name%(matrix) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%();\n})\n",operators=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]];for(var operator of operators)for(var i=1;i<operator.length;i++)SparseMatrix.prototype[operator[i]]=eval(fillTemplateFunction(inplaceOperator,{name:operator[i],op:operator[0]})),SparseMatrix.prototype[operator[i]+"S"]=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[i]+"S",op:operator[0]})),SparseMatrix.prototype[operator[i]+"M"]=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[i]+"M",op:operator[0]})),SparseMatrix[operator[i]]=eval(fillTemplateFunction(staticOperator,{name:operator[i]}));var methods=[["~","not"]];for(var method of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){methods.push(["Math."+t,t])}),methods))for(var i=1;i<method.length;i++)SparseMatrix.prototype[method[i]]=eval(fillTemplateFunction(inplaceMethod,{name:method[i],method:method[0]})),SparseMatrix[method[i]]=eval(fillTemplateFunction(staticMethod,{name:method[i]}));function fillTemplateFunction(t,r){for(var e in r)t=t.replace(new RegExp("%"+e+"%","g"),r[e]);return t}},function(t,r,e){"use strict";t.exports=e(2).Matrix,t.exports.Decompositions=t.exports.DC=e(33)},function(t,r,e){"use strict";e(20);var n=e(10),i=e(4);class o extends(n(Array)){constructor(t,r){var e;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(o.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(r)&&r>0))throw new TypeError("nColumns must be a positive integer");for(e=0;e<t;e++)this[e]=new Array(r)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if(t=n.length,"number"!=typeof(r=n[0].length)||0===r)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),e=0;e<t;e++){if(n[e].length!==r)throw new RangeError("Inconsistent array dimensions");this[e]=[].concat(n[e])}}}return this.rows=t,this.columns=r,this}set(t,r,e){return this[t][r]=e,this}get(t,r){return this[t][r]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,r){return void 0===r&&(r=t,t=this.rows),i.checkRowIndex(this,t,!0),r=i.checkRowVector(this,r,!0),this.splice(t,0,r),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0;r<this.rows;r++)this[r].splice(t,1);return this.columns-=1,this}addColumn(t,r){void 0===r&&(r=t,t=this.columns),i.checkColumnIndex(this,t,!0),r=i.checkColumnVector(this,r);for(var e=0;e<this.rows;e++)this[e].splice(t,0,r[e]);return this.columns+=1,this}}r.Matrix=o,o.abstractMatrix=n},function(t,r,e){"use strict";var n=e(10),i=e(2);t.exports=class extends(n()){constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}static get[Symbol.species](){return i.Matrix}}},function(t,r,e){"use strict";var n=e(2);r.checkRowIndex=function(t,r,e){var n=e?t.rows:t.rows-1;if(r<0||r>n)throw new RangeError("Row index out of range")},r.checkColumnIndex=function(t,r,e){var n=e?t.columns:t.columns-1;if(r<0||r>n)throw new RangeError("Column index out of range")},r.checkRowVector=function(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r},r.checkColumnVector=function(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r},r.checkIndices=function(t,r,e){var n=r.some(r=>r<0||r>=t.rows),i=e.some(r=>r<0||r>=t.columns);if(n||i)throw new RangeError("Indices are out of range");if("object"!=typeof r||"object"!=typeof e)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(r)||(r=Array.from(r)),Array.isArray(e)||(r=Array.from(e)),{row:r,column:e}},r.checkRange=function(t,r,e,n,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(r>e||n>i||r<0||r>=t.rows||e<0||e>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},r.getRange=function(t,r){for(var e=new Array(r-t+1),n=0;n<e.length;n++)e[n]=t+n;return e},r.sumByRow=function(t){for(var r=n.Matrix.zeros(t.rows,1),e=0;e<t.rows;++e)for(var i=0;i<t.columns;++i)r.set(e,0,r.get(e,0)+t.get(e,i));return r},r.sumByColumn=function(t){for(var r=n.Matrix.zeros(1,t.columns),e=0;e<t.rows;++e)for(var i=0;i<t.columns;++i)r.set(0,i,r.get(0,i)+t.get(e,i));return r},r.sumAll=function(t){for(var r=0,e=0;e<t.rows;e++)for(var n=0;n<t.columns;n++)r+=t.get(e,n);return r}},function(t,r,e){"use strict";var n=e(48);function i(t){if("number"!=typeof t||n(t))throw new TypeError("Expected a number")}r.asc=function(t,r){return i(t),i(r),t-r},r.desc=function(t,r){return i(t),i(r),r-t}},function(t,r,e){"use strict";r.hypotenuse=function(t,r){var e;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0},r.getEmpty2DArray=function(t,r){for(var e=new Array(t),n=0;n<t;n++)e[n]=new Array(r);return e},r.getFilled2DArray=function(t,r,e){for(var n=new Array(t),i=0;i<t;i++){n[i]=new Array(r);for(var o=0;o<r;o++)n[i][o]=e}return n}},function(t,r,e){"use strict";const n=e(38);function i(){this.children=[],this.distance=-1,this.index=[]}i.prototype.cut=function(t){if(t<0)throw new RangeError("Threshold too small");var r=new i;r.children=this.children,r.distance=this.distance,r.index=this.index;for(var e=[r],n=[];e.length>0;){var o=e.shift();t>=o.distance?n.push(o):e=e.concat(o.children)}return n},i.prototype.group=function(t){if(!Number.isInteger(t)||t<1)throw new RangeError("Number of groups must be a positive integer");const r=new n(function(t,r){return r.distance-t.distance});for(r.push(this);r.size()<t;){var e=r.pop();if(0===e.children.length)break;e.children.forEach(t=>r.push(t))}var o=new i;return o.children=r.toArray(),o.distance=this.distance,o},i.prototype.traverse=function(t){!function t(r,e){if(e(r),r.children)for(var n=r.children.length-1;n>=0;n--)t(r.children[n],e)}(this,t)},t.exports=i},function(t,r){t.exports=function(t,r){t=t||0;for(var e=new Array(t),n=0;n<t;n++)e[n]=r;return e}},function(t,r){t.exports=function(t,r,e,n,i){var o,s;if(void 0===n)n=0;else if((n|=0)<0||n>=t.length)throw new RangeError("invalid lower bound");if(void 0===i)i=t.length-1;else if((i|=0)<n||i>=t.length)throw new RangeError("invalid upper bound");for(;n<=i;)if((s=+e(t[o=n+(i-n>>1)],r,o,t))<0)n=o+1;else{if(!(s>0))return o;i=o-1}return~n}},function(module,exports,__webpack_require__){"use strict";module.exports=abstractMatrix;var LuDecomposition=__webpack_require__(11),SvDecomposition=__webpack_require__(12),arrayUtils=__webpack_require__(21),util=__webpack_require__(4),MatrixTransposeView=__webpack_require__(26),MatrixRowView=__webpack_require__(27),MatrixSubView=__webpack_require__(28),MatrixSelectionView=__webpack_require__(29),MatrixColumnView=__webpack_require__(30),MatrixFlipRowView=__webpack_require__(31),MatrixFlipColumnView=__webpack_require__(32);function abstractMatrix(superCtor){void 0===superCtor&&(superCtor=Object);class Matrix extends superCtor{static get[Symbol.species](){return this}static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,r),i=0;i<t;i++)for(var o=0;o<r;o++)n.set(i,o,e[i*r+o]);return n}static rowVector(t){for(var r=new this(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){for(var r=new this(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static empty(t,r){return new this(t,r)}static zeros(t,r){return this.empty(t,r).fill(0)}static ones(t,r){return this.empty(t,r).fill(1)}static rand(t,r,e){void 0===e&&(e=Math.random);for(var n=this.empty(t,r),i=0;i<t;i++)for(var o=0;o<r;o++)n.set(i,o,e());return n}static randInt(t,r,e,n){void 0===e&&(e=1e3),void 0===n&&(n=Math.random);for(var i=this.empty(t,r),o=0;o<t;o++)for(var s=0;s<r;s++){var a=Math.floor(n()*e);i.set(o,s,a)}return i}static eye(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var n=Math.min(t,r),i=this.zeros(t,r),o=0;o<n;o++)i.set(o,o,e);return i}static diag(t,r,e){var n=t.length;void 0===r&&(r=n),void 0===e&&(e=r);for(var i=Math.min(n,r,e),o=this.zeros(r,e),s=0;s<i;s++)o.set(s,s,t[s]);return o}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,i=new this(e,n),o=0;o<e;o++)for(var s=0;s<n;s++)i.set(o,s,Math.min(t.get(o,s),r.get(o,s)));return i}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,i=new this(e,n),o=0;o<e;o++)for(var s=0;s<n;s++)i.set(o,s,Math.max(t.get(o,s),r.get(o,s)));return i}static checkMatrix(t){return Matrix.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=this.rows,e=this.columns,n=0;n<r;n++)for(var i=0;i<e;i++)t.call(this,n,i);return this}to1DArray(){for(var t=new Array(this.size),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t[r*this.columns+e]=this.get(r,e);return t}to2DArray(){for(var t=new Array(this.rows),r=0;r<this.rows;r++){t[r]=new Array(this.columns);for(var e=0;e<this.columns;e++)t[r][e]=this.get(r,e)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}set(t,r,e){throw new Error("set method is unimplemented")}get(t,r){throw new Error("get method is unimplemented")}repeat(t,r){t=t||1,r=r||1;for(var e=new this.constructor[Symbol.species](this.rows*t,this.columns*r),n=0;n<t;n++)for(var i=0;i<r;i++)e.setSubMatrix(this,this.rows*n,this.columns*i);return e}fill(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){util.checkRowIndex(this,t);for(var r=new Array(this.columns),e=0;e<this.columns;e++)r[e]=this.get(t,e);return r}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,r){util.checkRowIndex(this,t),r=util.checkRowVector(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){util.checkRowIndex(this,t),util.checkRowIndex(this,r);for(var e=0;e<this.columns;e++){var n=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,n)}return this}getColumn(t){util.checkColumnIndex(this,t);for(var r=new Array(this.rows),e=0;e<this.rows;e++)r[e]=this.get(e,t);return r}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,r){util.checkColumnIndex(this,t),r=util.checkColumnVector(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){util.checkColumnIndex(this,t),util.checkColumnIndex(this,r);for(var e=0;e<this.rows;e++){var n=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,n)}return this}addRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){util.checkRowIndex(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){util.checkColumnIndex(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}min(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}maxRow(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)>r&&(r=this.get(t,n),e[1]=n);return e}minRow(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)<r&&(r=this.get(t,n),e[1]=n);return e}maxColumn(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)>r&&(r=this.get(n,t),e[0]=n);return e}minColumn(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)<r&&(r=this.get(n,t),e[0]=n);return e}diag(){for(var t=Math.min(this.rows,this.columns),r=new Array(t),e=0;e<t;e++)r[e]=this.get(e,e);return r}sum(t){switch(t){case"row":return util.sumByRow(this);case"column":return util.sumByColumn(this);default:return util.sumAll(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t*=this.get(r,e);return t}cumulativeSum(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){Matrix.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var e=0,n=0;n<r.length;n++)e+=r[n]*t[n];return e}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var r=this.rows,e=this.columns,n=t.columns,i=new this.constructor[Symbol.species](r,n),o=new Array(e),s=0;s<n;s++){for(var a=0;a<e;a++)o[a]=t.get(a,s);for(var h=0;h<r;h++){var u=0;for(a=0;a<e;a++)u+=this.get(h,a)*o[a];i.set(h,s,u)}}return i}strassen2x2(t){var r=new this.constructor[Symbol.species](2,2);const e=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),h=this.get(1,1),u=t.get(1,1),c=(e+h)*(n+u),l=(s+h)*n,f=e*(o-u),m=h*(a-n),g=(e+i)*u,d=c+m-g+(i-h)*(a+u),p=f+g,v=l+m,w=c-l+f+(s-e)*(n+o);return r.set(0,0,d),r.set(0,1,p),r.set(1,0,v),r.set(1,1,w),r}strassen3x3(t){var r=new this.constructor[Symbol.species](3,3);const e=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),h=this.get(2,0),u=this.get(2,1),c=this.get(2,2),l=t.get(0,0),f=t.get(0,1),m=t.get(0,2),g=t.get(1,0),d=t.get(1,1),p=t.get(1,2),v=t.get(2,0),w=t.get(2,1),x=t.get(2,2),y=(e-o)*(-f+d),M=(-e+o+s)*(l-f+d),b=(o+s)*(-l+f),A=e*l,k=(-e+h+u)*(l-m+p),S=(-e+h)*(m-p),E=(h+u)*(-l+m),R=(-i+u+c)*(d+v-w),C=(i-c)*(d-w),O=i*v,_=(u+c)*(-v+w),V=(-i+s+a)*(p+v-x),j=(i-a)*(p-x),T=(s+a)*(-v+x),D=A+O+n*g,I=(e+n+i-o-s-u-c)*d+M+b+A+R+O+_,N=A+k+E+(e+n+i-s-a-h-u)*p+O+V+T,F=y+s*(-l+f+g-d-p-v+x)+M+A+O+V+j,z=y+M+b+A+a*w,q=O+V+j+T+o*m,P=A+k+S+u*(-l+m+g-d-p-v+w)+R+C+O,W=R+C+O+_+h*f,L=A+k+S+E+c*x;return r.set(0,0,D),r.set(0,1,I),r.set(0,2,N),r.set(1,0,F),r.set(1,1,z),r.set(1,2,q),r.set(2,0,P),r.set(2,1,W),r.set(2,2,L),r}mmulStrassen(t){var r=this.clone(),e=r.rows,n=r.columns,i=t.rows,o=t.columns;function s(t,r,e){var n=t.rows,i=t.columns;if(n===r&&i===e)return t;var o=Matrix.zeros(r,e);return o=o.setSubMatrix(t,0,0)}n!==i&&console.warn("Multiplying ".concat(e," x ").concat(n," and ").concat(i," x ").concat(o," matrix: dimensions do not match."));var a=Math.max(e,i),h=Math.max(n,o);return function t(r,e,n,i){if(n<=512||i<=512)return r.mmul(e);n%2==1&&i%2==1?(r=s(r,n+1,i+1),e=s(e,n+1,i+1)):n%2==1?(r=s(r,n+1,i),e=s(e,n+1,i)):i%2==1&&(r=s(r,n,i+1),e=s(e,n,i+1));var o=parseInt(r.rows/2),a=parseInt(r.columns/2),h=r.subMatrix(0,o-1,0,a-1),u=e.subMatrix(0,o-1,0,a-1),c=r.subMatrix(0,o-1,a,r.columns-1),l=e.subMatrix(0,o-1,a,e.columns-1),f=r.subMatrix(o,r.rows-1,0,a-1),m=e.subMatrix(o,e.rows-1,0,a-1),g=r.subMatrix(o,r.rows-1,a,r.columns-1),d=e.subMatrix(o,e.rows-1,a,e.columns-1),p=t(Matrix.add(h,g),Matrix.add(u,d),o,a),v=t(Matrix.add(f,g),u,o,a),w=t(h,Matrix.sub(l,d),o,a),x=t(g,Matrix.sub(m,u),o,a),y=t(Matrix.add(h,c),d,o,a),M=t(Matrix.sub(f,h),Matrix.add(u,l),o,a),b=t(Matrix.sub(c,g),Matrix.add(m,d),o,a),A=Matrix.add(p,x);A.sub(y),A.add(b);var k=Matrix.add(w,y),S=Matrix.add(v,x),E=Matrix.sub(p,v);E.add(w),E.add(M);var R=Matrix.zeros(2*A.rows,2*A.columns);return(R=(R=(R=(R=R.setSubMatrix(A,0,0)).setSubMatrix(k,A.rows,0)).setSubMatrix(S,0,A.columns)).setSubMatrix(E,A.rows,A.columns)).subMatrix(0,n-1,0,i-1)}(r=s(r,a,h),t=s(t,a,h),a,h)}scaleRows(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var i=arrayUtils.scale(this.getRow(n),{min:t,max:r});e.setRow(n,i)}return e}scaleColumns(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var i=arrayUtils.scale(this.getColumn(n),{min:t,max:r});e.setColumn(n,i)}return e}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var r=this.rows,e=this.columns,n=t.rows,i=t.columns,o=new this.constructor[Symbol.species](r*n,e*i),s=0;s<r;s++)for(var a=0;a<e;a++)for(var h=0;h<n;h++)for(var u=0;u<i;u++)o[n*s+h][i*a+u]=this.get(s,a)*t.get(h,u);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(t){void 0===t&&(t=compareNumbers);for(var r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(t){void 0===t&&(t=compareNumbers);for(var r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,n){util.checkRange(this,t,r,e,n);for(var i=new this.constructor[Symbol.species](r-t+1,n-e+1),o=t;o<=r;o++)for(var s=e;s<=n;s++)i[o-t][s-e]=this.get(o,s);return i}subMatrixRow(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,e-r+1),i=0;i<t.length;i++)for(var o=r;o<=e;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);n.set(i,o-r,this.get(t[i],o))}return n}subMatrixColumn(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](e-r+1,t.length),i=0;i<t.length;i++)for(var o=r;o<=e;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);n.set(o-r,i,this.get(o,t[i]))}return n}setSubMatrix(t,r,e){var n=r+(t=this.constructor.checkMatrix(t)).rows-1,i=e+t.columns-1;util.checkRange(this,r,n,e,i);for(var o=0;o<t.rows;o++)for(var s=0;s<t.columns;s++)this[r+o][e+s]=t.get(o,s);return this}selection(t,r){for(var e=util.checkIndices(this,t,r),n=new this.constructor[Symbol.species](t.length,r.length),i=0;i<e.row.length;i++)for(var o=e.row[i],s=0;s<e.column.length;s++){var a=e.column[s];n[i][s]=this.get(o,a)}return n}trace(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}transposeView(){return new MatrixTransposeView(this)}rowView(t){return util.checkRowIndex(this,t),new MatrixRowView(this,t)}columnView(t){return util.checkColumnIndex(this,t),new MatrixColumnView(this,t)}flipRowView(){return new MatrixFlipRowView(this)}flipColumnView(){return new MatrixFlipColumnView(this)}subMatrixView(t,r,e,n){return new MatrixSubView(this,t,r,e,n)}selectionView(t,r){return new MatrixSelectionView(this,t,r)}det(){var t,r,e,n,i,o;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),r=this.get(0,1),e=this.get(1,0),t*this.get(1,1)-r*e):3===this.columns?(n=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),o=this.selectionView([1,2],[0,1]),t=this.get(0,0),r=this.get(0,1),e=this.get(0,2),t*n.det()-r*i.det()+e*o.det()):new LuDecomposition(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var r=new SvDecomposition(this,{autoTranspose:!0}),e=r.leftSingularVectors,n=r.rightSingularVectors,i=r.diagonal,o=0;o<i.length;o++)Math.abs(i[o])>t?i[o]=1/i[o]:i[o]=0;return i=this.constructor[Symbol.species].diag(i),n.mmul(i.mmul(e.transposeView()))}}function checkDimensions(t,r){if(t.rows!==r.rows||t.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal")}function compareNumbers(t,r){return t-r}Matrix.prototype.klass="Matrix",Matrix.random=Matrix.rand,Matrix.diagonal=Matrix.diag,Matrix.prototype.diagonal=Matrix.prototype.diag,Matrix.identity=Matrix.eye,Matrix.prototype.negate=Matrix.prototype.neg,Matrix.prototype.tensorProduct=Matrix.prototype.kroneckerProduct,Matrix.prototype.determinant=Matrix.prototype.det;var inplaceOperator="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",inplaceOperatorScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",inplaceOperatorMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",staticOperator="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",inplaceMethod="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",staticMethod="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",inplaceMethodWithArgs="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",staticMethodWithArgs="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",inplaceMethodWithOneArgScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArgMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArg="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",staticMethodWithOneArg=staticMethodWithArgs,operators=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],i;for(var operator of operators){var inplaceOp=eval(fillTemplateFunction(inplaceOperator,{name:operator[1],op:operator[0]})),inplaceOpS=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[1]+"S",op:operator[0]})),inplaceOpM=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[1]+"M",op:operator[0]})),staticOp=eval(fillTemplateFunction(staticOperator,{name:operator[1]}));for(i=1;i<operator.length;i++)Matrix.prototype[operator[i]]=inplaceOp,Matrix.prototype[operator[i]+"S"]=inplaceOpS,Matrix.prototype[operator[i]+"M"]=inplaceOpM,Matrix[operator[i]]=staticOp}var methods=[["~","not"]];for(var method of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){methods.push(["Math."+t,t])}),methods)){var inplaceMeth=eval(fillTemplateFunction(inplaceMethod,{name:method[1],method:method[0]})),staticMeth=eval(fillTemplateFunction(staticMethod,{name:method[1]}));for(i=1;i<method.length;i++)Matrix.prototype[method[i]]=inplaceMeth,Matrix[method[i]]=staticMeth}var methodsWithArgs=[["Math.pow",1,"pow"]];for(var methodWithArg of methodsWithArgs){var args="arg0";for(i=1;i<methodWithArg[1];i++)args+=", arg".concat(i);if(1!==methodWithArg[1]){var inplaceMethWithArgs=eval(fillTemplateFunction(inplaceMethodWithArgs,{name:methodWithArg[2],method:methodWithArg[0],args:args})),staticMethWithArgs=eval(fillTemplateFunction(staticMethodWithArgs,{name:methodWithArg[2],args:args}));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethWithArgs,Matrix[methodWithArg[i]]=staticMethWithArgs}else{var tmplVar={name:methodWithArg[2],args:args,method:methodWithArg[0]},inplaceMethod2=eval(fillTemplateFunction(inplaceMethodWithOneArg,tmplVar)),inplaceMethodS=eval(fillTemplateFunction(inplaceMethodWithOneArgScalar,tmplVar)),inplaceMethodM=eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix,tmplVar)),staticMethod2=eval(fillTemplateFunction(staticMethodWithOneArg,tmplVar));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethod2,Matrix.prototype[methodWithArg[i]+"M"]=inplaceMethodM,Matrix.prototype[methodWithArg[i]+"S"]=inplaceMethodS,Matrix[methodWithArg[i]]=staticMethod2}}function fillTemplateFunction(t,r){for(var e in r)t=t.replace(new RegExp("%"+e+"%","g"),r[e]);return t}return Matrix}},function(t,r,e){"use strict";var n=e(2);function i(t){if(!(this instanceof i))return new i(t);var r,e,o,s,a,h,u,c,l,f,m=(t=n.Matrix.checkMatrix(t)).clone(),g=m.rows,d=m.columns,p=new Array(g),v=1;for(r=0;r<g;r++)p[r]=r;for(l=new Array(g),e=0;e<d;e++){for(r=0;r<g;r++)l[r]=m[r][e];for(r=0;r<g;r++){for(c=m[r],f=Math.min(r,e),a=0,o=0;o<f;o++)a+=c[o]*l[o];c[e]=l[r]-=a}for(s=e,r=e+1;r<g;r++)Math.abs(l[r])>Math.abs(l[s])&&(s=r);if(s!==e){for(o=0;o<d;o++)h=m[s][o],m[s][o]=m[e][o],m[e][o]=h;u=p[s],p[s]=p[e],p[e]=u,v=-v}if(e<g&&0!==m[e][e])for(r=e+1;r<g;r++)m[r][e]/=m[e][e]}this.LU=m,this.pivotVector=p,this.pivotSign=v}i.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,e=0;e<r;e++)if(0===t[e][e])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,n=0;n<e;n++)r*=t[n][n];return r},get lowerTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,i=new n.Matrix(r,e),o=0;o<r;o++)for(var s=0;s<e;s++)i[o][s]=o>s?t[o][s]:o===s?1:0;return i},get upperTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,i=new n.Matrix(r,e),o=0;o<r;o++)for(var s=0;s<e;s++)i[o][s]=o<=s?t[o][s]:0;return i},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=n.Matrix.checkMatrix(t);var r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,i,o,s=t.columns,a=t.subMatrixRow(this.pivotVector,0,s-1),h=r.columns;for(o=0;o<h;o++)for(e=o+1;e<h;e++)for(i=0;i<s;i++)a[e][i]-=a[o][i]*r[e][o];for(o=h-1;o>=0;o--){for(i=0;i<s;i++)a[o][i]/=r[o][o];for(e=0;e<o;e++)for(i=0;i<s;i++)a[e][i]-=a[o][i]*r[e][o]}return a}},t.exports=i},function(t,r,e){"use strict";var n=e(2),i=e(6),o=i.hypotenuse,s=i.getFilled2DArray;function a(t,r){if(!(this instanceof a))return new a(t,r);r=r||{};var e=(t=n.Matrix.checkMatrix(t)).rows,i=t.columns,h=Math.min(e,i),u=!0,c=!0;!1===r.computeLeftSingularVectors&&(u=!1),!1===r.computeRightSingularVectors&&(c=!1);var l,f=!0===r.autoTranspose,m=!1;if(e<i)if(f){e=(l=t.transpose()).rows,i=l.columns,m=!0;var g=u;u=c,c=g}else l=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else l=t.clone();var d,p,v,w,x,y,M,b,A,k,S,E,R,C,O,_,V,j,T,D,I,N=new Array(Math.min(e+1,i)),F=s(e,h,0),z=s(i,i,0),q=new Array(i),P=new Array(e),W=Math.min(e-1,i),L=Math.max(0,Math.min(i-2,e));for(v=0,k=Math.max(W,L);v<k;v++){if(v<W){for(N[v]=0,d=v;d<e;d++)N[v]=o(N[v],l[d][v]);if(0!==N[v]){for(l[v][v]<0&&(N[v]=-N[v]),d=v;d<e;d++)l[d][v]/=N[v];l[v][v]+=1}N[v]=-N[v]}for(p=v+1;p<i;p++){if(v<W&&0!==N[v]){for(x=0,d=v;d<e;d++)x+=l[d][v]*l[d][p];for(x=-x/l[v][v],d=v;d<e;d++)l[d][p]+=x*l[d][v]}q[p]=l[v][p]}if(u&&v<W)for(d=v;d<e;d++)F[d][v]=l[d][v];if(v<L){for(q[v]=0,d=v+1;d<i;d++)q[v]=o(q[v],q[d]);if(0!==q[v]){for(q[v+1]<0&&(q[v]=0-q[v]),d=v+1;d<i;d++)q[d]/=q[v];q[v+1]+=1}if(q[v]=-q[v],v+1<e&&0!==q[v]){for(d=v+1;d<e;d++)P[d]=0;for(p=v+1;p<i;p++)for(d=v+1;d<e;d++)P[d]+=q[p]*l[d][p];for(p=v+1;p<i;p++)for(x=-q[p]/q[v+1],d=v+1;d<e;d++)l[d][p]+=x*P[d]}if(c)for(d=v+1;d<i;d++)z[d][v]=q[d]}}if(w=Math.min(i,e+1),W<i&&(N[W]=l[W][W]),e<w&&(N[w-1]=0),L+1<w&&(q[L]=l[L][w-1]),q[w-1]=0,u){for(p=W;p<h;p++){for(d=0;d<e;d++)F[d][p]=0;F[p][p]=1}for(v=W-1;v>=0;v--)if(0!==N[v]){for(p=v+1;p<h;p++){for(x=0,d=v;d<e;d++)x+=F[d][v]*F[d][p];for(x=-x/F[v][v],d=v;d<e;d++)F[d][p]+=x*F[d][v]}for(d=v;d<e;d++)F[d][v]=-F[d][v];for(F[v][v]=1+F[v][v],d=0;d<v-1;d++)F[d][v]=0}else{for(d=0;d<e;d++)F[d][v]=0;F[v][v]=1}}if(c)for(v=i-1;v>=0;v--){if(v<L&&0!==q[v])for(p=v+1;p<i;p++){for(x=0,d=v+1;d<i;d++)x+=z[d][v]*z[d][p];for(x=-x/z[v+1][v],d=v+1;d<i;d++)z[d][p]+=x*z[d][v]}for(d=0;d<i;d++)z[d][v]=0;z[v][v]=1}for(var U=w-1,X=Math.pow(2,-52);w>0;){for(v=w-2;v>=-1&&-1!==v;v--)if(Math.abs(q[v])<=X*(Math.abs(N[v])+Math.abs(N[v+1]))){q[v]=0;break}if(v===w-2)S=4;else{for(y=w-1;y>=v&&y!==v;y--)if(x=(y!==w?Math.abs(q[y]):0)+(y!==v+1?Math.abs(q[y-1]):0),Math.abs(N[y])<=X*x){N[y]=0;break}y===v?S=3:y===w-1?S=1:(S=2,v=y)}switch(v++,S){case 1:for(M=q[w-2],q[w-2]=0,p=w-2;p>=v;p--)if(x=o(N[p],M),b=N[p]/x,A=M/x,N[p]=x,p!==v&&(M=-A*q[p-1],q[p-1]=b*q[p-1]),c)for(d=0;d<i;d++)x=b*z[d][p]+A*z[d][w-1],z[d][w-1]=-A*z[d][p]+b*z[d][w-1],z[d][p]=x;break;case 2:for(M=q[v-1],q[v-1]=0,p=v;p<w;p++)if(x=o(N[p],M),b=N[p]/x,A=M/x,N[p]=x,M=-A*q[p],q[p]=b*q[p],u)for(d=0;d<e;d++)x=b*F[d][p]+A*F[d][v-1],F[d][v-1]=-A*F[d][p]+b*F[d][v-1],F[d][p]=x;break;case 3:for(E=Math.max(Math.max(Math.max(Math.max(Math.abs(N[w-1]),Math.abs(N[w-2])),Math.abs(q[w-2])),Math.abs(N[v])),Math.abs(q[v])),R=N[w-1]/E,C=N[w-2]/E,O=q[w-2]/E,_=N[v]/E,V=q[v]/E,T=R*O*(R*O),D=0,0===(j=((C+R)*(C-R)+O*O)/2)&&0===T||(D=Math.sqrt(j*j+T),j<0&&(D=-D),D=T/(j+D)),M=(_+R)*(_-R)+D,I=_*V,p=v;p<w-1;p++){if(b=M/(x=o(M,I)),A=I/x,p!==v&&(q[p-1]=x),M=b*N[p]+A*q[p],q[p]=b*q[p]-A*N[p],I=A*N[p+1],N[p+1]=b*N[p+1],c)for(d=0;d<i;d++)x=b*z[d][p]+A*z[d][p+1],z[d][p+1]=-A*z[d][p]+b*z[d][p+1],z[d][p]=x;if(b=M/(x=o(M,I)),A=I/x,N[p]=x,M=b*q[p]+A*N[p+1],N[p+1]=-A*q[p]+b*N[p+1],I=A*q[p+1],q[p+1]=b*q[p+1],u&&p<e-1)for(d=0;d<e;d++)x=b*F[d][p]+A*F[d][p+1],F[d][p+1]=-A*F[d][p]+b*F[d][p+1],F[d][p]=x}q[w-2]=M,1;break;case 4:if(N[v]<=0&&(N[v]=N[v]<0?-N[v]:0,c))for(d=0;d<=U;d++)z[d][v]=-z[d][v];for(;v<U&&!(N[v]>=N[v+1]);){if(x=N[v],N[v]=N[v+1],N[v+1]=x,c&&v<i-1)for(d=0;d<i;d++)x=z[d][v+1],z[d][v+1]=z[d][v],z[d][v]=x;if(u&&v<e-1)for(d=0;d<e;d++)x=F[d][v+1],F[d][v+1]=F[d][v],F[d][v]=x;v++}0,w--}}if(m){var Z=z;z=F,F=Z}this.m=e,this.n=i,this.s=N,this.U=F,this.V=z}a.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,e=0,n=this.s,i=0,o=n.length;i<o;i++)n[i]>r&&e++;return e},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return n.Matrix.isMatrix(this.U)||(this.U=new n.Matrix(this.U)),this.U},get rightSingularVectors(){return n.Matrix.isMatrix(this.V)||(this.V=new n.Matrix(this.V)),this.V},get diagonalMatrix(){return n.Matrix.diag(this.s)},solve:function(t){var r,e=t,i=this.threshold,o=this.s.length,s=n.Matrix.zeros(o,o);for(r=0;r<o;r++)Math.abs(this.s[r])<=i?s[r][r]=0:s[r][r]=1/this.s[r];var a,h,u,c=this.U,l=this.rightSingularVectors,f=l.mmul(s),m=l.rows,g=c.length,d=n.Matrix.zeros(m,g);for(r=0;r<m;r++)for(a=0;a<g;a++){for(u=0,h=0;h<o;h++)u+=f[r][h]*c[a][h];d[r][a]=u}return d.mmul(e)},solveForDiagonal:function(t){return this.solve(n.Matrix.diag(t))},inverse:function(){var t,r,e=this.V,i=this.threshold,o=e.length,s=e[0].length,a=new n.Matrix(o,this.s.length);for(t=0;t<o;t++)for(r=0;r<s;r++)Math.abs(this.s[r])>i?a[t][r]=e[t][r]/this.s[r]:a[t][r]=0;var h,u,c=this.U,l=c.length,f=c[0].length,m=new n.Matrix(o,l);for(t=0;t<o;t++)for(r=0;r<l;r++){for(u=0,h=0;h<f;h++)u+=a[t][h]*c[r][h];m[t][r]=u}return m}},t.exports=a},function(t,r,e){"use strict";r.array=e(14),r.matrix=e(23)},function(t,r,e){"use strict";function n(t,r){return t-r}r.sum=function(t){for(var r=0,e=0;e<t.length;e++)r+=t[e];return r},r.max=function(t){for(var r=t[0],e=t.length,n=1;n<e;n++)t[n]>r&&(r=t[n]);return r},r.min=function(t){for(var r=t[0],e=t.length,n=1;n<e;n++)t[n]<r&&(r=t[n]);return r},r.minMax=function(t){for(var r=t[0],e=t[0],n=t.length,i=1;i<n;i++)t[i]<r&&(r=t[i]),t[i]>e&&(e=t[i]);return{min:r,max:e}},r.arithmeticMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=t[n];return r/e},r.mean=r.arithmeticMean,r.geometricMean=function(t){for(var r=1,e=t.length,n=0;n<e;n++)r*=t[n];return Math.pow(r,1/e)},r.logMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=Math.log(t[n]);return r/e},r.grandMean=function(t,r){for(var e=0,n=0,i=t.length,o=0;o<i;o++)e+=r[o]*t[o],n+=r[o];return e/n},r.truncatedMean=function(t,r,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));for(var i=t.length,o=Math.floor(i*r),s=0,a=o;a<i-o;a++)s+=t[a];return s/(i-2*o)},r.harmonicMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");r+=1/t[n]}return e/r},r.contraHarmonicMean=function(t){for(var r=0,e=0,n=t.length,i=0;i<n;i++)r+=t[i]*t[i],e+=t[i];if(e<0)throw new RangeError("sum of values is negative");return r/e},r.median=function(t,r){void 0===r&&(r=!1),r||(t=[].concat(t).sort(n));var e=t.length,i=Math.floor(e/2);return e%2==0?.5*(t[i-1]+t[i]):t[i]},r.variance=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),i=0,o=t.length,s=0;s<o;s++){var a=t[s]-n;i+=a*a}return e?i/(o-1):i/o},r.standardDeviation=function(t,e){return Math.sqrt(r.variance(t,e))},r.standardError=function(t){return r.standardDeviation(t)/Math.sqrt(t.length)},r.robustMeanAndStdev=function(t){var r=0,e=t.length,i=0;for(i=0;i<e;i++)r+=t[i];r/=e;var o=new Array(e);for(i=0;i<e;i++)o[i]=Math.abs(t[i]-r);return o.sort(n),{mean:r,stdev:e%2==1?o[(e-1)/2]/.6745:.5*(o[e/2]+o[e/2-1])/.6745}},r.quartiles=function(t,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));var i=t.length/4;return{q1:t[Math.ceil(i)-1],q2:r.median(t,!0),q3:t[Math.ceil(3*i)-1]}},r.pooledStandardDeviation=function(t,e){return Math.sqrt(r.pooledVariance(t,e))},r.pooledVariance=function(t,e){void 0===e&&(e=!0);for(var n=0,i=0,o=t.length,s=0;s<o;s++){var a=t[s],h=r.variance(a);n+=(a.length-1)*h,i+=e?a.length-1:a.length}return n/i},r.mode=function(t){var r,e=t.length,n=new Array(e);for(r=0;r<e;r++)n[r]=0;var i=new Array(e),o=0;for(r=0;r<e;r++){var s=i.indexOf(t[r]);s>=0?n[s]++:(i[o]=t[r],n[o]=1,o++)}var a=0,h=0;for(r=0;r<o;r++)n[r]>a&&(a=n[r],h=r);return i[h]},r.covariance=function(t,e,n){void 0===n&&(n=!0);var i=r.mean(t),o=r.mean(e);if(t.length!==e.length)throw"Vectors do not have the same dimensions";for(var s=0,a=t.length,h=0;h<a;h++){s+=(t[h]-i)*(e[h]-o)}return n?s/(a-1):s/a},r.skewness=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),i=0,o=0,s=t.length,a=0;a<s;a++){var h=t[a]-n;i+=h*h,o+=h*h*h}var u=i/s,c=o/s/Math.pow(u,1.5);return e?Math.sqrt(s*(s-1))/(s-2)*c:c},r.kurtosis=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),i=t.length,o=0,s=0,a=0;a<i;a++){var h=t[a]-n;o+=h*h,s+=h*h*h*h}var u=o/i;if(e){var c=o/(i-1);return i*(i+1)/((i-1)*(i-2)*(i-3))*(s/(c*c))-3*((i-1)*(i-1)/((i-2)*(i-3)))}return s/i/(u*u)-3},r.entropy=function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,i=0;i<n;i++)e+=t[i]*Math.log(t[i]+r);return-e},r.weightedMean=function(t,r){for(var e=0,n=t.length,i=0;i<n;i++)e+=t[i]*r[i];return e},r.weightedStandardDeviation=function(t,e){return Math.sqrt(r.weightedVariance(t,e))},r.weightedVariance=function(t,e){for(var n=r.weightedMean(t,e),i=0,o=t.length,s=0,a=0,h=0;h<o;h++){var u=t[h]-n,c=e[h];i+=c*(u*u),a+=c,s+=c*c}return i*(a/(a*a-s))},r.center=function(t,e){void 0===e&&(e=!1);var n=t;e||(n=[].concat(t));for(var i=r.mean(n),o=n.length,s=0;s<o;s++)n[s]-=i},r.standardize=function(t,e,n){void 0===e&&(e=r.standardDeviation(t)),void 0===n&&(n=!1);for(var i=t.length,o=n?t:new Array(i),s=0;s<i;s++)o[s]=t[s]/e;return o},r.cumulativeSum=function(t){var r=t.length,e=new Array(r);e[0]=t[0];for(var n=1;n<r;n++)e[n]=e[n-1]+t[n];return e}},function(t,r,e){"use strict";function n(t,r){for(var e=0,n=0;n<t.length;n++)e+=(t[n]-r[n])*(t[n]-r[n]);return e}function i(t,r){return Math.sqrt(n(t,r))}t.exports=i,i.squared=n},function(t,r,e){"use strict";const n=e(7);function i(t){n.call(this),this.index=t,this.distance=0,this.children=[]}e(40).inherits(i,n),t.exports=i},function(t,r,e){"use strict";const n={threshold:0,out:"assignment"};function i(t){var r=Math.sqrt(2*t.length+.25)-.5,e=[],n=new Array(r),i=r,o=0,s=[];for(o=r-1;o>=0;o--)n[o]=1;for(var a=-1,h=[];i>0;){if(0===h.length){for(s=new Array(r),o=0;o<r;o++)s[o]=0;for(e.push(s),a=0;0==n[a];a++);}else a=h.splice(0,1);s[a]=1,n[a]=0,i--;var u=new Array(r);for(o=0;o<r;o++){var c=Math.max(a,o),l=Math.min(a,o);u[o]=t[l*(2*r-l-1)/2+c],1==u[o]&&1==n[o]&&0==s[o]&&(h.push(o),s[o]=1)}}return e}t.exports=function(t,r){const e=Object.assign({},n,r);var o,s;if("number"==typeof t[0])o=i(t);else if("object"==typeof t[0]){for(var a=t.length,h=new Array(a*(a+1)/2),u=0,c=0;c<a;c++)for(var l=c;l<a;l++)t[c][l]>e.threshold?h[u++]=1:h[u++]=0;o=i(h)}if("indexes"===e.out||"values"===e.out){var f=new Array(o.length);for(c=0;c<o.length;c++)for(f[c]=[],l=0;l<o[c].length;l++)0!=o[c][l]&&f[c].push(l);if("values"===e.out){var m=new Array(f.length);for(c=0;c<f.length;c++)for(m[c]=new Array(f[c].length),l=0;l<f[c].length;l++)for(m[c][l]=new Array(f[c].length),s=0;s<f[c].length;s++)m[c][l][s]=t[f[c][l]][f[c][s]];return m}return f}return o}},function(t,r,e){"use strict";r.agnes=e(37),r.diana=e(45)},function(t,r,e){"use strict";t.exports=e(49)},function(t,r,e){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,r,e){t.exports=r=e(22),r.getEquallySpacedData=e(24).getEquallySpacedData,r.SNV=e(25).SNV},function(t,r,e){"use strict";const n=e(13).array;function i(t){for(var r=new Array(t[0].length),e=0;e<r.length;++e)r[e]=new Array(t.length);for(e=0;e<t.length;++e)for(var n=0;n<t[0].length;++n)r[n][e]=t[e][n];return r}t.exports={coordArrayToPoints:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=t.length/r,n=new Array(e),i=0,o=0;o<t.length;o+=r){for(var s=new Array(r),a=0;a<r;++a)s[a]=t[o+a];n[i]=s,i++}return n},coordArrayToCoordMatrix:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=new Array(r),n=t.length/r,i=0;i<e.length;i++)e[i]=new Array(n);for(i=0;i<t.length;i+=r)for(var o=0;o<r;++o){var s=Math.floor(i/r);e[o][s]=t[i+o]}return e},coordMatrixToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t[0].length;++n)for(var i=0;i<t.length;++i)r[e]=t[i][n],++e;return r},coordMatrixToPoints:i,pointsToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t.length;++n)for(var i=0;i<t[0].length;++i)r[e]=t[n][i],++e;return r},pointsToCoordMatrix:i,applyDotProduct:function(t,r){var e,n;t.length<=r.length?(n=t,e=r):(n=r,e=t);for(var i=e.length-n.length+1,o=new Array(i),s=0;s<i;++s){for(var a=0,h=0;h<n.length;++h)a+=n[h]*e[s+h];o[s]=a}return o},scale:function(t,r){var e;e=r.inPlace?t:new Array(t.length);const i=r.max,o=r.min;if("number"==typeof i)if("number"==typeof o)for(var s=n.minMax(t),a=(i-o)/(s.max-s.min),h=0;h<e.length;h++)e[h]=(t[h]-s.min)*a+o;else for(a=i/n.max(t),h=0;h<e.length;h++)e[h]=t[h]*a;else if("number"==typeof o)for(a=o/n.min(t),h=0;h<e.length;h++)e[h]=t[h]*a;return e}}},function(t,r,e){"use strict";var n=e(14);function i(t,r){return t-r}r.max=function(t){for(var r=-1/0,e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n]>r&&(r=t[e][n]);return r},r.min=function(t){for(var r=1/0,e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n]<r&&(r=t[e][n]);return r},r.minMax=function(t){for(var r=1/0,e=-1/0,n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)t[n][i]<r&&(r=t[n][i]),t[n][i]>e&&(e=t[n][i]);return{min:r,max:e}},r.entropy=function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,i=t[0].length,o=0;o<n;o++)for(var s=0;s<i;s++)e+=t[o][s]*Math.log(t[o][s]+r);return-e},r.mean=function(t,r){void 0===r&&(r=0);var e,n,i,o,s=t.length,a=t[0].length;if(-1===r){for(e=[0],n=s*a,i=0;i<s;i++)for(o=0;o<a;o++)e[0]+=t[i][o];e[0]/=n}else if(0===r)for(e=new Array(a),n=s,o=0;o<a;o++){for(e[o]=0,i=0;i<s;i++)e[o]+=t[i][o];e[o]/=n}else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(s),n=a,o=0;o<s;o++){for(e[o]=0,i=0;i<a;i++)e[o]+=t[o][i];e[o]/=n}}return e},r.sum=function(t,r){void 0===r&&(r=0);var e,n,i,o=t.length,s=t[0].length;if(-1===r)for(e=[0],n=0;n<o;n++)for(i=0;i<s;i++)e[0]+=t[n][i];else if(0===r)for(e=new Array(s),i=0;i<s;i++)for(e[i]=0,n=0;n<o;n++)e[i]+=t[n][i];else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(o),i=0;i<o;i++)for(e[i]=0,n=0;n<s;n++)e[i]+=t[i][n]}return e},r.product=function(t,r){void 0===r&&(r=0);var e,n,i,o=t.length,s=t[0].length;if(-1===r)for(e=[1],n=0;n<o;n++)for(i=0;i<s;i++)e[0]*=t[n][i];else if(0===r)for(e=new Array(s),i=0;i<s;i++)for(e[i]=1,n=0;n<o;n++)e[i]*=t[n][i];else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(o),i=0;i<o;i++)for(e[i]=1,n=0;n<s;n++)e[i]*=t[i][n]}return e},r.standardDeviation=function(t,e,n){for(var i=r.variance(t,e,n),o=i.length,s=0;s<o;s++)i[s]=Math.sqrt(i[s]);return i},r.variance=function(t,e,n){void 0===n&&(n=!0),e=e||r.mean(t);var i=t.length;if(0===i)return[];for(var o=t[0].length,s=new Array(o),a=0;a<o;a++){for(var h=0,u=0,c=0,l=0;l<i;l++)h+=c=t[l][a]-e[a],u+=c*c;s[a]=n?(u-h*h/i)/(i-1):(u-h*h/i)/i}return s},r.median=function(t){for(var r=t.length,e=t[0].length,n=new Array(e),o=0;o<e;o++){for(var s=new Array(r),a=0;a<r;a++)s[a]=t[a][o];s.sort(i);var h=s.length;n[o]=h%2==0?.5*(s[h/2]+s[h/2-1]):s[Math.floor(h/2)]}return n},r.mode=function(t){var r,e,n=t.length,i=t[0].length,o=new Array(i);for(r=0;r<i;r++){for(var s=new Array(n),a=0;a<n;a++)s[a]=0;var h=new Array(n),u=0;for(e=0;e<n;e++){var c=h.indexOf(t[e][r]);c>=0?s[c]++:(h[u]=t[e][r],s[u]=1,u++)}var l=0,f=0;for(e=0;e<u;e++)s[e]>l&&(l=s[e],f=e);o[r]=h[f]}return o},r.skewness=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),i=t.length,o=n.length,s=new Array(o),a=0;a<o;a++){for(var h=0,u=0,c=0;c<i;c++){var l=t[c][a]-n[a];h+=l*l,u+=l*l*l}var f=h/i,m=u/i/Math.pow(f,1.5);if(e){var g=Math.sqrt(i*(i-1)),d=i-2;s[a]=g/d*m}else s[a]=m}return s},r.kurtosis=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),i=t.length,o=t[0].length,s=new Array(o),a=0;a<o;a++){for(var h=0,u=0,c=0;c<i;c++){var l=t[c][a]-n[a];h+=l*l,u+=l*l*l*l}var f=h/i,m=u/i;if(e){var g=h/(i-1),d=i*(i+1)/((i-1)*(i-2)*(i-3)),p=u/(g*g),v=(i-1)*(i-1)/((i-2)*(i-3));s[a]=d*p-3*v}else s[a]=m/(f*f)-3}return s},r.standardError=function(t){for(var e=t.length,n=r.standardDeviation(t),i=n.length,o=new Array(i),s=Math.sqrt(e),a=0;a<i;a++)o[a]=n[a]/s;return o},r.covariance=function(t,e){return r.scatter(t,void 0,e)},r.scatter=function(t,e,n){void 0===n&&(n=0),void 0===e&&(0===n?e=t.length-1:1===n&&(e=t[0].length-1));var i=r.mean(t,n),o=t.length;if(0===o)return[[]];var s,a,h,u,c,l=t[0].length;if(0===n){for(s=new Array(l),a=0;a<l;a++)s[a]=new Array(l);for(a=0;a<l;a++)for(h=a;h<l;h++){for(u=0,c=0;c<o;c++)u+=(t[c][h]-i[h])*(t[c][a]-i[a]);u/=e,s[a][h]=u,s[h][a]=u}}else{if(1!==n)throw new Error("Invalid dimension");for(s=new Array(o),a=0;a<o;a++)s[a]=new Array(o);for(a=0;a<o;a++)for(h=a;h<o;h++){for(u=0,c=0;c<l;c++)u+=(t[h][c]-i[h])*(t[a][c]-i[a]);u/=e,s[a][h]=u,s[h][a]=u}}return s},r.correlation=function(t){var e,n,i=r.mean(t),o=r.standardDeviation(t,!0,i),s=r.zScores(t,i,o),a=t.length,h=t[0].length,u=new Array(h);for(e=0;e<h;e++)u[e]=new Array(h);for(e=0;e<h;e++)for(n=e;n<h;n++){for(var c=0,l=0,f=s.length;l<f;l++)c+=s[l][n]*s[l][e];c/=a-1,u[e][n]=c,u[n][e]=c}return u},r.zScores=function(t,e,n){return e=e||r.mean(t),void 0===n&&(n=r.standardDeviation(t,!0,e)),r.standardize(r.center(t,e,!1),n,!0)},r.center=function(t,e,n){e=e||r.mean(t);var i,o,s,a=t,h=t.length;if(!n)for(a=new Array(h),i=0;i<h;i++)a[i]=new Array(t[i].length);for(i=0;i<h;i++){var u=a[i];for(o=0,s=u.length;o<s;o++)u[o]=t[i][o]-e[o]}return a},r.standardize=function(t,e,n){void 0===e&&(e=r.standardDeviation(t));var i,o,s,a=t,h=t.length;if(!n)for(a=new Array(h),i=0;i<h;i++)a[i]=new Array(t[i].length);for(i=0;i<h;i++){var u=a[i],c=t[i];for(o=0,s=u.length;o<s;o++)0===e[o]||isNaN(e[o])||(u[o]=c[o]/e[o])}return a},r.weightedVariance=function(t,e){var n=r.mean(t),i=t.length;if(0===i)return[];for(var o=t[0].length,s=new Array(o),a=0;a<o;a++){for(var h=0,u=0,c=0,l=0;l<i;l++){var f=t[l][a]-n[a],m=e[l];h+=m*(f*f),c+=m,u+=m*m}s[a]=h*(c/(c*c-u))}return s},r.weightedMean=function(t,r,e){void 0===e&&(e=0);var i=t.length;if(0===i)return[];var o,s,a,h,u,c,l=t[0].length;if(0===e){for(o=new Array(l),s=0;s<l;s++)o[s]=0;for(s=0;s<i;s++)for(c=t[s],u=r[s],h=0;h<l;h++)o[h]+=c[h]*u}else{if(1!==e)throw new Error("Invalid dimension");for(o=new Array(i),s=0;s<i;s++)o[s]=0;for(h=0;h<i;h++)for(c=t[h],u=r[h],s=0;s<l;s++)o[h]+=c[s]*u}var f=n.sum(r);if(0!==f)for(s=0,a=o.length;s<a;s++)o[s]/=f;return o},r.weightedCovariance=function(t,e,n,i){i=i||0,n=n||r.weightedMean(t,e,i);for(var o=0,s=0,a=0,h=e.length;a<h;a++)o+=e[a],s+=e[a]*e[a];var u=o/(o*o-s);return r.weightedScatter(t,e,n,u,i)},r.weightedScatter=function(t,e,n,i,o){o=o||0,n=n||r.weightedMean(t,e,o),void 0===i&&(i=1);var s=t.length;if(0===s)return[[]];var a,h,u,c,l,f=t[0].length;if(0===o){for(a=new Array(f),h=0;h<f;h++)a[h]=new Array(f);for(h=0;h<f;h++)for(u=h;u<f;u++){for(l=0,c=0;c<s;c++)l+=e[c]*(t[c][u]-n[u])*(t[c][h]-n[h]);a[h][u]=l*i,a[u][h]=l*i}}else{if(1!==o)throw new Error("Invalid dimension");for(a=new Array(s),h=0;h<s;h++)a[h]=new Array(s);for(h=0;h<s;h++)for(u=h;u<s;u++){for(l=0,c=0;c<f;c++)l+=e[c]*(t[u][c]-n[u])*(t[h][c]-n[h]);a[h][u]=l*i,a[u][h]=l*i}}return a}},function(t,r,e){"use strict";function n(t,r,e,n){return.5*e*r*r+n*r-(.5*e*t*t+n*t)}r.getEquallySpacedData=function(t,r,e){if(t.length>1&&t[0]>t[1]&&(t=t.slice().reverse(),r=r.slice().reverse()),t.length!==r.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===e&&(e={});var i=void 0===e.from?t[0]:e.from;if(isNaN(i)||!isFinite(i))throw new RangeError("'From' value must be a number");var o=void 0===e.to?t[t.length-1]:e.to;if(isNaN(o)||!isFinite(o))throw new RangeError("'To' value must be a number");var s=i>o;if(s){var a=i;i=o,o=a}var h=void 0===e.numberOfPoints?100:e.numberOfPoints;if(isNaN(h)||!isFinite(h))throw new RangeError("'Number of points' value must be a number");if(h<1)throw new RangeError("the number of point must be higher than 1");var u="slot"==("slot"===e.variant?"slot":"smooth")?function(t,r,e,n,i){var o=t.length,s=(n-e)/(i-1),a=s/2,h=t[t.length-1]-t[t.length-2],u=e-a,c=new Array(i),l=u,f=u+s,m=-Number.MAX_VALUE,g=0,d=t[0],p=r[0],v=0,w=!0,x=0,y=0,M=1,b=0;t:for(;;){if(m>=d)throw new Error("x must be an increasing serie");for(;m-f>0;){if(w&&(y++,w=!1),c[b]=y<=0?0:x/y,++b===i)break t;l=f,f+=s,x=0,y=0}m>l&&(x+=g,y++),(m===-Number.MAX_VALUE||v>1)&&y--,m=d,g=p,M<o?(d=t[M],p=r[M],M++):(d+=h,p=0,v++)}return c}(t,r,i,o,h):function(t,r,e,i,o){var s=t.length,a=(i-e)/(o-1),h=e-a/2,u=new Array(o),c=t[1]-t[0],l=t[t.length-1]-t[t.length-2],f=h,m=h+a,g=Number.MIN_VALUE,d=0,p=t[0]-c,v=0,w=0,x=0,y=0,M=0,b=0,A=0,k=0;t:for(;;){for(;p-m>=0;){var S=n(0,m-g,x,d);if(b=w+S,u[k]=(b-M)/a,++k===o)break t;f=m,m+=a,M=b}g<=f&&f<=p&&(S=n(0,f-g,x,d),M=w+S),w+=n(g,p,x,y),g=p,d=v,A<s?(p=t[A],v=r[A],A++):A===s&&(p+=l,v=0),y=-(x=(v-d)/(p-g))*g+d}return u}(t,r,i,o,h);return s?u.reverse():u},r.integral=n},function(t,r,e){"use strict";r.SNV=function(t){for(var r=n.mean(t),e=n.standardDeviation(t),i=t.slice(),o=0;o<t.length;o++)i[o]=(i[o]-r)/e;return i};var n=e(13).array},function(t,r,e){"use strict";var n=e(3);t.exports=class extends n{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}}},function(t,r,e){"use strict";var n=e(3);t.exports=class extends n{constructor(t,r){super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}}},function(t,r,e){"use strict";var n=e(3),i=e(4);t.exports=class extends n{constructor(t,r,e,n,o){i.checkRange(t,r,e,n,o),super(t,e-r+1,o-n+1),this.startRow=r,this.startColumn=n}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}}},function(t,r,e){"use strict";var n=e(3),i=e(4);t.exports=class extends n{constructor(t,r,e){var n=i.checkIndices(t,r,e);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}},function(t,r,e){"use strict";var n=e(3);t.exports=class extends n{constructor(t,r){super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}}},function(t,r,e){"use strict";var n=e(3);t.exports=class extends n{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}}},function(t,r,e){"use strict";var n=e(3);t.exports=class extends n{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}}},function(t,r,e){"use strict";var n=e(2).Matrix,i=e(12),o=e(34),s=e(11),a=e(35),h=e(36);function u(t){return c(t=n.checkMatrix(t),n.eye(t.rows))}function c(t,r){return t=n.checkMatrix(t),r=n.checkMatrix(r),t.isSquare()?new s(t).solve(r):new a(t).solve(r)}n.inverse=n.inv=u,n.prototype.inverse=n.prototype.inv=function(){return u(this)},n.solve=c,n.prototype.solve=function(t){return c(this,t)},t.exports={SingularValueDecomposition:i,SVD:i,EigenvalueDecomposition:o,EVD:o,LuDecomposition:s,LU:s,QrDecomposition:a,QR:a,CholeskyDecomposition:h,CHO:h,inverse:u,solve:c}},function(t,r,e){"use strict";const n=e(2).Matrix,i=e(6),o=i.hypotenuse,s=i.getFilled2DArray,a={assumeSymmetric:!1};function h(t,r){if(r=Object.assign({},a,r),!(this instanceof h))return new h(t,r);if(!(t=n.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var e,i,c=t.columns,l=s(c,c,0),f=new Array(c),m=new Array(c),g=t;if(!!r.assumeSymmetric||t.isSymmetric()){for(e=0;e<c;e++)for(i=0;i<c;i++)l[e][i]=g.get(e,i);!function(t,r,e,n){var i,o,s,a,h,u,c,l;for(h=0;h<t;h++)e[h]=n[t-1][h];for(a=t-1;a>0;a--){for(l=0,s=0,u=0;u<a;u++)l+=Math.abs(e[u]);if(0===l)for(r[a]=e[a-1],h=0;h<a;h++)e[h]=n[a-1][h],n[a][h]=0,n[h][a]=0;else{for(u=0;u<a;u++)e[u]/=l,s+=e[u]*e[u];for(i=e[a-1],o=Math.sqrt(s),i>0&&(o=-o),r[a]=l*o,s-=i*o,e[a-1]=i-o,h=0;h<a;h++)r[h]=0;for(h=0;h<a;h++){for(i=e[h],n[h][a]=i,o=r[h]+n[h][h]*i,u=h+1;u<=a-1;u++)o+=n[u][h]*e[u],r[u]+=n[u][h]*i;r[h]=o}for(i=0,h=0;h<a;h++)r[h]/=s,i+=r[h]*e[h];for(c=i/(s+s),h=0;h<a;h++)r[h]-=c*e[h];for(h=0;h<a;h++){for(i=e[h],o=r[h],u=h;u<=a-1;u++)n[u][h]-=i*r[u]+o*e[u];e[h]=n[a-1][h],n[a][h]=0}}e[a]=s}for(a=0;a<t-1;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,0!==(s=e[a+1])){for(u=0;u<=a;u++)e[u]=n[u][a+1]/s;for(h=0;h<=a;h++){for(o=0,u=0;u<=a;u++)o+=n[u][a+1]*n[u][h];for(u=0;u<=a;u++)n[u][h]-=o*e[u]}}for(u=0;u<=a;u++)n[u][a+1]=0}for(h=0;h<t;h++)e[h]=n[t-1][h],n[t-1][h]=0;n[t-1][t-1]=1,r[0]=0}(c,m,f,l),function(t,r,e,n){var i,s,a,h,u,c,l,f,m,g,d,p,v,w,x,y;for(a=1;a<t;a++)r[a-1]=r[a];r[t-1]=0;var M=0,b=0,A=Math.pow(2,-52);for(c=0;c<t;c++){for(b=Math.max(b,Math.abs(e[c])+Math.abs(r[c])),l=c;l<t&&!(Math.abs(r[l])<=A*b);)l++;if(l>c){0;do{for(1,i=e[c],f=(e[c+1]-i)/(2*r[c]),m=o(f,1),f<0&&(m=-m),e[c]=r[c]/(f+m),e[c+1]=r[c]*(f+m),g=e[c+1],s=i-e[c],a=c+2;a<t;a++)e[a]-=s;for(M+=s,f=e[l],p=d=1,v=d,w=r[c+1],x=0,y=0,a=l-1;a>=c;a--)for(v=p,p=d,y=x,i=d*r[a],s=d*f,m=o(f,r[a]),r[a+1]=x*m,x=r[a]/m,f=(d=f/m)*e[a]-x*i,e[a+1]=s+x*(d*i+x*e[a]),u=0;u<t;u++)s=n[u][a+1],n[u][a+1]=x*n[u][a]+d*s,n[u][a]=d*n[u][a]-x*s;f=-x*y*v*w*r[c]/g,r[c]=x*f,e[c]=d*f}while(Math.abs(r[c])>A*b)}e[c]=e[c]+M,r[c]=0}for(a=0;a<t-1;a++){for(u=a,f=e[a],h=a+1;h<t;h++)e[h]<f&&(u=h,f=e[h]);if(u!==a)for(e[u]=e[a],e[a]=f,h=0;h<t;h++)f=n[h][a],n[h][a]=n[h][u],n[h][u]=f}}(c,m,f,l)}else{var d=s(c,c,0),p=new Array(c);for(i=0;i<c;i++)for(e=0;e<c;e++)d[e][i]=g.get(e,i);!function(t,r,e,n){var i,o,s,a,h,u,c,l=t-1;for(u=1;u<=l-1;u++){for(c=0,a=u;a<=l;a++)c+=Math.abs(r[a][u-1]);if(0!==c){for(s=0,a=l;a>=u;a--)e[a]=r[a][u-1]/c,s+=e[a]*e[a];for(o=Math.sqrt(s),e[u]>0&&(o=-o),s-=e[u]*o,e[u]=e[u]-o,h=u;h<t;h++){for(i=0,a=l;a>=u;a--)i+=e[a]*r[a][h];for(i/=s,a=u;a<=l;a++)r[a][h]-=i*e[a]}for(a=0;a<=l;a++){for(i=0,h=l;h>=u;h--)i+=e[h]*r[a][h];for(i/=s,h=u;h<=l;h++)r[a][h]-=i*e[h]}e[u]=c*e[u],r[u][u-1]=c*o}}for(a=0;a<t;a++)for(h=0;h<t;h++)n[a][h]=a===h?1:0;for(u=l-1;u>=1;u--)if(0!==r[u][u-1]){for(a=u+1;a<=l;a++)e[a]=r[a][u-1];for(h=u;h<=l;h++){for(o=0,a=u;a<=l;a++)o+=e[a]*n[a][h];for(o=o/e[u]/r[u][u-1],a=u;a<=l;a++)n[a][h]+=o*e[a]}}}(c,d,p,l),function(t,r,e,n,i){var o,s,a,h,c,l,f,m,g,d,p,v,w,x,y,M=t-1,b=t-1,A=Math.pow(2,-52),k=0,S=0,E=0,R=0,C=0,O=0,_=0,V=0;for(o=0;o<t;o++)for((o<0||o>b)&&(e[o]=i[o][o],r[o]=0),s=Math.max(o-1,0);s<t;s++)S+=Math.abs(i[o][s]);for(;M>=0;){for(h=M;h>0&&(0===(O=Math.abs(i[h-1][h-1])+Math.abs(i[h][h]))&&(O=S),!(Math.abs(i[h][h-1])<A*O));)h--;if(h===M)i[M][M]=i[M][M]+k,e[M]=i[M][M],r[M]=0,M--,V=0;else if(h===M-1){if(f=i[M][M-1]*i[M-1][M],E=(i[M-1][M-1]-i[M][M])/2,R=E*E+f,_=Math.sqrt(Math.abs(R)),i[M][M]=i[M][M]+k,i[M-1][M-1]=i[M-1][M-1]+k,m=i[M][M],R>=0){for(_=E>=0?E+_:E-_,e[M-1]=m+_,e[M]=e[M-1],0!==_&&(e[M]=m-f/_),r[M-1]=0,r[M]=0,m=i[M][M-1],O=Math.abs(m)+Math.abs(_),E=m/O,R=_/O,C=Math.sqrt(E*E+R*R),E/=C,R/=C,s=M-1;s<t;s++)_=i[M-1][s],i[M-1][s]=R*_+E*i[M][s],i[M][s]=R*i[M][s]-E*_;for(o=0;o<=M;o++)_=i[o][M-1],i[o][M-1]=R*_+E*i[o][M],i[o][M]=R*i[o][M]-E*_;for(o=0;o<=b;o++)_=n[o][M-1],n[o][M-1]=R*_+E*n[o][M],n[o][M]=R*n[o][M]-E*_}else e[M-1]=m+E,e[M]=m+E,r[M-1]=_,r[M]=-_;M-=2,V=0}else{if(m=i[M][M],g=0,f=0,h<M&&(g=i[M-1][M-1],f=i[M][M-1]*i[M-1][M]),10===V){for(k+=m,o=0;o<=M;o++)i[o][o]-=m;O=Math.abs(i[M][M-1])+Math.abs(i[M-1][M-2]),m=g=.75*O,f=-.4375*O*O}if(30===V&&(O=(O=(g-m)/2)*O+f)>0){for(O=Math.sqrt(O),g<m&&(O=-O),O=m-f/((g-m)/2+O),o=0;o<=M;o++)i[o][o]-=O;k+=O,m=g=f=.964}for(V+=1,c=M-2;c>=h&&(_=i[c][c],E=((C=m-_)*(O=g-_)-f)/i[c+1][c]+i[c][c+1],R=i[c+1][c+1]-_-C-O,C=i[c+2][c+1],O=Math.abs(E)+Math.abs(R)+Math.abs(C),E/=O,R/=O,C/=O,c!==h)&&!(Math.abs(i[c][c-1])*(Math.abs(R)+Math.abs(C))<A*(Math.abs(E)*(Math.abs(i[c-1][c-1])+Math.abs(_)+Math.abs(i[c+1][c+1]))));)c--;for(o=c+2;o<=M;o++)i[o][o-2]=0,o>c+2&&(i[o][o-3]=0);for(a=c;a<=M-1&&(x=a!==M-1,a!==c&&(E=i[a][a-1],R=i[a+1][a-1],C=x?i[a+2][a-1]:0,0!==(m=Math.abs(E)+Math.abs(R)+Math.abs(C))&&(E/=m,R/=m,C/=m)),0!==m);a++)if(O=Math.sqrt(E*E+R*R+C*C),E<0&&(O=-O),0!==O){for(a!==c?i[a][a-1]=-O*m:h!==c&&(i[a][a-1]=-i[a][a-1]),m=(E+=O)/O,g=R/O,_=C/O,R/=E,C/=E,s=a;s<t;s++)E=i[a][s]+R*i[a+1][s],x&&(E+=C*i[a+2][s],i[a+2][s]=i[a+2][s]-E*_),i[a][s]=i[a][s]-E*m,i[a+1][s]=i[a+1][s]-E*g;for(o=0;o<=Math.min(M,a+3);o++)E=m*i[o][a]+g*i[o][a+1],x&&(E+=_*i[o][a+2],i[o][a+2]=i[o][a+2]-E*C),i[o][a]=i[o][a]-E,i[o][a+1]=i[o][a+1]-E*R;for(o=0;o<=b;o++)E=m*n[o][a]+g*n[o][a+1],x&&(E+=_*n[o][a+2],n[o][a+2]=n[o][a+2]-E*C),n[o][a]=n[o][a]-E,n[o][a+1]=n[o][a+1]-E*R}}}if(0===S)return;for(M=t-1;M>=0;M--)if(E=e[M],0===(R=r[M]))for(h=M,i[M][M]=1,o=M-1;o>=0;o--){for(f=i[o][o]-E,C=0,s=h;s<=M;s++)C+=i[o][s]*i[s][M];if(r[o]<0)_=f,O=C;else if(h=o,0===r[o]?i[o][M]=0!==f?-C/f:-C/(A*S):(m=i[o][o+1],g=i[o+1][o],R=(e[o]-E)*(e[o]-E)+r[o]*r[o],l=(m*O-_*C)/R,i[o][M]=l,i[o+1][M]=Math.abs(m)>Math.abs(_)?(-C-f*l)/m:(-O-g*l)/_),l=Math.abs(i[o][M]),A*l*l>1)for(s=o;s<=M;s++)i[s][M]=i[s][M]/l}else if(R<0)for(h=M-1,Math.abs(i[M][M-1])>Math.abs(i[M-1][M])?(i[M-1][M-1]=R/i[M][M-1],i[M-1][M]=-(i[M][M]-E)/i[M][M-1]):(y=u(0,-i[M-1][M],i[M-1][M-1]-E,R),i[M-1][M-1]=y[0],i[M-1][M]=y[1]),i[M][M-1]=0,i[M][M]=1,o=M-2;o>=0;o--){for(d=0,p=0,s=h;s<=M;s++)d+=i[o][s]*i[s][M-1],p+=i[o][s]*i[s][M];if(f=i[o][o]-E,r[o]<0)_=f,C=d,O=p;else if(h=o,0===r[o]?(y=u(-d,-p,f,R),i[o][M-1]=y[0],i[o][M]=y[1]):(m=i[o][o+1],g=i[o+1][o],v=(e[o]-E)*(e[o]-E)+r[o]*r[o]-R*R,w=2*(e[o]-E)*R,0===v&&0===w&&(v=A*S*(Math.abs(f)+Math.abs(R)+Math.abs(m)+Math.abs(g)+Math.abs(_))),y=u(m*C-_*d+R*p,m*O-_*p-R*d,v,w),i[o][M-1]=y[0],i[o][M]=y[1],Math.abs(m)>Math.abs(_)+Math.abs(R)?(i[o+1][M-1]=(-d-f*i[o][M-1]+R*i[o][M])/m,i[o+1][M]=(-p-f*i[o][M]-R*i[o][M-1])/m):(y=u(-C-g*i[o][M-1],-O-g*i[o][M],_,R),i[o+1][M-1]=y[0],i[o+1][M]=y[1])),l=Math.max(Math.abs(i[o][M-1]),Math.abs(i[o][M])),A*l*l>1)for(s=o;s<=M;s++)i[s][M-1]=i[s][M-1]/l,i[s][M]=i[s][M]/l}for(o=0;o<t;o++)if(o<0||o>b)for(s=o;s<t;s++)n[o][s]=i[o][s];for(s=t-1;s>=0;s--)for(o=0;o<=b;o++){for(_=0,a=0;a<=Math.min(s,b);a++)_+=n[o][a]*i[a][s];n[o][s]=_}}(c,m,f,l,d)}this.n=c,this.e=m,this.d=f,this.V=l}function u(t,r,e,n){var i,o;return Math.abs(e)>Math.abs(n)?[(t+(i=n/e)*r)/(o=e+i*n),(r-i*t)/o]:[((i=e/n)*t+r)/(o=n+i*e),(i*r-t)/o]}h.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return n.isMatrix(this.V)||(this.V=new n(this.V)),this.V},get diagonalMatrix(){var t,r,e=this.n,i=this.e,o=this.d,s=new n(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)s[t][r]=0;s[t][t]=o[t],i[t]>0?s[t][t+1]=i[t]:i[t]<0&&(s[t][t-1]=i[t])}return s}},t.exports=h},function(t,r,e){"use strict";var n=e(2).Matrix,i=e(6).hypotenuse;function o(t){if(!(this instanceof o))return new o(t);var r,e,s,a,h=(t=n.checkMatrix(t)).clone(),u=t.rows,c=t.columns,l=new Array(c);for(s=0;s<c;s++){var f=0;for(r=s;r<u;r++)f=i(f,h[r][s]);if(0!==f){for(h[s][s]<0&&(f=-f),r=s;r<u;r++)h[r][s]/=f;for(h[s][s]+=1,e=s+1;e<c;e++){for(a=0,r=s;r<u;r++)a+=h[r][s]*h[r][e];for(a=-a/h[s][s],r=s;r<u;r++)h[r][e]+=a*h[r][s]}}l[s]=-f}this.QR=h,this.Rdiag=l}o.prototype={solve:function(t){t=n.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var i,o,s,a,h=t.columns,u=t.clone(),c=r.columns;for(s=0;s<c;s++)for(o=0;o<h;o++){for(a=0,i=s;i<e;i++)a+=r[i][s]*u[i][o];for(a=-a/r[s][s],i=s;i<e;i++)u[i][o]+=a*r[i][s]}for(s=c-1;s>=0;s--){for(o=0;o<h;o++)u[s][o]/=this.Rdiag[s];for(i=0;i<s;i++)for(o=0;o<h;o++)u[i][o]-=u[s][o]*r[i][s]}return u.subMatrix(0,c-1,0,h-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;r<t;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularMatrix(){var t,r,e=this.QR,i=e.columns,o=new n(i,i);for(t=0;t<i;t++)for(r=0;r<i;r++)o[t][r]=t<r?e[t][r]:t===r?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,r,e,i,o=this.QR,s=o.rows,a=o.columns,h=new n(s,a);for(e=a-1;e>=0;e--){for(t=0;t<s;t++)h[t][e]=0;for(h[e][e]=1,r=e;r<a;r++)if(0!==o[e][e]){for(i=0,t=e;t<s;t++)i+=o[t][e]*h[t][r];for(i=-i/o[e][e],t=e;t<s;t++)h[t][r]+=i*o[t][e]}}return h}},t.exports=o},function(t,r,e){"use strict";var n=e(2).Matrix;function i(t){if(!(this instanceof i))return new i(t);if(!(t=n.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var r,e,o,s=t,a=s.rows,h=new n(a,a),u=!0;for(e=0;e<a;e++){var c=h[e],l=0;for(o=0;o<e;o++){var f=h[o],m=0;for(r=0;r<o;r++)m+=f[r]*c[r];c[o]=m=(s[e][o]-m)/h[o][o],l+=m*m}for(u&=(l=s[e][e]-l)>0,h[e][e]=Math.sqrt(Math.max(l,0)),o=e+1;o<a;o++)h[e][o]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=h}i.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=n.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var i,o,s,a=t.columns,h=t.clone();for(s=0;s<e;s++)for(o=0;o<a;o++){for(i=0;i<s;i++)h[s][o]-=h[i][o]*r[s][i];h[s][o]/=r[s][s]}for(s=e-1;s>=0;s--)for(o=0;o<a;o++){for(i=s+1;i<e;i++)h[s][o]-=h[i][o]*r[i][s];h[s][o]/=r[s][s]}return h}},t.exports=i},function(t,r,e){"use strict";const n=e(15),i=e(16),o=e(7),s=e(44);function a(t,r,e){for(var n=1e101,i=0;i<t.length;i++)for(var o=0;o<r.length;o++){var s=e[t[i]][r[o]];n=Math.min(s,n)}return n}function h(t,r,e){for(var n=-1,i=0;i<t.length;i++)for(var o=0;o<r.length;o++){var s=e[t[i]][r[o]];n=Math.max(s,n)}return n}function u(t,r,e){for(var n=0,i=0;i<t.length;i++)for(var o=0;o<r.length;o++)n+=e[t[i]][r[o]];return n/(t.length*r.length)}function c(t,r,e){for(var n=new Array(t.length*r.length),i=0;i<t.length;i++)for(var o=0;o<r.length;o++)n[i*r.length+o]=e[t[i]][r[o]];return function(t,r){void 0===r&&(r=!1);r||(t=[].concat(t).sort(f));var e=t.length,n=Math.floor(e/2);return e%2==0?.5*(t[n-1]+t[n]):t[n]}(n)}function l(t,r,e){return c(t,r,e)*t.length*r.length/(t.length+r.length)}function f(t,r){return t-r}var m={disFunc:n,kind:"single",isDistanceMatrix:!1};t.exports=function(t,r){r=Object.assign({},m,r);var e=t.length,n=t;if(r.isDistanceMatrix||(n=s(t,r.disFunc)),"string"==typeof r.kind)switch(r.kind){case"single":r.kind=a;break;case"complete":r.kind=h;break;case"average":r.kind=u;break;case"centroid":r.kind=c;break;case"ward":r.kind=l;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof r.kind)throw new TypeError("Undefined kind of similarity");for(var f=new Array(e),g=0;g<n.length;g++)f[g]=new i(g);for(var d=1e6,p={},v=0;f.length>1;){p={},d=1e6;for(var w=0;w<f.length;w++)for(var x=w+1;x<f.length;x++){var y,M;if(f[w]instanceof i)y=[f[w].index];else{y=new Array(f[w].index.length);for(var b=0;b<y.length;b++)y[b]=f[w].index[b].index}if(f[x]instanceof i)M=[f[x].index];else{M=new Array(f[x].index.length);for(var A=0;A<M.length;A++)M[A]=f[x].index[A].index}(v=r.kind(y,M,n).toFixed(4))in p?p[v].push([f[w],f[x]]):p[v]=[[f[w],f[x]]],d=Math.min(v,d)}for(var k,S=p[d.toFixed(4)],E=new Array(S.length),R=0;S.length>0;){k=S.shift();for(var C=0;C<S.length;C++)if(S[C].filter(function(t){return-1!==k.indexOf(t)}).length>0){var O=S[C].filter(function(t){return-1===k.indexOf(t)});k=k.concat(O),S.splice(C--,1)}E[R++]=k}E.length=R;for(var _=0;_<E.length;_++){var V=new o;V.children=E[_].concat(),V.distance=d,V.index=new Array(e);for(var j=0,T=0;T<E[_].length;T++)E[_][T]instanceof i?V.index[j++]=E[_][T]:(j+=E[_][T].index.length,V.index=E[_][T].index.concat(V.index)),f.splice(f.indexOf(E[_][T]),1);V.index.length=j,f.push(V)}}return f[0]}},function(t,r,e){t.exports=e(39)},function(t,r,e){var n,i,o;(function(){var e,s,a,h,u,c,l,f,m,g,d,p,v,w,x;a=Math.floor,g=Math.min,s=function(t,r){return t<r?-1:t>r?1:0},m=function(t,r,e,n,i){var o;if(null==e&&(e=0),null==i&&(i=s),e<0)throw new Error("lo must be non-negative");for(null==n&&(n=t.length);e<n;)i(r,t[o=a((e+n)/2)])<0?n=o:e=o+1;return[].splice.apply(t,[e,e-e].concat(r)),r},c=function(t,r,e){return null==e&&(e=s),t.push(r),w(t,0,t.length-1,e)},u=function(t,r){var e,n;return null==r&&(r=s),e=t.pop(),t.length?(n=t[0],t[0]=e,x(t,0,r)):n=e,n},f=function(t,r,e){var n;return null==e&&(e=s),n=t[0],t[0]=r,x(t,0,e),n},l=function(t,r,e){var n;return null==e&&(e=s),t.length&&e(t[0],r)<0&&(r=(n=[t[0],r])[0],t[0]=n[1],x(t,0,e)),r},h=function(t,r){var e,n,i,o,h,u;for(null==r&&(r=s),h=[],n=0,i=(o=function(){u=[];for(var r=0,e=a(t.length/2);0<=e?r<e:r>e;0<=e?r++:r--)u.push(r);return u}.apply(this).reverse()).length;n<i;n++)e=o[n],h.push(x(t,e,r));return h},v=function(t,r,e){var n;if(null==e&&(e=s),-1!==(n=t.indexOf(r)))return w(t,0,n,e),x(t,n,e)},d=function(t,r,e){var n,i,o,a,u;if(null==e&&(e=s),!(i=t.slice(0,r)).length)return i;for(h(i,e),o=0,a=(u=t.slice(r)).length;o<a;o++)n=u[o],l(i,n,e);return i.sort(e).reverse()},p=function(t,r,e){var n,i,o,a,c,l,f,d,p;if(null==e&&(e=s),10*r<=t.length){if(!(o=t.slice(0,r).sort(e)).length)return o;for(i=o[o.length-1],a=0,l=(f=t.slice(r)).length;a<l;a++)e(n=f[a],i)<0&&(m(o,n,0,null,e),o.pop(),i=o[o.length-1]);return o}for(h(t,e),p=[],c=0,d=g(r,t.length);0<=d?c<d:c>d;0<=d?++c:--c)p.push(u(t,e));return p},w=function(t,r,e,n){var i,o,a;for(null==n&&(n=s),i=t[e];e>r&&n(i,o=t[a=e-1>>1])<0;)t[e]=o,e=a;return t[e]=i},x=function(t,r,e){var n,i,o,a,h;for(null==e&&(e=s),i=t.length,h=r,o=t[r],n=2*r+1;n<i;)(a=n+1)<i&&!(e(t[n],t[a])<0)&&(n=a),t[r]=t[n],n=2*(r=n)+1;return t[r]=o,w(t,h,r,e)},e=function(){function t(t){this.cmp=null!=t?t:s,this.nodes=[]}return t.push=c,t.pop=u,t.replace=f,t.pushpop=l,t.heapify=h,t.updateItem=v,t.nlargest=d,t.nsmallest=p,t.prototype.push=function(t){return c(this.nodes,t,this.cmp)},t.prototype.pop=function(){return u(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return f(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return l(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return h(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return v(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var r;return(r=new t).nodes=this.nodes.slice(0),r},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),i=[],void 0===(o="function"==typeof(n=function(){return e})?n.apply(r,i):n)||(t.exports=o)}).call(this)},function(t,r,e){(function(t){var n=Object.getOwnPropertyDescriptors||function(t){for(var r=Object.keys(t),e={},n=0;n<r.length;n++)e[r[n]]=Object.getOwnPropertyDescriptor(t,r[n]);return e},i=/%[sdj%]/g;r.format=function(t){if(!v(t)){for(var r=[],e=0;e<arguments.length;e++)r.push(a(arguments[e]));return r.join(" ")}e=1;for(var n=arguments,o=n.length,s=String(t).replace(i,function(t){if("%%"===t)return"%";if(e>=o)return t;switch(t){case"%s":return String(n[e++]);case"%d":return Number(n[e++]);case"%j":try{return JSON.stringify(n[e++])}catch(t){return"[Circular]"}default:return t}}),h=n[e];e<o;h=n[++e])d(h)||!y(h)?s+=" "+h:s+=" "+a(h);return s},r.deprecate=function(e,n){if(void 0!==t&&!0===t.noDeprecation)return e;if(void 0===t)return function(){return r.deprecate(e,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),i=!0}return e.apply(this,arguments)}};var o,s={};function a(t,e){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(e)?n.showHidden=e:e&&r._extend(n,e),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=h),c(n,t,n.depth)}function h(t,r){var e=a.styles[r];return e?"["+a.colors[e][0]+"m"+t+"["+a.colors[e][1]+"m":t}function u(t,r){return t}function c(t,e,n){if(t.customInspect&&e&&A(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(n,t);return v(i)||(i=c(t,i,n)),i}var o=function(t,r){if(w(r))return t.stylize("undefined","undefined");if(v(r)){var e="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(e,"string")}if(p(r))return t.stylize(""+r,"number");if(g(r))return t.stylize(""+r,"boolean");if(d(r))return t.stylize("null","null")}(t,e);if(o)return o;var s=Object.keys(e),a=function(t){var r={};return t.forEach(function(t,e){r[t]=!0}),r}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),b(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(e);if(0===s.length){if(A(e)){var h=e.name?": "+e.name:"";return t.stylize("[Function"+h+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(M(e))return t.stylize(Date.prototype.toString.call(e),"date");if(b(e))return l(e)}var u,y="",k=!1,S=["{","}"];(m(e)&&(k=!0,S=["[","]"]),A(e))&&(y=" [Function"+(e.name?": "+e.name:"")+"]");return x(e)&&(y=" "+RegExp.prototype.toString.call(e)),M(e)&&(y=" "+Date.prototype.toUTCString.call(e)),b(e)&&(y=" "+l(e)),0!==s.length||k&&0!=e.length?n<0?x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),u=k?function(t,r,e,n,i){for(var o=[],s=0,a=r.length;s<a;++s)R(r,String(s))?o.push(f(t,r,e,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(t,r,e,n,i,!0))}),o}(t,e,n,a,s):s.map(function(r){return f(t,e,n,a,r,k)}),t.seen.pop(),function(t,r,e){if(t.reduce(function(t,r){return 0,r.indexOf("\n")>=0&&0,t+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return e[0]+(""===r?"":r+"\n ")+" "+t.join(",\n  ")+" "+e[1];return e[0]+r+" "+t.join(", ")+" "+e[1]}(u,y,S)):S[0]+y+S[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,r,e,n,i,o){var s,a,h;if((h=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]}).get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),R(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(h.value)<0?(a=d(e)?c(t,h.value,null):c(t,h.value,e-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function m(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function d(t){return null===t}function p(t){return"number"==typeof t}function v(t){return"string"==typeof t}function w(t){return void 0===t}function x(t){return y(t)&&"[object RegExp]"===k(t)}function y(t){return"object"==typeof t&&null!==t}function M(t){return y(t)&&"[object Date]"===k(t)}function b(t){return y(t)&&("[object Error]"===k(t)||t instanceof Error)}function A(t){return"function"==typeof t}function k(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}r.debuglog=function(e){if(w(o)&&(o=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!s[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=t.pid;s[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else s[e]=function(){};return s[e]},r.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=m,r.isBoolean=g,r.isNull=d,r.isNullOrUndefined=function(t){return null==t},r.isNumber=p,r.isString=v,r.isSymbol=function(t){return"symbol"==typeof t},r.isUndefined=w,r.isRegExp=x,r.isObject=y,r.isDate=M,r.isError=b,r.isFunction=A,r.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},r.isBuffer=e(42);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(t,r){return Object.prototype.hasOwnProperty.call(t,r)}r.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":"),[t.getDate(),E[t.getMonth()],e].join(" ")),r.format.apply(r,arguments))},r.inherits=e(43),r._extend=function(t,r){if(!r||!y(r))return t;for(var e=Object.keys(r),n=e.length;n--;)t[e[n]]=r[e[n]];return t};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(t,r){if(!t){var e=new Error("Promise was rejected with a falsy value");e.reason=t,t=e}return r(t)}r.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(C&&t[C]){var r;if("function"!=typeof(r=t[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,C,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var r,e,n=new Promise(function(t,n){r=t,e=n}),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push(function(t,n){t?e(t):r(n)});try{t.apply(this,i)}catch(t){e(t)}return n}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),C&&Object.defineProperty(r,C,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,n(t))},r.promisify.custom=C,r.callbackify=function(r){if("function"!=typeof r)throw new TypeError('The "original" argument must be of type Function');function e(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);var i=e.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};r.apply(this,e).then(function(r){t.nextTick(s,null,r)},function(r){t.nextTick(O,r,s)})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,n(r)),e}}).call(this,e(41))},function(t,r){var e,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var h,u=[],c=!1,l=-1;function f(){c&&h&&(c=!1,h.length?u=h.concat(u):l=-1,u.length&&m())}function m(){if(!c){var t=a(f);c=!0;for(var r=u.length;r;){for(h=u,u=[];++l<r;)h&&h[l].run();l=-1,r=u.length}h=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(r){try{return n.call(null,t)}catch(r){return n.call(this,t)}}}(t)}}function g(t,r){this.fun=t,this.array=r}function d(){}i.nextTick=function(t){var r=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)r[e-1]=arguments[e];u.push(new g(t,r)),1!==u.length||c||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=d,i.addListener=d,i.once=d,i.off=d,i.removeListener=d,i.removeAllListeners=d,i.emit=d,i.prependListener=d,i.prependOnceListener=d,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,r){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,r){"function"==typeof Object.create?t.exports=function(t,r){t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,r){t.super_=r;var e=function(){};e.prototype=r.prototype,t.prototype=new e,t.prototype.constructor=t}},function(t,r,e){"use strict";t.exports=function(t,r){const e=t.length;let n=Array.from({length:e}).map(()=>Array.from({length:e}));for(let i=0;i<e;i++)for(let e=0;e<=i;e++)n[i][e]=r(t[i],t[e]);for(let t=0;t<e;t++)for(let r=t+1;r<e;r++)n[t][r]=n[r][t];return n}},function(t,r,e){"use strict";const n=e(15),i=e(16),o=e(7);function s(t,r,e){for(var n=1e101,i=0;i<t.length;i++)for(var o=i;o<r.length;o++){var s=e(t[i],r[o]);n=Math.min(s,n)}return n}function a(t,r,e){for(var n=-1,i=0;i<t.length;i++)for(var o=i;o<r.length;o++){var s=e(t[i],r[o]);n=Math.max(s,n)}return n}function h(t,r,e){for(var n=0,i=0;i<t.length;i++)for(var o=0;o<r.length;o++)n+=e(t[i],r[o]);return n/(t.length*r.length)}function u(t,r,e){for(var n=0,i=0,o=0,s=0,a=0;a<t.length;a++)n+=t[a][0],i+=t[a][1];for(var h=0;h<r.length;h++)o+=r[h][0],s+=r[h][1];return e([n/=t.length,i/=t.length],[o/=r.length,s/=r.length])}function c(t,r,e){for(var n=0,i=0,o=0,s=0,a=0;a<t.length;a++)n+=t[a][0],i+=t[a][1];for(var h=0;h<r.length;h++)o+=r[h][0],s+=r[h][1];return e([n/=t.length,i/=t.length],[o/=r.length,s/=r.length])*t.length*r.length/(t.length+r.length)}function l(t,r,e){for(var n={d:0,p:0},i=new Array(t[0].length),o=0;o<t[0].length;o++)i[o]=r[t[0][o]];for(var s,a,h=new Array(t[1].length),u=0;u<t[1].length;u++)h[u]=r[t[1][u]];for(var c=0;c<i.length;c++){s=0;for(var l=0;l<i.length;l++)c!==l&&(s+=e(i[c],i[l]));s/=i.length-1,a=0;for(var f=0;f<h.length;f++)a+=e(i[c],h[f]);s-(a/=h.length)>n.d&&(n.d=s-a,n.p=c)}return n}var f={dist:n,kind:"single"};function m(t,r,e){for(var n=0,i=0,o=0;o<t.length;o++)for(var s=o;s<t.length;s++)n+=e(r[t[o].index],r[t[s].index]),i++;return n/i}t.exports=function(t,r){if("string"==typeof(r=Object.assign({},f,r)).kind)switch(r.kind){case"single":r.kind=s;break;case"complete":r.kind=a;break;case"average":r.kind=h;break;case"centroid":r.kind=u;break;case"ward":r.kind=c;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof r.kind)throw new TypeError("Undefined kind of similarity");var e,n,g,d,p,v=new o;v.children=new Array(t.length),v.index=new Array(t.length);for(var w=0;w<t.length;w++)v.children[w]=new i(w),v.index[w]=new i(w);v.distance=m(v.index,t,r.dist);for(var x=[v];x.length>0;){n=0,g=0;for(var y=0;y<x.length;y++){e=0;for(var M=0;M<x[y].length;M++)for(var b=M+1;b<x[y].length;b++)e=Math.max(r.dist(t[x[y].index[M].index],t[x[y].index[b].index]),e);e>n&&(n=e,g=y)}if(n=0,2===x[g].index.length)x[g].children=[x[g].index[0],x[g].index[1]],x[g].distance=r.dist(t[x[g].index[0].index],t[x[g].index[1].index]);else if(3===x[g].index.length){x[g].children=[x[g].index[0],x[g].index[1],x[g].index[2]];var A=[r.dist(t[x[g].index[0].index],t[x[g].index[1].index]),r.dist(t[x[g].index[1].index],t[x[g].index[2].index])];x[g].distance=(A[0]+A[1])/2}else{for(var k=new o,S=new o,E=[new Array(x[g].index.length),[]],R=0;R<E[0].length;R++)E[0][R]=R;for(var C=0;C<E[0].length;C++){d=0;for(var O=0;O<E[0].length;O++)C!==O&&(d+=r.dist(t[x[g].index[E[0][O]].index],t[x[g].index[E[0][C]].index]));(d/=E[0].length-1)>n&&(n=d,p=C)}for(E[1]=[p],E[0].splice(p,1),d=l(E,t,r.dist);d.d>0;)E[1].push(E[0][d.p]),E[0].splice(d.p,1),d=l(E,t,r.dist);var _=new Array(E[0].length);k.index=new Array(E[0].length);for(var V=0;V<_.length;V++)_[V]=t[x[g].index[E[0][V]].index],k.index[V]=x[g].index[E[0][V]],k.children[V]=x[g].index[E[0][V]];var j=new Array(E[1].length);S.index=new Array(E[1].length);for(var T=0;T<j.length;T++)j[T]=t[x[g].index[E[1][T]].index],S.index[T]=x[g].index[E[1][T]],S.children[T]=x[g].index[E[1][T]];k.distance=m(k.index,t,r.dist),S.distance=m(S.index,t,r.dist),x.push(k),x.push(S),x[g].children=[k,S]}x.splice(g,1)}return v}},function(t,r,e){"use strict";const n=e(8),i=e(47),o=i.nextPrime,s=i.largestPrime,a=0,h=1,u=2,c=150,l=1/6,f=2/3;class m{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t instanceof m)return this.table=t.table.slice(),this.values=t.values.slice(),this.state=t.state.slice(),this.minLoadFactor=t.minLoadFactor,this.maxLoadFactor=t.maxLoadFactor,this.distinct=t.distinct,this.freeEntries=t.freeEntries,this.lowWaterMark=t.lowWaterMark,void(this.highWaterMark=t.maxLoadFactor);const r=void 0===t.initialCapacity?c:t.initialCapacity;if(r<0)throw new RangeError("initial capacity must not be less than zero: ".concat(r));const e=void 0===t.minLoadFactor?l:t.minLoadFactor,i=void 0===t.maxLoadFactor?f:t.maxLoadFactor;if(e<0||e>=1)throw new RangeError("invalid minLoadFactor: ".concat(e));if(i<=0||i>=1)throw new RangeError("invalid maxLoadFactor: ".concat(i));if(e>=i)throw new RangeError("minLoadFactor (".concat(e,") must be smaller than maxLoadFactor (").concat(i,")"));let a=r;0===(a=o(a=a/i|0))&&(a=1),this.table=n(a,0),this.values=n(a,0),this.state=n(a,0),this.minLoadFactor=e,this.maxLoadFactor=a===s?1:i,this.distinct=0,this.freeEntries=a,this.lowWaterMark=0,this.highWaterMark=g(a,this.maxLoadFactor)}clone(){return new m(this)}get size(){return this.distinct}get(t){const r=this.indexOfKey(t);return r<0?0:this.values[r]}set(t,r){let e=this.indexOfInsertion(t);if(e<0)return e=-e-1,this.values[e]=r,!1;if(this.distinct>this.highWaterMark){const e=d(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);return this.rehash(e),this.set(t,r)}if(this.table[e]=t,this.values[e]=r,this.state[e]===a&&this.freeEntries--,this.state[e]=h,this.distinct++,this.freeEntries<1){const t=d(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);this.rehash(t)}return!0}remove(t,r){const e=this.indexOfKey(t);return!(e<0)&&(this.state[e]=u,this.distinct--,r||this.maybeShrinkCapacity(),!0)}delete(t,r){const e=this.indexOfKey(t);return!(e<0)&&(this.state[e]=a,this.distinct--,r||this.maybeShrinkCapacity(),!0)}maybeShrinkCapacity(){if(this.distinct<this.lowWaterMark){const n=(t=this.distinct,r=this.minLoadFactor,e=this.maxLoadFactor,o(Math.max(t+1,4*t/(r+3*e)|0)));this.rehash(n)}var t,r,e}containsKey(t){return this.indexOfKey(t)>=0}indexOfKey(t){const r=this.table,e=this.state,n=this.table.length,i=2147483647&t;let o=i%n,s=i%(n-2);for(0===s&&(s=1);e[o]!==a&&(e[o]===u||r[o]!==t);)(o-=s)<0&&(o+=n);return e[o]===a?-1:o}containsValue(t){return this.indexOfValue(t)>=0}indexOfValue(t){const r=this.values,e=this.state;for(var n=0;n<e.length;n++)if(e[n]===h&&r[n]===t)return n;return-1}indexOfInsertion(t){const r=this.table,e=this.state,n=r.length,i=2147483647&t;let o=i%n,s=i%(n-2);for(0===s&&(s=1);e[o]===h&&r[o]!==t;)(o-=s)<0&&(o+=n);if(e[o]===u){const i=o;for(;e[o]!==a&&(e[o]===u||r[o]!==t);)(o-=s)<0&&(o+=n);e[o]===a&&(o=i)}return e[o]===h?-o-1:o}ensureCapacity(t){if(this.table.length<t){const r=o(t);this.rehash(r)}}rehash(t){const r=this.table.length;if(t<=this.distinct)throw new Error("Unexpected");const e=this.table,i=this.values,o=this.state,s=n(t,0),a=n(t,0),u=n(t,0);var c,l;this.lowWaterMark=(c=t,l=this.minLoadFactor,c*l|0),this.highWaterMark=g(t,this.maxLoadFactor),this.table=s,this.values=a,this.state=u,this.freeEntries=t-this.distinct;for(var f=0;f<r;f++)if(o[f]===h){var m=e[f],d=this.indexOfInsertion(m);s[d]=m,a[d]=i[f],u[d]=h}}forEachKey(t){for(var r=0;r<this.state.length;r++)if(this.state[r]===h&&!t(this.table[r]))return!1;return!0}forEachValue(t){for(var r=0;r<this.state.length;r++)if(this.state[r]===h&&!t(this.values[r]))return!1;return!0}forEachPair(t){for(var r=0;r<this.state.length;r++)if(this.state[r]===h&&!t(this.table[r],this.values[r]))return!1;return!0}}function g(t,r){return Math.min(t-2,t*r|0)}function d(t,r,e){return o(Math.max(t+1,4*t/(3*r+e)|0))}t.exports=m},function(t,r,e){const n=e(9),i=e(5).asc,o=[2147483647,5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939,210719881,421439783,842879579,1685759167,433,877,1759,3527,7057,14143,28289,56591,113189,226379,452759,905551,1811107,3622219,7244441,14488931,28977863,57955739,115911563,231823147,463646329,927292699,1854585413,953,1907,3821,7643,15287,30577,61169,122347,244703,489407,978821,1957651,3915341,7830701,15661423,31322867,62645741,125291483,250582987,501165979,1002331963,2004663929,1039,2081,4177,8363,16729,33461,66923,133853,267713,535481,1070981,2141977,4283963,8567929,17135863,34271747,68543509,137087021,274174111,548348231,1096696463,31,67,137,277,557,1117,2237,4481,8963,17929,35863,71741,143483,286973,573953,1147921,2295859,4591721,9183457,18366923,36733847,73467739,146935499,293871013,587742049,1175484103,599,1201,2411,4831,9677,19373,38747,77509,155027,310081,620171,1240361,2480729,4961459,9922933,19845871,39691759,79383533,158767069,317534141,635068283,1270136683,311,631,1277,2557,5119,10243,20507,41017,82037,164089,328213,656429,1312867,2625761,5251529,10503061,21006137,42012281,84024581,168049163,336098327,672196673,1344393353,3,7,17,37,79,163,331,673,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,43,89,179,359,719,1439,2879,5779,11579,23159,46327,92657,185323,370661,741337,1482707,2965421,5930887,11861791,23723597,47447201,94894427,189788857,379577741,759155483,1518310967,379,761,1523,3049,6101,12203,24407,48817,97649,195311,390647,781301,1562611,3125257,6250537,12501169,25002389,50004791,100009607,200019221,400038451,800076929,1600153859,13,29,59,127,257,521,1049,2099,4201,8419,16843,33703,67409,134837,269683,539389,1078787,2157587,4315183,8630387,17260781,34521589,69043189,138086407,276172823,552345671,1104691373,19,41,83,167,337,677,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,53,107,223,449,907,1823,3659,7321,14653,29311,58631,117269,234539,469099,938207,1876417,3752839,7505681,15011389,30022781,60045577,120091177,240182359,480364727,960729461,1921458943];o.sort(i),r.nextPrime=function(t){let r=n(o,t,i);return r<0&&(r=~r),o[r]},r.largestPrime=2147483647},function(t,r,e){"use strict";t.exports=Number.isNaN||function(t){return t!=t}},function(t,r,e){"use strict";e.r(r);var n=e(1),i=e.n(n),o=e(8),s=e.n(o),a=e(17),h=e.n(a),u=e(18),c=e.n(u);class l{constructor(t,r,e){this.chemicalShifts=t,this.couplingConstants=r,this.multiplicity=e,this.nSpins=t.length,this._initConnectivity(),this._initClusters()}static fromSpinusPrediction(t){var r=t.split("\n"),e=r.length-1,n=new Array(e),o=new Array(e),a={},h=i.a.zeros(e,e);for(let t=0;t<e;t++){var u=r[t].split("\t");n[t]=+u[2],a[u[0]-1]=t,o[t]=+u[5]}for(let t=0;t<e;t++){var c=((u=r[t].split("\t")).length-4)/3;for(m=0;m<c;m++){var f=a[u[4+3*m]-1];h[t][f]=+u[6+3*m]}}for(var m=0;m<e;m++)for(var g=m;g<e;g++)h[m][g]=h[g][m];return new l(n,h,s()(e,2))}static fromPrediction(t){let r=l.ungroupAtoms(t);const e=r.length,n=new Array(e),o=i.a.zeros(e,e),s=new Array(e),a={};var h,u,c;for(h=0;h<e;h++)n[h]=r[h].delta,a[r[h].atomIDs[0]]=h;for(h=0;h<e;h++){for(n[h]=r[h].delta,c=r[h].j,u=0;u<c.length;u++)o[a[r[h].atomIDs[0]]][a[c[u].assignment]]=c[u].coupling,o[a[c[u].assignment]][a[r[h].atomIDs[0]]]=c[u].coupling;s[h]=r[h].integral+1}return new l(n,o,s)}static ungroupAtoms(t){let r=[];return t.forEach(t=>{let e=t.atomIDs;if(e instanceof Array)for(let n=0;n<e.length;n++){let i=JSON.parse(JSON.stringify(t)),o=[];if(i.atomIDs=[e[n]],i.integral=1,i.j instanceof Array)for(let t=0;t<i.j.length;t++){let r=i.j[t].assignment;if(r instanceof Array)for(let e=0;e<r.length;e++){let n=JSON.parse(JSON.stringify(i.j[t]));n.assignment=r[e],o.push(n)}}i.j=o,delete i.nbAtoms,r.push(i)}}),r}_initClusters(){this.clusters=h()(this.connectivity,{out:"indexes"})}_initConnectivity(){const t=this.couplingConstants,r=i.a.ones(t.length,t.length);for(var e=0;e<t.length;e++)for(var n=e;n<t[e].length;n++)0===t[e][n]&&(r[e][n]=0,r[n][e]=0);this.connectivity=r}_calculateBetas(t,r){var e,n,o=i.a.zeros(t.length,t.length);for(e=0;e<t.rows;e++)for(n=e;n<t.columns;n++)this.chemicalShifts[e]-this.chemicalShifts[n]!=0?(o[e][n]=1-Math.abs(t[e][n]/((this.chemicalShifts[e]-this.chemicalShifts[n])*r)),o[n][e]=o[e][n]):e!==n&&0===t[e][n]&&(o[e][n]=1,o[n][e]=1);return o}ensureClusterSize(t){var r=this._calculateBetas(this.couplingConstants,t.frequency||400),e=c.a.agnes(r,{isDistanceMatrix:!0}),n=[];this._splitCluster(e,n,t.maxClusterSize||8,!1);var i=this._mergeClusters(n);this.nClusters=i.length,this.clusters=new Array(i.length);for(var o=0;o<this.nClusters;o++){this.clusters[o]=[];for(var s=0;s<this.nSpins;s++)0!==i[o][s]&&(i[o][s]<0?this.clusters[o].push(-(s+1)):this.clusters[o].push(s))}}_splitCluster(t,r,e,n){if(!n&&t.index.length<=e)r.push(this._getMembers(t));else for(var i of t.children)if(!isNaN(i.index)||i.index.length<=e){for(var o=this._getMembers(i),s=0,a=0;a<this.nSpins;a++)if(1===o[a]){s++;for(var h=0;h<this.nSpins;h++)1===this.connectivity[a][h]&&0===o[h]&&(o[h]=-1,s++)}s<=e?r.push(o):isNaN(i.index)?this._splitCluster(i,r,e,!0):(o[i.index]=2,r.push(o))}else this._splitCluster(i,r,e,!1)}_getMembers(t){for(var r=new Array(this.nSpins),e=0;e<this.nSpins;e++)r[e]=0;if(isNaN(t.index))for(var n of t.index)r[1*n.index]=1;else r[1*t.index]=1;return r}_mergeClusters(t){var r,e,n,i,o,s,a,h=0;for(n=t.length-1;n>=0;n--){for(h=(r=t[n]).length,o=0;o<h&&-1!==r[o++];);if(o<h)for(i=t.length-1;i>=n+1;i--){for(e=t[i],o=0,s=0,a=0;o<h;)r[o]*e[o]==-1&&s++,0===r[o]&&0===e[o]||a++,o++;if(s>0&&a<=this.maxClusterSize){for(o=0;o<h;)1===e[o]?r[o]=1:-1===e[o]&&1!==r[o]&&(r[o]=-1),o++;t.splice(i,1),i++}}}return t}}var f=e(0),m=e.n(f),g=e(9),d=e.n(g),p=e(5);function v(t){const r=(t-1)/2,e=new Array(t),n=new Array(t);for(var i=0;i<t;i++)e[i]=t-1-i-r,n[i]=Math.sqrt(r*(r+1)-e[i]*(e[i]+1));const o=w(n,1,t,t);for(i=0;i<t;i++)n[i]=Math.sqrt(r*(r+1)-e[i]*(e[i]-1));const s=w(n,-1,t,t);return{x:o.clone().add(s).mul(.5),y:s.clone().mul(-1).add(o).mul(-.5),z:w(e,0,t,t),m:s,p:o}}function w(t,r,e,n){const i=new m.a(e,n,{initialCapacity:20});for(var o=0;o<t.length;o++)o-r>=0&&o-r<e&&o<n&&i.set(o-r,o,t[o]);return i}const x=v(2);function y(t){return 2===t?x:v(t)}const M=.01;function b(t,r){var e,n,o=r.lineWidth,s=void 0===o?1:o,a=r.nbPoints,h=void 0===a?1024:a,u=r.maxClusterSize,c=void 0===u?10:u,l=r.output,f=void 0===l?"y":l,g=r.frequency,v=void 0===g?400:g,w=r.noiseFactor,x=void 0===w?1:w;h=Number(h);const b=r.from*v||0,R=(r.to||10)*v,C=t.chemicalShifts.slice();for(e=0;e<C.length;e++)C[e]=C[e]*v;let O=h*s/Math.abs(R-b)/2.355,_=h*s/Math.abs(R-b)/2,V=40*_;const j=0|V,T=new Array(j),D=V/2,I=O*O*2,N=_*_,F=O*Math.sqrt(2*Math.PI);for(e=0;e<j;e++){let t=(e-D)*(e-D);T[e]=1e10*(Math.exp(-t/I)/F+_/((t+N)*Math.PI))}var z=r.withNoise?[...new Array(h)].map(()=>Math.random()*x):new Array(h).fill(0);const q=t.multiplicity;for(var P=0;P<t.clusters.length;P++){const r=t.clusters[P];var W=new Array(r.length);for(e=0;e<r.length;e++)W[e]=r[e]<0?-r[e]-1:r[e];var L=1,U=0;const o=[],a=[];if(r.length>c){for(var X,Z,Y=0;r[Y++]<0;);for(Y=r[Y-1],o.push(-C[Y]),e=0;e<r.length;e++)if(r[e]<0)for(Z=t.couplingConstants[Y][W[e]]/2,X=o.length,n=0;n<X;n++)o.push(o[n]+Z),o[n]-=Z;for(o.sort(p.asc),U=o.length,L=1,e=0;e<U;e++)a.push(1)}else{const e=S(C,t.couplingConstants,q,t.connectivity,W),s=e.rows,h=new i.a.DC.EVD(e),u=h.eigenvectorMatrix,c=h.realEigenvalues,l=new m.a(s,s),f=r.length;L=0;for(var H=0;H<f;H++){const t=y(q[W[H]]);let e=1;for(n=0;n<H;n++)e*=q[W[n]];const i=m.a.eye(e);for(e=1,n=H+1;n<f;n++)e*=q[W[n]];const o=m.a.eye(e),s=i.kroneckerProduct(t.m).kroneckerProduct(o);r[H]>=0?(l.add(s.mul(r[H]+1)),L++):l.add(s.mul(r[H]))}let g=i.a.zeros(s,s);l.forEachNonZero((t,r,e)=>{if(e>0){const e=u[r];for(var n=0;n<e.length;n++)0!==e[n]&&g.set(t,n,g.get(t,n)+e[n])}return e});let v=g.clone();l.forEachNonZero((t,r,e)=>{if(e<0){const e=u[r];for(var n=0;n<e.length;n++)0!==e[n]&&v.set(t,n,v.get(t,n)+e[n])}return e});const w=u.transpose();g=w.mmul(g),k(g=new m.a(g,{threshold:M}),M),v=w.mmul(v),k(v=new m.a(v,{threshold:M}),M),v.forEachNonZero((t,r,e)=>{var n=g.get(t,r);n=Math.min(Math.abs(n),Math.abs(e)),U+=n*=n;var i=c[t]-c[r],s=d()(o,i,p.asc);s<0?(o.splice(-1-s,0,i),a.splice(-1-s,0,n)):a[s]+=n})}const u=o.length;if(u>0){L/=U;const t=s/64;let r=o[0],n=a[0],i=1;for(e=1;e<u;e++)Math.abs(o[e]-r/i)<t?(n+=a[e],r+=o[e],i++):(A(z,r/i,n*L,b,R,h,T),r=o[e],n=a[e],i=1);A(z,r/i,n*L,b,R,h,T)}}if("xy"===f)return{x:E(r.from,r.to,h),y:z};if("y"===f)return z;throw new RangeError("wrong output option")}function A(t,r,e,n,i,o,s){const a=o*(-r-n)/(i-n)|0,h=s.length;for(var u=0,c=0,l=a-h/2;l<a+h/2;l++)u=0|l,l>=0&&l<o&&(t[u]=t[u]+s[c]*e),c++}function k(t,r){t.forEachNonZero((t,e,n)=>t>e?0:Math.abs(n)<=r?0:n)}function S(t,r,e,n,i){let o=1;for(var s=0;s<i.length;s++)o*=e[i[s]];const a=new m.a(o,o);for(var h=0;h<i.length;h++){var u=i[h];const o=y(e[u]);let s,l,f=1;for(let t=0;t<h;t++)f*=e[i[t]];s=m.a.eye(f),f=1;for(let t=h+1;t<i.length;t++)f*=e[i[t]];l=m.a.eye(f);const g=t[u],d=s.kroneckerProduct(o.z).kroneckerProduct(l);a.add(d.mul(g));for(var c=0;c<i.length;c++){const t=i[c];if(1===n[u][t]){const n=y(e[t]);let h,f,g=1;for(let t=0;t<c;t++)g*=e[i[t]];h=m.a.eye(g),g=1;for(let t=c+1;t<i.length;t++)g*=e[i[t]];f=m.a.eye(g);const d=s.kroneckerProduct(o.x).kroneckerProduct(l).mmul(h.kroneckerProduct(n.x).kroneckerProduct(f));d.add(s.kroneckerProduct(o.y).kroneckerProduct(l).mul(-1).mmul(h.kroneckerProduct(n.y).kroneckerProduct(f))),d.add(s.kroneckerProduct(o.z).kroneckerProduct(l).mmul(h.kroneckerProduct(n.z).kroneckerProduct(f))),a.add(d.mul(r[u][t]/2))}}}return a}function E(t,r,e){const n=new Array(e),i=(r-t)/(e-1);for(var o=0;o<e;o++)n[o]=t+o*i;return n}let R={H:{frequency:400,lineWidth:10},C:{frequency:100,lineWidth:10}};function C(t,r){var e;const n=t[0].fromAtomLabel,o=t[0].toLabel,s=r.frequencyX||R[n].frequency,a=r.frequencyY||R[o].frequency;var h=r.lineWidthX||R[n].lineWidth,u=r.lineWidthY||R[o].lineWidth;let c=r.symmetrize||!1;var l=h/s,f=u/a,m=t[0].fromChemicalShift,g=t[0].fromChemicalShift,d=t[0].toChemicalShift,p=t[0].toChemicalShift;for(e=1;e<t.length;)m=Math.min(m,t[e].fromChemicalShift),g=Math.max(g,t[e].fromChemicalShift),d=Math.min(d,t[e].toChemicalShift),p=Math.max(p,t[e].toChemicalShift),e++;null===r.firstX||isNaN(r.firstX)||(m=r.firstX),null===r.firstY||isNaN(r.firstY)||(d=r.firstY),null===r.lastX||isNaN(r.lastX)||(g=r.lastX),null===r.lastY||isNaN(r.lastY)||(p=r.lastY);var v=r.nbPointsX||512,w=r.nbPointsY||512,x=new i.a(w,v).fill(0);for(e=0;e<t.length;){let r={x:O(t[e].fromChemicalShift,m,g,v),y:O(t[e].toChemicalShift,d,p,w),z:t[e].fromAtoms.length+t[e].toAtoms.length,widthX:O(l+m,m,g,v),widthY:O(f+d,d,p,w)};_(x,r),c&&_(x,{x:r.y,y:r.x,z:r.z,widthX:r.widthY,widthY:r.widthX}),e++}return x}function O(t,r,e,n){return(t-r)*(n-1)/(e-r)}function _(t,r){for(var e=Math.max(0,Math.round(r.x-4*r.widthX)),n=Math.min(t[0].length-1,Math.round(r.x+4*r.widthX)),i=Math.max(0,Math.round(r.y-4*r.widthY)),o=Math.min(t.length-1,Math.round(r.y+4*r.widthY)),s=r.widthX*r.widthX,a=r.widthY*r.widthY,h=i;h<o;h++)for(var u=e;u<n;u++){var c=Math.pow(r.x-u,2)/s+Math.pow(r.y-h,2)/a,l=1e4*r.z*Math.exp(-c);t[h][u]+=l}}e.d(r,"SpinSystem",function(){return l}),e.d(r,"simulate1D",function(){return b}),e.d(r,"simulate2D",function(){return C})}])});
//# sourceMappingURL=nmr-simulation.min.js.map