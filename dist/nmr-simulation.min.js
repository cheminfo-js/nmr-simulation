(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports.nmrSimulation=t():e.nmrSimulation=t()})(this,function(){var e=Math.exp,t=Math.log,o=Math.pow,h=Math.max,u=Math.min,n=Math.floor,v=Math.sqrt,M=Math.abs,s=Number.isInteger;return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=20)}([function(e,t,n){'use strict';n(38);var i=n(10),o=n(2);class r extends i(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(r.isMatrix(e))return e.clone();if(s(e)&&0<e){if(super(e),s(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){const i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[i[n]]}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,n){return this[e][t]=n,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.set(t,n,this.get(t,n));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=r,r.abstractMatrix=i},function(e,t,n){'use strict';var i=n(10),o=n(0);class s extends i(){constructor(e,t,n){super(),this.matrix=e,this.rows=t,this.columns=n}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,n){'use strict';var o=n(0);t.checkRowIndex=function(e,t,n){var i=n?e.rows:e.rows-1;if(0>t||t>i)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,n){var i=n?e.columns:e.columns-1;if(0>t||t>i)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,n){var i=t.some((t)=>{return 0>t||t>=e.rows}),o=n.some((t)=>{return 0>t||t>=e.columns});if(i||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof n)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(n)||(t=Array.from(n)),{row:t,column:n}},t.checkRange=function(e,t,n,i,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>n||i>o||0>t||t>=e.rows||0>n||n>=e.rows||0>i||i>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=o.Matrix.zeros(e.rows,1),n=0;n<e.rows;++n)for(var i=0;i<e.columns;++i)t.set(n,0,t.get(n,0)+e.get(n,i));return t},t.sumByColumn=function(e){for(var t=o.Matrix.zeros(1,e.columns),n=0;n<e.rows;++n)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(n,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,n){'use strict';function i(){this.children=[],this.distance=-1,this.index=[]}const o=n(22);i.prototype.cut=function(e){if(0>e)throw new RangeError('Threshold too small');var t=new i;t.children=this.children,t.distance=this.distance,t.index=this.index;for(var n=[t],o=[];0<n.length;){var s=n.shift();e>=s.distance?o.push(s):n=n.concat(s.children)}return o},i.prototype.group=function(e){if(!s(e)||1>e)throw new RangeError('Number of groups must be a positive integer');const t=new o(function(e,t){return t.distance-e.distance});for(t.push(this);t.size()<e;){var n=t.pop();if(0===n.children.length)break;n.children.forEach((e)=>t.push(e))}var r=new i;return r.children=t.toArray(),r.distance=this.distance,r},i.prototype.traverse=function(e){function t(e,n){if(n(e),e.children)for(var o=e.children.length-1;0<=o;o--)t(e.children[o],n)}t(this,e)},e.exports=i},function(e,t){'use strict';t.hypotenuse=function(e,t){var n;return M(e)>M(t)?(n=t/e,M(e)*v(1+n*n)):0===t?0:(n=e/t,M(t)*v(1+n*n))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t,n){'use strict';e.exports=n(0).Matrix,e.exports.Decompositions=e.exports.DC=n(37)},function(e){e.exports=function(e,t){e=e||0;for(var n=Array(e),o=0;o<e;o++)n[o]=t;return n}},function(e){e.exports=function(e,t,n,i,o){var s,r;if(void 0===i)i=0;else if(i|=0,0>i||i>=e.length)throw new RangeError('invalid lower bound');if(void 0===o)o=e.length-1;else if(o|=0,o<i||o>=e.length)throw new RangeError('invalid upper bound');for(;i<=o;)if(s=i+(o-i>>1),r=+n(e[s],t,s,e),0>r)i=s+1;else if(0<r)o=s-1;else return s;return~i}},function(e){'use strict';function t(e,t){for(var n=0,o=0;o<e.length;o++)n+=(e[o]-t[o])*(e[o]-t[o]);return n}function n(e,n){return v(t(e,n))}e.exports=n,n.squared=t},function(e,t,n){'use strict';function i(e){o.call(this),this.index=e,this.distance=0,this.children=[]}const o=n(3),s=n(52);s.inherits(i,o),e.exports=i},function(e,t,i){'use strict';function o(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function o(e,t){return e-t}function k(e,t){for(var n in t)e=e.replace(new RegExp('%'+n+'%','g'),t[n]);return e}e===void 0&&(e=Object);class f extends e{static get[Symbol.species](){return this}static from1DArray(e,t,n){if(e*t!==n.length)throw new RangeError('Data length does not match given dimensions');for(var i=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)i.set(o,s,n[o*t+s]);return i}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,o,s){o===void 0&&(o=1e3),s===void 0&&(s=Math.random);for(var r=this.empty(e,t),l=0;l<e;l++)for(var i,a=0;a<t;a++)i=n(s()*o),r.set(l,a,i);return r}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=u(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=u(o,t,n),r=this.zeros(t,n),l=0;l<s;l++)r.set(l,l,e[l]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,u(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,h(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return f.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e[t*this.columns+n]=this.get(t,n);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var n=0;n<this.columns;n++)e[t][n]=this.get(t,n)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,e);return this}neg(){return this.mulS(-1)}getRow(e){a.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){a.checkRowIndex(this,e),t=a.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){a.checkRowIndex(this,e),a.checkRowIndex(this,t);for(var n,o=0;o<this.columns;o++)n=this.get(e,o),this.set(e,o,this.get(t,o)),this.set(t,o,n);return this}getColumn(e){a.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){a.checkColumnIndex(this,e),t=a.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){a.checkColumnIndex(this,e),a.checkColumnIndex(this,t);for(var n,o=0;o<this.rows;o++)n=this.get(o,e),this.set(o,e,this.get(o,t)),this.set(o,t,n);return this}addRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}subRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}mulRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}divRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}addColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}subColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}mulColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}divColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}mulRow(e,t){a.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){a.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=u(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?a.sumByRow(this):'column'===e?a.sumByColumn(this):a.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e*=this.get(t,n);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}dot(e){f.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),l=Array(o),a=0;a<n;a++){for(var c=0;c<o;c++)l[c]=e.get(c,a);for(var d,s=0;s<t;s++){for(d=0,c=0;c<o;c++)d+=this.get(s,c)*l[c];r.set(s,a,d)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2);const n=this.get(0,0),i=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),l=e.get(1,0),a=this.get(1,1),c=e.get(1,1),d=(n+a)*(i+c),h=(r+a)*i,g=n*(s-c),u=a*(l-i),m=(n+o)*c;return t.set(0,0,d+u-m+(o-a)*(l+c)),t.set(0,1,g+m),t.set(1,0,h+u),t.set(1,1,d-h+g+(r-n)*(i+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3);const n=this.get(0,0),i=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),l=this.get(1,2),a=this.get(2,0),c=this.get(2,1),d=this.get(2,2),h=e.get(0,0),g=e.get(0,1),u=e.get(0,2),m=e.get(1,0),p=e.get(1,1),x=e.get(1,2),j=e.get(2,0),k=e.get(2,1),f=e.get(2,2),y=(n-s)*(-g+p),w=(-n+s+r)*(h-g+p),b=(s+r)*(-h+g),v=n*h,M=(-n+a+c)*(h-u+x),I=(-n+a)*(u-x),S=(a+c)*(-h+u),C=(-o+c+d)*(p+j-k),D=(o-d)*(p-k),z=o*j,R=(c+d)*(-j+k),V=(-o+r+l)*(x+j-f),L=(o-l)*(x-f),E=(r+l)*(-j+f);return t.set(0,0,v+z+i*m),t.set(0,1,(n+i+o-s-r-c-d)*p+w+b+v+C+z+R),t.set(0,2,v+M+S+(n+i+o-r-l-a-c)*x+z+V+E),t.set(1,0,y+r*(-h+g+m-p-x-j+f)+w+v+z+V+L),t.set(1,1,y+w+b+v+l*k),t.set(1,2,z+V+L+E+s*u),t.set(2,0,v+M+I+c*(-h+u+m-p-x-j+k)+C+D+z),t.set(2,1,C+D+z+R+a*g),t.set(2,2,v+M+I+S+d*f),t}mmulStrassen(e){function t(e,t,n){var i=e.rows,o=e.columns;if(i===t&&o===n)return e;var s=f.zeros(t,n);return s=s.setSubMatrix(e,0,0),s}function n(e,i,o,s){if(512>=o||512>=s)return e.mmul(i);1==o%2&&1==s%2?(e=t(e,o+1,s+1),i=t(i,o+1,s+1)):1==o%2?(e=t(e,o+1,s),i=t(i,o+1,s)):1==s%2&&(e=t(e,o,s+1),i=t(i,o,s+1));var r=parseInt(e.rows/2),l=parseInt(e.columns/2),a=e.subMatrix(0,r-1,0,l-1),c=i.subMatrix(0,r-1,0,l-1),d=e.subMatrix(0,r-1,l,e.columns-1),h=i.subMatrix(0,r-1,l,i.columns-1),g=e.subMatrix(r,e.rows-1,0,l-1),u=i.subMatrix(r,i.rows-1,0,l-1),m=e.subMatrix(r,e.rows-1,l,e.columns-1),p=i.subMatrix(r,i.rows-1,l,i.columns-1),x=n(f.add(a,m),f.add(c,p),r,l),j=n(f.add(g,m),c,r,l),k=n(a,f.sub(h,p),r,l),y=n(m,f.sub(u,c),r,l),w=n(f.add(a,d),p,r,l),b=n(f.sub(g,a),f.add(c,h),r,l),v=n(f.sub(d,m),f.add(u,p),r,l),M=f.add(x,y);M.sub(w),M.add(v);var I=f.add(k,w),S=f.add(j,y),C=f.sub(x,j);C.add(k),C.add(b);var D=f.zeros(2*M.rows,2*M.columns);return D=D.setSubMatrix(M,0,0),D=D.setSubMatrix(I,M.rows,0),D=D.setSubMatrix(S,0,M.columns),D=D.setSubMatrix(C,M.rows,M.columns),D.subMatrix(0,o-1,0,s-1)}var i=this.clone(),o=i.rows,s=i.columns,l=e.rows,a=e.columns;s!==l&&console.warn(`Multiplying ${o} x ${s} and ${l} x ${a} matrix: dimensions do not match.`);var d=h(o,l),r=h(s,a);return i=t(i,d,r),e=t(e,d,r),n(i,e,d,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n,o=this.constructor.empty(this.rows,this.columns),s=0;s<this.rows;s++)n=l.scale(this.getRow(s),{min:e,max:t}),o.setRow(s,n);return o}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n,o=this.constructor.empty(this.rows,this.columns),s=0;s<this.columns;s++)n=l.scale(this.getColumn(s),{min:e,max:t}),o.setColumn(s,n);return o}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var d=0;d<s;d++)r[n*a+c][s*i+d]=this.get(a,i)*e.get(c,d);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}sortRows(e){e===void 0&&(e=o);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=o);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){a.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;a.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n,o=a.checkIndices(this,e,t),s=new this.constructor[Symbol.species](e.length,t.length),r=0;r<o.row.length;r++){n=o.row[r];for(var i,l=0;l<o.column.length;l++)i=o.column[l],s[r][l]=this.get(n,i)}return s}trace(){for(var e=u(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return a.checkRowIndex(this,e),new d(this,e)}columnView(e){return a.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new x(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,n,i){return new g(this,e,t,n,i)}selectionView(e,t){return new m(this,e,t)}det(){if(this.isSquare()){var e,t,n,i;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),n=this.get(1,0),i=this.get(1,1),e*i-t*n;if(3===this.columns){var o,r,l;return o=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),l=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),n=this.get(0,2),e*o.det()-t*r.det()+n*l.det()}return new s(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=Number.EPSILON);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=M(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}f.prototype.klass='Matrix',f.random=f.rand,f.diagonal=f.diag,f.prototype.diagonal=f.prototype.diag,f.identity=f.eye,f.prototype.negate=f.prototype.neg,f.prototype.tensorProduct=f.prototype.kroneckerProduct,f.prototype.determinant=f.prototype.det;var y,i=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,w=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,v=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,D=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,z=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,R=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,V=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,L=D,E=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']];for(var P of E){var A=eval(k(i,{name:P[1],op:P[0]})),F=eval(k(w,{name:P[1]+'S',op:P[0]})),q=eval(k(b,{name:P[1]+'M',op:P[0]})),_=eval(k(v,{name:P[1]}));for(y=1;y<P.length;y++)f.prototype[P[y]]=A,f.prototype[P[y]+'S']=F,f.prototype[P[y]+'M']=q,f[P[y]]=_}var O=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){O.push(['Math.'+e,e])});for(var U of O){var N=eval(k(I,{name:U[1],method:U[0]})),T=eval(k(S,{name:U[1]}));for(y=1;y<U.length;y++)f.prototype[U[y]]=N,f[U[y]]=T}var W=[['Math.pow',1,'pow']];for(var X of W){var Y='arg0';for(y=1;y<X[1];y++)Y+=`, arg${y}`;if(1!==X[1]){var Z=eval(k(C,{name:X[2],method:X[0],args:Y})),B=eval(k(D,{name:X[2],args:Y}));for(y=2;y<X.length;y++)f.prototype[X[y]]=Z,f[X[y]]=B}else{var H={name:X[2],args:Y,method:X[0]},Q=eval(k(V,H)),K=eval(k(z,H)),J=eval(k(R,H)),G=eval(k(L,H));for(y=2;y<X.length;y++)f.prototype[X[y]]=Q,f.prototype[X[y]+'M']=J,f.prototype[X[y]+'S']=K,f[X[y]]=G}}return f}e.exports=o;var s=i(11),r=i(12),l=i(26),a=i(2),c=i(45),d=i(42),g=i(44),m=i(43),p=i(39),x=i(41),j=i(40)},function(e,t,n){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.Matrix.checkMatrix(e);var n,i,l,a,c,s,t,d,h,g,m=e.clone(),p=m.rows,x=m.columns,j=Array(p),k=1;for(n=0;n<p;n++)j[n]=n;for(h=Array(p),i=0;i<x;i++){for(n=0;n<p;n++)h[n]=m[n][i];for(n=0;n<p;n++){for(d=m[n],g=u(n,i),c=0,l=0;l<g;l++)c+=d[l]*h[l];d[i]=h[n]-=c}for(a=i,n=i+1;n<p;n++)M(h[n])>M(h[a])&&(a=n);if(a!==i){for(l=0;l<x;l++)s=m[a][l],m[a][l]=m[i][l],m[i][l]=s;t=j[a],j[a]=j[i],j[i]=t,k=-k}if(i<p&&0!==m[i][i])for(n=i+1;n<p;n++)m[n][i]/=m[i][i]}this.LU=m,this.pivotVector=j,this.pivotSign=k}var r=n(0);o.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,n=0;n<t;n++)if(0===e[n][n])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,n=e.columns,i=0;i<n;i++)t*=e[i][i];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,o=new r.Matrix(t,n),s=0;s<t;s++)for(var i=0;i<n;i++)o[s][i]=s>i?e[s][i]:s===i?1:0;return o},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,o=new r.Matrix(t,n),s=0;s<t;s++)for(var i=0;i<n;i++)o[s][i]=s<=i?e[s][i]:0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=r.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var o,i,s,l=e.columns,a=e.subMatrixRow(this.pivotVector,0,l-1),c=t.columns;for(s=0;s<c;s++)for(o=s+1;o<c;o++)for(i=0;i<l;i++)a[o][i]-=a[s][i]*t[o][s];for(s=c-1;0<=s;s--){for(i=0;i<l;i++)a[s][i]/=t[s][s];for(o=0;o<s;o++)for(i=0;i<l;i++)a[o][i]-=a[s][i]*t[o][s]}return a}},e.exports=o},function(e,t,n){'use strict';function o(x,y){if(!(this instanceof o))return new o(x,y);x=r.Matrix.checkMatrix(x),y=y||{};var w=x.rows,m=x.columns,n=u(w,m),I=!0,S=!0;!1===y.computeLeftSingularVectors&&(I=!1),!1===y.computeRightSingularVectors&&(S=!1);var C,a=!0===y.autoTranspose,D=!1;if(!(w<m))C=x.clone();else if(!a)C=x.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{C=x.transpose(),w=C.rows,m=C.columns,D=!0;var z=I;I=S,S=z}var R,i,j,k,p,L,E,f,P,A,F,q,_,O,N,T,W,X,b,c,Y,g=Array(u(w+1,m)),s=d(w,n,0),U=d(m,m,0),V=Array(m),e=Array(w),Z=u(w-1,m),B=h(0,u(m-2,w));for(j=0,A=h(Z,B);j<A;j++){if(j<Z){for(g[j]=0,R=j;R<w;R++)g[j]=l(g[j],C[R][j]);if(0!==g[j]){for(0>C[j][j]&&(g[j]=-g[j]),R=j;R<w;R++)C[R][j]/=g[j];C[j][j]+=1}g[j]=-g[j]}for(i=j+1;i<m;i++){if(j<Z&&0!==g[j]){for(p=0,R=j;R<w;R++)p+=C[R][j]*C[R][i];for(p=-p/C[j][j],R=j;R<w;R++)C[R][i]+=p*C[R][j]}V[i]=C[j][i]}if(I&&j<Z)for(R=j;R<w;R++)s[R][j]=C[R][j];if(j<B){for(V[j]=0,R=j+1;R<m;R++)V[j]=l(V[j],V[R]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),R=j+1;R<m;R++)V[R]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(R=j+1;R<w;R++)e[R]=0;for(i=j+1;i<m;i++)for(R=j+1;R<w;R++)e[R]+=V[i]*C[R][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],R=j+1;R<w;R++)C[R][i]+=p*e[R]}if(S)for(R=j+1;R<m;R++)U[R][j]=V[R]}}if(k=u(m,w+1),Z<m&&(g[Z]=C[Z][Z]),w<k&&(g[k-1]=0),B+1<k&&(V[B]=C[B][k-1]),V[k-1]=0,I){for(i=Z;i<n;i++){for(R=0;R<w;R++)s[R][i]=0;s[i][i]=1}for(j=Z-1;0<=j;j--)if(0!==g[j]){for(i=j+1;i<n;i++){for(p=0,R=j;R<w;R++)p+=s[R][j]*s[R][i];for(p=-p/s[j][j],R=j;R<w;R++)s[R][i]+=p*s[R][j]}for(R=j;R<w;R++)s[R][j]=-s[R][j];for(s[j][j]=1+s[j][j],R=0;R<j-1;R++)s[R][j]=0}else{for(R=0;R<w;R++)s[R][j]=0;s[j][j]=1}}if(S)for(j=m-1;0<=j;j--){if(j<B&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,R=j+1;R<m;R++)p+=U[R][j]*U[R][i];for(p=-p/U[j+1][j],R=j+1;R<m;R++)U[R][i]+=p*U[R][j]}for(R=0;R<m;R++)U[R][j]=0;U[j][j]=1}for(var H=k-1,Q=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(M(V[j])<=K*(M(g[j])+M(g[j+1]))){V[j]=0;break}if(j===k-2)F=4;else{for(L=k-1;L>=j&&L!==j;L--)if(p=(L===k?0:M(V[L]))+(L===j+1?0:M(V[L-1])),M(g[L])<=K*p){g[L]=0;break}L===j?F=3:L===k-1?F=1:(F=2,j=L)}switch(j++,F){case 1:{for(E=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(g[i],E),f=g[i]/p,P=E/p,g[i]=p,i!==j&&(E=-P*V[i-1],V[i-1]=f*V[i-1]),S)for(R=0;R<m;R++)p=f*U[R][i]+P*U[R][k-1],U[R][k-1]=-P*U[R][i]+f*U[R][k-1],U[R][i]=p;break}case 2:{for(E=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(g[i],E),f=g[i]/p,P=E/p,g[i]=p,E=-P*V[i],V[i]=f*V[i],I)for(R=0;R<w;R++)p=f*s[R][i]+P*s[R][j-1],s[R][j-1]=-P*s[R][i]+f*s[R][j-1],s[R][i]=p;break}case 3:{for(q=h(h(h(h(M(g[k-1]),M(g[k-2])),M(V[k-2])),M(g[j])),M(V[j])),_=g[k-1]/q,O=g[k-2]/q,N=V[k-2]/q,T=g[j]/q,W=V[j]/q,X=((O+_)*(O-_)+N*N)/2,b=_*N*(_*N),c=0,(0!==X||0!==b)&&(c=v(X*X+b),0>X&&(c=-c),c=b/(X+c)),E=(T+_)*(T-_)+c,Y=T*W,i=j;i<k-1;i++){if(p=l(E,Y),f=E/p,P=Y/p,i!==j&&(V[i-1]=p),E=f*g[i]+P*V[i],V[i]=f*V[i]-P*g[i],Y=P*g[i+1],g[i+1]=f*g[i+1],S)for(R=0;R<m;R++)p=f*U[R][i]+P*U[R][i+1],U[R][i+1]=-P*U[R][i]+f*U[R][i+1],U[R][i]=p;if(p=l(E,Y),f=E/p,P=Y/p,g[i]=p,E=f*V[i]+P*g[i+1],g[i+1]=-P*V[i]+f*g[i+1],Y=P*V[i+1],V[i+1]=f*V[i+1],I&&i<w-1)for(R=0;R<w;R++)p=f*s[R][i]+P*s[R][i+1],s[R][i+1]=-P*s[R][i]+f*s[R][i+1],s[R][i]=p}V[k-2]=E,++Q;break}case 4:{if(0>=g[j]&&(g[j]=0>g[j]?-g[j]:0,S))for(R=0;R<=H;R++)U[R][j]=-U[R][j];for(;j<H&&!(g[j]>=g[j+1]);){if(p=g[j],g[j]=g[j+1],g[j+1]=p,S&&j<m-1)for(R=0;R<m;R++)p=U[R][j+1],U[R][j+1]=U[R][j],U[R][j]=p;if(I&&j<w-1)for(R=0;R<w;R++)p=s[R][j+1],s[R][j+1]=s[R][j],s[R][j]=p;j++}Q=0,k--;break}}}if(D){var J=U;U=s,s=J}this.m=w,this.n=m,this.s=g,this.U=s,this.V=U}var r=n(0),i=n(4),l=i.hypotenuse,d=i.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[u(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=h(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*h(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n,i=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e);for(n=0;n<e;n++)o[n][n]=M(this.s[n])<=i?0:1/this.s[n];var s,l,a,c=this.U,d=this.rightSingularVectors,h=d.mmul(o),g=d.rows,u=c.length,m=r.Matrix.zeros(g,u);for(n=0;n<g;n++)for(s=0;s<u;s++){for(a=0,l=0;l<e;l++)a+=h[n][l]*c[s][l];m[n][s]=a}return m.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t,n,i=this.V,o=this.threshold,e=i.length,s=i[0].length,l=new r.Matrix(e,this.s.length);for(t=0;t<e;t++)for(n=0;n<s;n++)l[t][n]=M(this.s[n])>o?i[t][n]/this.s[n]:0;var a,c,d=this.U,h=d.length,g=d[0].length,u=new r.Matrix(e,h);for(t=0;t<e;t++)for(n=0;n<h;n++){for(c=0,a=0;a<g;a++)c+=l[t][a]*d[n][a];u[t][n]=c}return u}},e.exports=o},function(e,t,n){function o(e,t){for(var n in t)e=e.replace(new RegExp('%'+n+'%','g'),t[n]);return e}const s=n(29);class r{constructor(e,t,n={}){if(e instanceof r){const t=e;return void this._init(t.rows,t.columns,t.elements.clone(),t.threshold)}if(Array.isArray(e)){const r=e;e=r.length,n=t||{},t=r[0].length,this._init(e,t,new s(n),n.threshold);for(var o=0;o<e;o++)for(var i,l=0;l<t;l++)i=r[o][l],this.threshold&&M(i)<this.threshold&&(i=0),0!==i&&this.elements.set(o*t+l,r[o][l])}else this._init(e,t,new s(n),n.threshold)}_init(e,t,n,i){this.rows=e,this.columns=t,this.elements=n,this.threshold=i||0}static eye(e=1,t=e){const n=u(e,t),o=new r(e,t,{initialCapacity:n});for(var s=0;s<n;s++)o.set(s,s,1);return o}clone(){return new r(this)}to2DArray(){const e=Array(this.rows);for(var t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var n=0;n<this.columns;n++)e[t][n]=this.get(t,n)}return e}isSquare(){return this.rows===this.columns}isSymmetric(){if(!this.isSquare())return!1;var e=!0;return this.forEachNonZero((t,n,i)=>{return this.get(n,t)===i?i:(e=!1,!1)}),e}get cardinality(){return this.elements.size}get size(){return this.rows*this.columns}get(e,t){return this.elements.get(e*this.columns+t)}set(e,t,n){return this.threshold&&M(n)<this.threshold&&(n=0),0===n?this.elements.remove(e*this.columns+t):this.elements.set(e*this.columns+t,n),this}mmul(e){this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');const t=this.rows,n=e.columns,o=new r(t,n);return this.forEachNonZero((t,n,i)=>{return e.forEachNonZero((e,s,r)=>{return n===e&&o.set(t,s,o.get(t,s)+i*r),r}),i}),o}kroneckerProduct(e){const t=this.rows,i=this.columns,n=e.rows,o=e.columns,s=new r(t*n,i*o,{initialCapacity:this.cardinality*e.cardinality});return this.forEachNonZero((t,i,r)=>{return e.forEachNonZero((e,a,l)=>{return s.set(n*t+e,o*i+a,r*l),l}),r}),s}forEachNonZero(e){return this.elements.forEachPair((t,n)=>{const o=0|t/this.columns,i=t%this.columns;let s=e(o,i,n);return!1!==s&&(this.threshold&&M(s)<this.threshold&&(s=0),s!==n&&(0===s?this.elements.remove(t,!0):this.elements.set(t,s)),!0)}),this.elements.maybeShrinkCapacity(),this}getNonZeros(){const e=this.cardinality,t=Array(e),n=Array(e),o=Array(e);var s=0;return this.forEachNonZero((e,i,r)=>{return t[s]=e,n[s]=i,o[s]=r,s++,r}),{rows:t,columns:n,values:o}}setThreshold(e){return 0!==e&&e!==this.threshold&&(this.threshold=e,this.forEachNonZero((e,t,n)=>n)),this}}r.prototype.klass='Matrix',r.identity=r.eye,r.prototype.tensorProduct=r.prototype.kroneckerProduct,e.exports=r;var l=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,a=`
(function %name%S(value) {
    this.forEachNonZero((i, j, v) => v %op% value);
    return this;
})
`,c=`
(function %name%M(matrix) {
    matrix.forEachNonZero((i, j, v) => {
        this.set(i, j, this.get(i, j) %op% v);
        return v;
    });
    return this;
})
`,d=`
(function %name%(matrix, value) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%(value);
})
`,h=`
(function %name%() {
    this.forEachNonZero((i, j, v) => %method%(v));
    return this;
})
`,g=`
(function %name%(matrix) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%();
})
`,m=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']];for(var p of m)for(var x=1;x<p.length;x++)r.prototype[p[x]]=eval(o(l,{name:p[x],op:p[0]})),r.prototype[p[x]+'S']=eval(o(a,{name:p[x]+'S',op:p[0]})),r.prototype[p[x]+'M']=eval(o(c,{name:p[x]+'M',op:p[0]})),r[p[x]]=eval(o(d,{name:p[x]}));var i=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){i.push(['Math.'+e,e])});for(var j of i)for(var x=1;x<j.length;x++)r.prototype[j[x]]=eval(o(h,{name:j[x],method:j[0]})),r[j[x]]=eval(o(g,{name:j[x]}))},function(e,s){'use strict';function r(e,t){return e-t}s.sum=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},s.max=function(e){for(var t=e[0],n=e.length,o=1;o<n;o++)e[o]>t&&(t=e[o]);return t},s.min=function(e){for(var t=e[0],n=e.length,o=1;o<n;o++)e[o]<t&&(t=e[o]);return t},s.minMax=function(e){for(var t=e[0],n=e[0],o=e.length,s=1;s<o;s++)e[s]<t&&(t=e[s]),e[s]>n&&(n=e[s]);return{min:t,max:n}},s.arithmeticMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=e[o];return t/n},s.mean=s.arithmeticMean,s.geometricMean=function(e){for(var t=1,n=e.length,s=0;s<n;s++)t*=e[s];return o(t,1/n)},s.logMean=function(e){for(var n=0,o=e.length,s=0;s<o;s++)n+=t(e[s]);return n/o},s.grandMean=function(e,t){for(var o=0,s=0,n=e.length,r=0;r<n;r++)o+=t[r]*e[r],s+=t[r];return o/s},s.truncatedMean=function(e,t,o){o===void 0&&(o=!1),o||(e=[e].sort(r));for(var s=e.length,l=n(s*t),a=0,c=l;c<s-l;c++)a+=e[c];return a/(s-2*l)},s.harmonicMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++){if(0===e[o])throw new RangeError('value at index '+o+'is zero');t+=1/e[o]}return n/t},s.contraHarmonicMean=function(e){for(var t=0,n=0,o=e.length,s=0;s<o;s++)t+=e[s]*e[s],n+=e[s];if(0>n)throw new RangeError('sum of values is negative');return t/n},s.median=function(e,t){t===void 0&&(t=!1),t||(e=[e].sort(r));var i=e.length,o=n(i/2);return 0==i%2?0.5*(e[o-1]+e[o]):e[o]},s.variance=function(e,t){t===void 0&&(t=!0);for(var n,o=s.mean(e),r=0,a=e.length,l=0;l<a;l++)n=e[l]-o,r+=n*n;return t?r/(a-1):r/a},s.standardDeviation=function(e,t){return v(s.variance(e,t))},s.standardError=function(e){return s.standardDeviation(e)/v(e.length)},s.robustMeanAndStdev=function(e){var t=0,n=0,o=e.length,s=0;for(s=0;s<o;s++)t+=e[s];t/=o;var i=Array(o);for(s=0;s<o;s++)i[s]=M(e[s]-t);return i.sort(r),n=1==o%2?i[(o-1)/2]/0.6745:0.5*(i[o/2]+i[o/2-1])/0.6745,{mean:t,stdev:n}},s.quartiles=function(e,t){var n=Math.ceil;'undefined'==typeof t&&(t=!1),t||(e=[e].sort(r));var i=e.length/4,o=e[n(i)-1],l=s.median(e,!0),a=e[n(3*i)-1];return{q1:o,q2:l,q3:a}},s.pooledStandardDeviation=function(e,t){return v(s.pooledVariance(e,t))},s.pooledVariance=function(e,t){'undefined'==typeof t&&(t=!0);for(var n=0,o=0,r=e.length,l=0;l<r;l++){var i=e[l],a=s.variance(i);n+=(i.length-1)*a,o+=t?i.length-1:i.length}return n/o},s.mode=function(e){var t,n=e.length,i=Array(n);for(t=0;t<n;t++)i[t]=0;var o=Array(n),s=0;for(t=0;t<n;t++){var r=o.indexOf(e[t]);0<=r?i[r]++:(o[s]=e[t],i[s]=1,s++)}var l=0,a=0;for(t=0;t<s;t++)i[t]>l&&(l=i[t],a=t);return o[a]},s.covariance=function(e,t,n){'undefined'==typeof n&&(n=!0);var o=s.mean(e),r=s.mean(t);if(e.length!==t.length)throw'Vectors do not have the same dimensions';for(var a=0,c=e.length,l=0;l<c;l++){var i=e[l]-o,d=t[l]-r;a+=i*d}return n?a/(c-1):a/c},s.skewness=function(e,t){'undefined'==typeof t&&(t=!0);for(var n,r=s.mean(e),c=0,d=0,h=e.length,l=0;l<h;l++)n=e[l]-r,c+=n*n,d+=n*n*n;var i=c/h,u=d/h,m=u/o(i,3/2);if(t){var g=v(h*(h-1));return g/(h-2)*m}return m},s.kurtosis=function(e,t){'undefined'==typeof t&&(t=!0);for(var o,r=s.mean(e),l=e.length,n=0,a=0,c=0;c<l;c++)o=e[c]-r,n+=o*o,a+=o*o*o*o;var i=n/l,d=a/l;if(t){var h=n/(l-1),g=a/(h*h);return l*(l+1)/((l-1)*(l-2)*(l-3))*g-3*((l-1)*(l-1)/((l-2)*(l-3)))}return d/(i*i)-3},s.entropy=function(e,n){'undefined'==typeof n&&(n=0);for(var o=0,s=e.length,r=0;r<s;r++)o+=e[r]*t(e[r]+n);return-o},s.weightedMean=function(e,t){for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*t[s];return n},s.weightedStandardDeviation=function(e,t){return v(s.weightedVariance(e,t))},s.weightedVariance=function(e,t){for(var n=s.weightedMean(e,t),o=0,r=e.length,l=0,a=0,c=0;c<r;c++){var i=e[c]-n,d=t[c];o+=d*(i*i),a+=d,l+=d*d}return o*(a/(a*a-l))},s.center=function(e,t){'undefined'==typeof t&&(t=!1);var n=e;t||(n=[e]);for(var o=s.mean(n),r=n.length,l=0;l<r;l++)n[l]-=o},s.standardize=function(e,t,n){'undefined'==typeof t&&(t=s.standardDeviation(e)),'undefined'==typeof n&&(n=!1);for(var o=e.length,r=n?e:Array(o),l=0;l<o;l++)r[l]=e[l]/t;return r},s.cumulativeSum=function(e){var t=e.length,n=Array(t);n[0]=e[0];for(var o=1;o<t;o++)n[o]=n[o-1]+e[o];return n}},function(e,t,n){'use strict';t.array=n(14),t.matrix=n(47)},function(e,t,n){'use strict';function i(e){if('number'!=typeof e||o(e))throw new TypeError('Expected a number')}var o=n(48);t.asc=function(e,t){return i(e),i(t),e-t},t.desc=function(e,t){return i(e),i(t),t-e}},function(e,t,n){'use strict';var o=n(5),s=n(6),i=n(46),r=n(33);class l{constructor(e,t,n){this.chemicalShifts=e,this.couplingConstants=t,this.multiplicity=n,this.nSpins=e.length,this._initConnectivity(),this._initClusters()}static fromSpinusPrediction(e){for(var t,n=e.split('\n'),r=n.length-1,a=Array(r),c=Array(r),d={},h=o.zeros(r,r),g=0;g<r;g++)t=n[g].split('\t'),a[g]=+t[2],d[t[0]-1]=g,c[g]=+t[5];for(var u=0;u<r;u++){t=n[u].split('\t');var m=(t.length-4)/3;for(k=0;k<m;k++){var p=t[4+3*k]-1,x=d[p];h[u][x]=+t[6+3*k]}}for(var k=0;k<r;k++)for(var j=k;j<r;j++)h[k][j]=h[j][k];return new l(a,h,s(r,2))}static fromPrediction(e){var t,n,i,s=l.ungroupAtoms(e),r=s.length,a=Array(r),c=o.zeros(r,r),d=Array(r),h={};for(t=0;t<r;t++)a[t]=s[t].delta,h[s[t].atomIDs[0]]=t;for(t=0;t<r;t++){for(a[t]=s[t].delta,i=s[t].j,n=0;n<i.length;n++)c[h[s[t].atomIDs[0]]][h[i[n].assignment]]=i[n].coupling,c[h[i[n].assignment]][h[s[t].atomIDs[0]]]=i[n].coupling;d[t]=s[t].integral+1}return new l(a,c,d)}static ungroupAtoms(e){var t=[];return e.forEach((e)=>{for(var n,o=e.atomIDs,s=0;s<o.length;s++)n=JSON.parse(JSON.stringify(e)),n.atomIDs=[o[s]],n.integral=1,t.push(n)}),t}_initClusters(){this.clusters=i(this.connectivity,{out:'indexes'})}_initConnectivity(){for(var e=this.couplingConstants,t=o.ones(e.length,e.length),n=0;n<e.length;n++)for(var i=n;i<e[n].length;i++)0===e[n][i]&&(t[n][i]=0,t[i][n]=0);this.connectivity=t}_calculateBetas(e,t){var n,i,s=o.zeros(e.length,e.length);for(n=0;n<e.rows;n++)for(i=n;i<e.columns;i++)0==this.chemicalShifts[n]-this.chemicalShifts[i]?n!==i&&0===e[n][i]&&(s[n][i]=1,s[i][n]=1):(s[n][i]=1-M(e[n][i]/((this.chemicalShifts[n]-this.chemicalShifts[i])*t)),s[i][n]=s[n][i]);return s}ensureClusterSize(e){var t=this._calculateBetas(this.couplingConstants,e.frequency||400),n=r.agnes(t,{isDistanceMatrix:!0}),o=[];this._splitCluster(n,o,e.maxClusterSize||8,!1);var s=this._mergeClusters(o);this.nClusters=s.length,this.clusters=Array(s.length);for(var l=0;l<this.nClusters;l++){this.clusters[l]=[];for(var a=0;a<this.nSpins;a++)0!==s[l][a]&&(0>s[l][a]?this.clusters[l].push(-(a+1)):this.clusters[l].push(a))}}_splitCluster(e,t,n,o){if(!o&&e.index.length<=n)t.push(this._getMembers(e));else{var s,r=!0,l=!1;try{for(var a,c,d=e.children[Symbol.iterator]();!(r=(a=d.next()).done);r=!0)if(c=a.value,!isNaN(c.index)||c.index.length<=n){for(var h=this._getMembers(c),g=0,u=0;u<this.nSpins;u++)if(1===h[u]){g++;for(var i=0;i<this.nSpins;i++)1===this.connectivity[u][i]&&0===h[i]&&(h[i]=-1,g++)}g<=n?t.push(h):isNaN(c.index)?this._splitCluster(c,t,n,!0):(h[c.index]=2,t.push(h))}else this._splitCluster(c,t,n,!1)}catch(e){l=!0,s=e}finally{try{!r&&d.return&&d.return()}finally{if(l)throw s}}}}_getMembers(e){for(var t=Array(this.nSpins),n=0;n<this.nSpins;n++)t[n]=0;if(!isNaN(e.index))t[1*e.index]=1;else{var i,o=!0,s=!1;try{for(var r,l,a=e.index[Symbol.iterator]();!(o=(r=a.next()).done);o=!0)l=r.value,t[1*l.index]=1}catch(e){s=!0,i=e}finally{try{!o&&a.return&&a.return()}finally{if(s)throw i}}}return t}_mergeClusters(e){var t,n,o,i,s,r,l,a=0;for(o=e.length-1;0<=o;o--){for(t=e[o],a=t.length,s=0;s<a&&-1!==t[s++];);if(s<a)for(i=e.length-1;i>=o+1;i--){for(n=e[i],s=0,r=0,l=0;s<a;)-1==t[s]*n[s]&&r++,(0!==t[s]||0!==n[s])&&l++,s++;if(0<r&&l<=this.maxClusterSize){for(s=0;s<a;)1===n[s]?t[s]=1:-1===n[s]&&1!==t[s]&&(t[s]=-1),s++;e.splice(i,1),i++}}}return e}}e.exports=l},function(t,n,i){'use strict';function o(e,t,n,o,s,r,l){for(var a=0|r*(-t-o)/(s-o),c=l.length,d=0,h=0,g=a-c/2;g<a+c/2;g++)d=0|g,0<=g&&g<r&&(e[d]+=l[h]*n),h++}function s(e,t){e.forEachNonZero((e,n,i)=>{return e>n?0:M(i)<=t?0:i})}function r(e,t,o,s,r){for(var l=1,a=0;a<r.length;a++)l*=o[r[a]];for(var i=new c(l,l),d=0;d<r.length;d++){for(var h=r[d],n=m(o[h]),g=void 0,u=void 0,p=1,x=0;x<d;x++)p*=o[r[x]];g=c.eye(p),p=1;for(var j=d+1;j<r.length;j++)p*=o[r[j]];u=c.eye(p);var f=e[h],y=g.kroneckerProduct(n.z).kroneckerProduct(u);i.add(y.mul(f));for(var w,k=0;k<r.length;k++)if(w=r[k],1===s[h][w]){for(var b=m(o[w]),v=void 0,M=void 0,I=1,S=0;S<k;S++)I*=o[r[S]];v=c.eye(I),I=1;for(var C=k+1;C<r.length;C++)I*=o[r[C]];M=c.eye(I);var D=g.kroneckerProduct(n.x).kroneckerProduct(u).mmul(v.kroneckerProduct(b.x).kroneckerProduct(M));D.add(g.kroneckerProduct(n.y).kroneckerProduct(u).mul(-1).mmul(v.kroneckerProduct(b.y).kroneckerProduct(M))),D.add(g.kroneckerProduct(n.z).kroneckerProduct(u).mmul(v.kroneckerProduct(b.z).kroneckerProduct(M))),i.add(D.mul(t[h][w]/2))}}return i}function l(e,t,n){for(var o=Array(n),s=0;s<n;s++)o[s]=e+s*((t-e)/(n-1));return o}var a=i(5),c=i(13),d=i(7),h=i(16).asc,g=i(6),m=i(21),p=0.01;t.exports=function(t,x){var k,i,j=x.frequency||400,f=(x.from||0)*j,y=(x.to||10)*j,w=x.lineWidth||1,v=x.nbPoints||1024,I=x.maxClusterSize||10,S=x.output||'y',C=t.chemicalShifts.slice();for(k=0;k<C.length;k++)C[k]*=j;var D=v*w/M(y-f)/2.355,z=20*D,R=0|z,V=Array(R),L=z/2;for(k=0;k<R;k++)V[k]=1e12*e(-((k-L)*(k-L))/(2*(D*D)));for(var b=new g(v,0),E=t.multiplicity,P=function(){var e=t.clusters[F];for(q=Array(e.length),k=0;k<e.length;k++)q[k]=0>e[k]?-e[k]-1:e[k];_=1,O=0;var n=[],l=[];if(e.length>I){for(A=0;0>e[A++];);for(A=e[A-1],n.push(-C[A]),k=0;k<e.length;k++)if(0>e[k])for(N=t.couplingConstants[A][q[k]]/2,U=n.length,i=0;i<U;i++)n.push(n[i]+N),n[i]-=N;for(n.sort(h),O=n.length,_=1,k=0;k<O;k++)l.push(1)}else{var g=r(C,t.couplingConstants,E,t.connectivity,q),x=g.rows,j=new a.DC.EVD(g),S=j.eigenvectorMatrix,D=j.realEigenvalues,z=new c(x,x),R=e.length;for(_=0,T=0;T<R;T++){var P=m(E[q[T]]),L=1;for(i=0;i<T;i++)L*=E[q[i]];var W=c.eye(L);for(L=1,i=T+1;i<R;i++)L*=E[q[i]];var X=c.eye(L),Y=W.kroneckerProduct(P.m).kroneckerProduct(X);0<=e[T]?(z.add(Y.mul(e[T]+1)),_++):z.add(Y.mul(e[T]))}var Z=a.zeros(x,x);z.forEachNonZero((e,t,n)=>{if(0<n)for(var i=S[t],o=0;o<i.length;o++)0!==i[o]&&Z.set(e,o,Z.get(e,o)+i[o]);return n});var B=Z.clone();z.forEachNonZero((e,t,n)=>{if(0>n)for(var i=S[t],o=0;o<i.length;o++)0!==i[o]&&B.set(e,o,B.get(e,o)+i[o]);return n});var H=S.transpose();Z=H.mmul(Z),Z=new c(Z,{threshold:p}),s(Z,p),B=H.mmul(B),B=new c(B,{threshold:p}),s(B,p),B.forEachNonZero((e,t,i)=>{var o=Z.get(e,t);o=u(M(o),M(i)),o*=o,O+=o;var s=D[e]-D[t],r=d(n,s,h);0>r?(n.splice(-1-r,0,s),l.splice(-1-r,0,o)):l[r]+=o})}var Q=n.length;if(0<Q){_/=O;var K=n[0],J=l[0],G=1;for(k=1;k<Q;k++)M(n[k]-K/G)<w/32?(J+=l[k],K+=n[k],G++):(o(b,K/G,J*_,f,y,v,V),K=n[k],J=l[k],G=1);o(b,K/G,J*_,f,y,v,V)}},F=0;F<t.clusters.length;F++){var q,_,O,A,U,N,T;P()}if('xy'===S)return{x:l(x.from,x.to,v),y:b};if('y'===S)return b;throw new RangeError('wrong output option')}},function(t,n,i){'use strict';function s(e,t,n,i){return((e-t)*i-1)/(n-t)}function r(t,n){for(var s=Math.round,r=4,l=h(0,s(n.x-n.widthX*r)),a=u(t[0].length-1,s(n.x+n.widthX*r)),c=h(0,s(n.y-n.widthY*r)),d=u(t.length-1,s(n.y+n.widthY*r)),g=n.widthX*n.widthX,m=n.widthY*n.widthY,p=c;p<d;p++)for(var x=l;x<a;x++){var i=o(n.x-x,2)/g+o(n.y-p,2)/m,j=1e4*n.z*e(-i);t[p][x]+=j}}var l=i(5),a={H:{frequency:400,lineWidth:10},C:{frequency:100,lineWidth:10}};t.exports=function(e,t){var n,i=e[0].fromAtomLabel,o=e[0].toLabel,c=t.frequencyX||a[i].frequency,d=t.frequencyY||a[o].frequency,g=t.lineWidthX||a[i].lineWidth,m=t.lineWidthY||a[o].lineWidth,p=e[0].fromChemicalShift,x=e[0].fromChemicalShift,j=e[0].toChemicalShift,k=e[0].toChemicalShift;for(n=1;n<e.length;)p=u(p,e[n].fromChemicalShift),x=h(x,e[n].fromChemicalShift),j=u(j,e[n].toChemicalShift),k=h(k,e[n].toChemicalShift),n++;null===t.firstX||isNaN(t.firstX)||(p=t.firstX),null===t.firstY||isNaN(t.firstY)||(j=t.firstY),null===t.lastX||isNaN(t.lastX)||(x=t.lastX),null===t.lastY||isNaN(t.lastY)||(k=t.lastY);var f=t.nbPointsX||512,y=t.nbPointsY||512,w=new l(y,f).fill(0);for(n=0;n<e.length;){var b={x:s(e[n].fromChemicalShift,p,x,f),y:s(e[n].toChemicalShift,j,k,y),z:e[n].fromAtoms.length+e[n].toAtoms.length,widthX:s(g/c+p,p,x,f),widthY:s(m/d+j,j,k,y)};r(w,b),n++}return w}},function(e,t,n){'use strict';t.SpinSystem=n(17),t.simulate1D=n(18),t.simulate2D=n(19)},function(e,t,n){'use strict';function i(e){for(var t=(e-1)/2,n=Array(e),s=Array(e),r=0;r<e;r++)n[r]=e-1-r-t,s[r]=v(t*(t+1)-n[r]*(n[r]+1));var i=o(s,1,e,e);for(r=0;r<e;r++)s[r]=v(t*(t+1)-n[r]*(n[r]-1));var l=o(s,-1,e,e),a=i.clone().add(l).mul(0.5),c=l.clone().mul(-1).add(i).mul(-0.5),d=o(n,0,e,e);return{x:a,y:c,z:d,m:l,p:i}}function o(e,t,o,n){for(var r=new s(o,n,{initialCapacity:20}),l=0;l<e.length;l++)0<=l-t&&l-t<o&&l<n&&r.set(l-t,l,e[l]);return r}var s=n(13),r=i(2);e.exports=function(e){return 2===e?r:i(e)}},function(e,t,n){e.exports=n(23)},function(e,t){var i,o,s;(function(){var r,l,c,a,d,h,g,m,p,x,j,k,f,y,w;c=n,x=u,l=function(e,t){return e<t?-1:e>t?1:0},p=function(e,t,n,i,o){var s;if(null==n&&(n=0),null==o&&(o=l),0>n)throw new Error('lo must be non-negative');for(null==i&&(i=e.length);n<i;)s=c((n+i)/2),0>o(t,e[s])?i=s:n=s+1;return[].splice.apply(e,[n,n-n,t]),t},h=function(e,t,n){return null==n&&(n=l),e.push(t),y(e,0,e.length-1,n)},d=function(e,t){var n,i;return null==t&&(t=l),n=e.pop(),e.length?(i=e[0],e[0]=n,w(e,0,t)):i=n,i},m=function(e,t,n){var i;return null==n&&(n=l),i=e[0],e[0]=t,w(e,0,n),i},g=function(e,t,n){var i;return null==n&&(n=l),e.length&&0>n(e[0],t)&&(i=[e[0],t],t=i[0],e[0]=i[1],w(e,0,n)),t},a=function(e,t){var n,i,o,s,r,a;for(null==t&&(t=l),s=function(){a=[];for(var t=0,n=c(e.length/2);0<=n?t<n:t>n;0<=n?t++:t--)a.push(t);return a}.apply(this).reverse(),r=[],(i=0,o=s.length);i<o;i++)n=s[i],r.push(w(e,n,t));return r},f=function(e,t,n){var i;if(null==n&&(n=l),i=e.indexOf(t),-1!==i)return y(e,0,i,n),w(e,i,n)},j=function(e,t,n){var i,o,s,r,c;if(null==n&&(n=l),o=e.slice(0,t),!o.length)return o;for(a(o,n),c=e.slice(t),(s=0,r=c.length);s<r;s++)i=c[s],g(o,i,n);return o.sort(n).reverse()},k=function(e,t,n){var o,s,i,r,c,h,g,u,m,j;if(null==n&&(n=l),10*t<=e.length){if(r=e.slice(0,t).sort(n),!r.length)return r;for(i=r[r.length-1],u=e.slice(t),(c=0,g=u.length);c<g;c++)o=u[c],0>n(o,i)&&(p(r,o,0,null,n),r.pop(),i=r[r.length-1]);return r}for(a(e,n),j=[],(s=h=0,m=x(t,e.length));0<=m?h<m:h>m;s=0<=m?++h:--h)j.push(d(e,n));return j},y=function(e,t,n,i){var o,s,r;for(null==i&&(i=l),o=e[n];n>t;){if(r=n-1>>1,s=e[r],0>i(o,s)){e[n]=s,n=r;continue}break}return e[n]=o},w=function(e,t,n){var i,o,s,r,a;for(null==n&&(n=l),o=e.length,a=t,s=e[t],i=2*t+1;i<o;)r=i+1,r<o&&!(0>n(e[i],e[r]))&&(i=r),e[t]=e[i],t=i,i=2*t+1;return e[t]=s,y(e,a,t,n)},r=function(){function e(e){this.cmp=null==e?l:e,this.nodes=[]}return e.push=h,e.pop=d,e.replace=m,e.pushpop=g,e.heapify=a,e.updateItem=f,e.nlargest=j,e.nsmallest=k,e.prototype.push=function(e){return h(this.nodes,e,this.cmp)},e.prototype.pop=function(){return d(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return m(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return g(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return a(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return f(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),function(n,r){return o=[],i=r,s='function'==typeof i?i.apply(t,o):i,!(void 0!==s&&(e.exports=s))}(this,function(){return r})}).call(this)},function(e,t,i){'use strict';function o(e){for(var t=Array(e[0].length),n=0;n<t.length;++n)t[n]=Array(e.length);for(n=0;n<e.length;++n)for(var i=0;i<e[0].length;++i)t[i][n]=e[n][i];return t}const s=i(15).array;e.exports={coordArrayToPoints:function(e,t){if(0!=e.length%t)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var n,o=e.length/t,s=Array(o),r=0,l=0;l<e.length;l+=t){n=Array(t);for(var i=0;i<t;++i)n[i]=e[l+i];s[r]=n,r++}return s},coordArrayToCoordMatrix:function(e,t){if(0!=e.length%t)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var o=Array(t),s=e.length/t,r=0;r<o.length;r++)o[r]=Array(s);for(r=0;r<e.length;r+=t)for(var i,l=0;l<t;++l)i=n(r/t),o[l][i]=e[r+l];return o},coordMatrixToCoordArray:function(e){for(var t=Array(e.length*e[0].length),n=0,o=0;o<e[0].length;++o)for(var i=0;i<e.length;++i)t[n]=e[i][o],++n;return t},coordMatrixToPoints:o,pointsToCoordArray:function(e){for(var t=Array(e.length*e[0].length),n=0,o=0;o<e.length;++o)for(var i=0;i<e[0].length;++i)t[n]=e[o][i],++n;return t},pointsToCoordMatrix:o,applyDotProduct:function(e,t){var n,o;e.length<=t.length?(o=e,n=t):(o=t,n=e);for(var s,r=n.length-o.length+1,l=Array(r),a=0;a<r;++a){s=0;for(var i=0;i<o.length;++i)s+=o[i]*n[a+i];l[a]=s}return l},scale:function(e,t){var n=t.inPlace?e:Array(e.length);const o=t.max,r=t.min;if('number'==typeof o){if('number'==typeof r)for(var l=s.minMax(e),a=(o-r)/(l.max-l.min),c=0;c<n.length;c++)n[c]=(e[c]-l.min)*a+r;else for(var i=s.max(e),a=o/i,c=0;c<n.length;c++)n[c]=e[c]*a;}else if('number'==typeof r)for(var i=s.min(e),a=r/i,c=0;c<n.length;c++)n[c]=e[c]*a;return n}}},function(e,t){'use strict';function n(e,t,n,s,r){function l(e,t,n,i){return(i-t)/(n-e)}var a=e.length,c=(s-n)/(r-1),d=n-c/2,h=Array(r),g=e[1]-e[0],u=e[e.length-1]-e[e.length-2],m=d,p=d+c,x=Number.MIN_VALUE,k=0,f=e[0]-g,y=0,w=0,b=0,v=0,M=0,I=0,S=0,i=0;main:for(;;){for(;0<=f-p;){var j=o(0,p-x,b,k);if(I=w+j,h[i]=(I-M)/c,i++,i===r)break main;m=p,p+=c,M=I}x<=m&&m<=f&&(j=o(0,m-x,b,k),M=w+j),w+=o(x,f,b,v),x=f,k=y,S<a?(f=e[S],y=t[S],S++):S===a&&(f+=u,y=0),b=l(x,k,f,y),v=-b*x+k}return h}function i(e,t,n,o,s){var r=Number.MAX_VALUE,l=e.length,a=(o-n)/(s-1),c=e[e.length-1]-e[e.length-2],d=n-a/2,h=Array(s),g=d,u=d+a,m=-r,p=0,x=e[0],k=t[0],f=0,y=!0,w=0,b=0,v=1,i=0;main:for(;;){if(m>=x)throw new Error('x must be an increasing serie');for(;0<m-u;){if(y&&(b++,y=!1),h[i]=0>=b?0:w/b,i++,i===s)break main;g=u,u+=a,w=0,b=0}m>g&&(w+=p,b++),(m==-r||1<f)&&b--,m=x,p=k,v<l?(x=e[v],k=t[v],v++):(x+=c,k=0,f++)}return h}function o(e,t,n,i){return 0.5*n*t*t+i*t-(0.5*n*e*e+i*e)}t.getEquallySpacedData=function(e,t,o){1<e.length&&e[0]>e[1]&&(e=e.slice().reverse(),t=t.slice().reverse());var s=e.length;if(s!==t.length)throw new RangeError('the x and y vector doesn\'t have the same size.');o===void 0&&(o={});var r=o.from===void 0?e[0]:o.from;if(isNaN(r)||!isFinite(r))throw new RangeError('\'From\' value must be a number');var l=o.to===void 0?e[e.length-1]:o.to;if(isNaN(l)||!isFinite(l))throw new RangeError('\'To\' value must be a number');var a=r>l;if(a){var c=r;r=l,l=c}var d=o.numberOfPoints===void 0?100:o.numberOfPoints;if(isNaN(d)||!isFinite(d))throw new RangeError('\'Number of points\' value must be a number');if(1>d)throw new RangeError('the number of point must be higher than 1');var h='slot'===o.variant?'slot':'smooth',g='slot'==h?i(e,t,r,l,d):n(e,t,r,l,d);return a?g.reverse():g},t.integral=o},function(e,t,n){e.exports=t=n(24),t.getEquallySpacedData=n(25).getEquallySpacedData,t.SNV=n(27).SNV},function(e,t,n){'use strict';t.SNV=function(e){for(var t=o.mean(e),n=o.standardDeviation(e),s=e.slice(),r=0;r<e.length;r++)s[r]=(s[r]-t)/n;return s};var o=n(15).array},function(e){'use strict';e.exports=function(e,t){const n=e.length;let o=Array.from({length:n}).map(()=>Array.from({length:n}));for(let s=0;s<n;s++)for(let n=0;n<=s;n++)o[s][n]=t(e[s],e[n]);for(let s=0;s<n;s++)for(let e=s+1;e<n;e++)o[s][e]=o[e][s];return o}},function(e,t,n){'use strict';function o(e,t){return 0|e*t}function s(e,t){return u(e-2,0|e*t)}function i(e,t,n){return c(h(e+1,0|4*e/(3*t+n)))}function r(e,t,n){return c(h(e+1,0|4*e/(t+3*n)))}const l=n(6),a=n(30),c=a.nextPrime,d=a.largestPrime,g=0,m=1,p=2;class x{constructor(e={}){if(e instanceof x)return this.table=e.table.slice(),this.values=e.values.slice(),this.state=e.state.slice(),this.minLoadFactor=e.minLoadFactor,this.maxLoadFactor=e.maxLoadFactor,this.distinct=e.distinct,this.freeEntries=e.freeEntries,this.lowWaterMark=e.lowWaterMark,void(this.highWaterMark=e.maxLoadFactor);const t=e.initialCapacity===void 0?150:e.initialCapacity;if(0>t)throw new RangeError(`initial capacity must not be less than zero: ${t}`);const n=e.minLoadFactor===void 0?1/6:e.minLoadFactor,i=e.maxLoadFactor===void 0?2/3:e.maxLoadFactor;if(0>n||1<=n)throw new RangeError(`invalid minLoadFactor: ${n}`);if(0>=i||1<=i)throw new RangeError(`invalid maxLoadFactor: ${i}`);if(n>=i)throw new RangeError(`minLoadFactor (${n}) must be smaller than maxLoadFactor (${i})`);let o=t;o=0|o/i,o=c(o),0===o&&(o=1),this.table=l(o,0),this.values=l(o,0),this.state=l(o,0),this.minLoadFactor=n,this.maxLoadFactor=o===d?1:i,this.distinct=0,this.freeEntries=o,this.lowWaterMark=0,this.highWaterMark=s(o,this.maxLoadFactor)}clone(){return new x(this)}get size(){return this.distinct}get(e){const t=this.indexOfKey(e);return 0>t?0:this.values[t]}set(e,t){let n=this.indexOfInsertion(e);if(0>n)return n=-n-1,this.values[n]=t,!1;if(this.distinct>this.highWaterMark){const n=i(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);return this.rehash(n),this.set(e,t)}if(this.table[n]=e,this.values[n]=t,this.state[n]===g&&this.freeEntries--,this.state[n]=m,this.distinct++,1>this.freeEntries){const e=i(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);this.rehash(e)}return!0}remove(e,t){const n=this.indexOfKey(e);return!(0>n)&&(this.state[n]=p,this.distinct--,t||this.maybeShrinkCapacity(),!0)}delete(e,t){const n=this.indexOfKey(e);return!(0>n)&&(this.state[n]=g,this.distinct--,t||this.maybeShrinkCapacity(),!0)}maybeShrinkCapacity(){if(this.distinct<this.lowWaterMark){const e=r(this.distinct,this.minLoadFactor,this.maxLoadFactor);this.rehash(e)}}containsKey(e){return 0<=this.indexOfKey(e)}indexOfKey(e){const t=this.table,n=this.state,o=this.table.length,s=2147483647&e;let r=s%o,i=s%(o-2);for(0==i&&(i=1);n[r]!==g&&(n[r]===p||t[r]!==e);)r-=i,0>r&&(r+=o);return n[r]===g?-1:r}containsValue(e){return 0<=this.indexOfValue(e)}indexOfValue(e){const t=this.values,n=this.state;for(var o=0;o<n.length;o++)if(n[o]===m&&t[o]===e)return o;return-1}indexOfInsertion(e){const t=this.table,n=this.state,o=t.length,s=2147483647&e;let r=s%o,l=s%(o-2);for(0==l&&(l=1);n[r]===m&&t[r]!==e;)r-=l,0>r&&(r+=o);if(n[r]===p){const i=r;for(;n[r]!==g&&(n[r]===p||t[r]!==e);)r-=l,0>r&&(r+=o);n[r]===g&&(r=i)}return n[r]===m?-r-1:r}ensureCapacity(e){if(this.table.length<e){const t=c(e);this.rehash(t)}}rehash(e){const t=this.table.length;if(e<=this.distinct)throw new Error('Unexpected');const n=this.table,r=this.values,a=this.state,c=l(e,0),d=l(e,0),h=l(e,0);this.lowWaterMark=o(e,this.minLoadFactor),this.highWaterMark=s(e,this.maxLoadFactor),this.table=c,this.values=d,this.state=h,this.freeEntries=e-this.distinct;for(var g=0;g<t;g++)if(a[g]===m){var i=n[g],u=this.indexOfInsertion(i);c[u]=i,d[u]=r[g],h[u]=m}}forEachKey(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===m&&!e(this.table[t]))return!1;return!0}forEachValue(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===m&&!e(this.values[t]))return!1;return!0}forEachPair(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===m&&!e(this.table[t],this.values[t]))return!1;return!0}}e.exports=x},function(e,t,n){const i=n(7),o=n(16).asc,s=2147483647,r=[s,5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939,210719881,421439783,842879579,1685759167,433,877,1759,3527,7057,14143,28289,56591,113189,226379,452759,905551,1811107,3622219,7244441,14488931,28977863,57955739,115911563,231823147,463646329,927292699,1854585413,953,1907,3821,7643,15287,30577,61169,122347,244703,489407,978821,1957651,3915341,7830701,15661423,31322867,62645741,125291483,250582987,501165979,1002331963,2004663929,1039,2081,4177,8363,16729,33461,66923,133853,267713,535481,1070981,2141977,4283963,8567929,17135863,34271747,68543509,137087021,274174111,548348231,1096696463,31,67,137,277,557,1117,2237,4481,8963,17929,35863,71741,143483,286973,573953,1147921,2295859,4591721,9183457,18366923,36733847,73467739,146935499,293871013,587742049,1175484103,599,1201,2411,4831,9677,19373,38747,77509,155027,310081,620171,1240361,2480729,4961459,9922933,19845871,39691759,79383533,158767069,317534141,635068283,1270136683,311,631,1277,2557,5119,10243,20507,41017,82037,164089,328213,656429,1312867,2625761,5251529,10503061,21006137,42012281,84024581,168049163,336098327,672196673,1344393353,3,7,17,37,79,163,331,673,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,43,89,179,359,719,1439,2879,5779,11579,23159,46327,92657,185323,370661,741337,1482707,2965421,5930887,11861791,23723597,47447201,94894427,189788857,379577741,759155483,1518310967,379,761,1523,3049,6101,12203,24407,48817,97649,195311,390647,781301,1562611,3125257,6250537,12501169,25002389,50004791,100009607,200019221,400038451,800076929,1600153859,13,29,59,127,257,521,1049,2099,4201,8419,16843,33703,67409,134837,269683,539389,1078787,2157587,4315183,8630387,17260781,34521589,69043189,138086407,276172823,552345671,1104691373,19,41,83,167,337,677,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,53,107,223,449,907,1823,3659,7321,14653,29311,58631,117269,234539,469099,938207,1876417,3752839,7505681,15011389,30022781,60045577,120091177,240182359,480364727,960729461,1921458943];r.sort(o),t.nextPrime=function(e){let t=i(r,e,o);return 0>t&&(t=~t),r[t]},t.largestPrime=s},function(e,t,i){'use strict';function o(e,t,n){for(var o=1e101,s=0;s<e.length;s++)for(var i,r=0;r<t.length;r++)i=n[e[s]][t[r]],o=u(i,o);return o}function s(e,t,n){for(var o=-1,s=0;s<e.length;s++)for(var i,r=0;r<t.length;r++)i=n[e[s]][t[r]],o=h(i,o);return o}function r(e,t,n){for(var o=0,s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o+=n[e[s]][t[i]];return o/(e.length*t.length)}function l(e,t,n){for(var o=Array(e.length*t.length),s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o[s*t.length+i]=n[e[s]][t[i]];return d(o)}function a(e,t,n){return l(e,t,n)*e.length*t.length/(e.length+t.length)}function c(e,t){return e-t}function d(e,t){t===void 0&&(t=!1),t||(e=[e].sort(c));var i=e.length,o=n(i/2);return 0==i%2?0.5*(e[o-1]+e[o]):e[o]}const g=i(8),m=i(9),p=i(3),x=i(28);var y={disFunc:g,kind:'single',isDistanceMatrix:!1};e.exports=function(t,n){n=Object.assign({},y,n);var c=t.length,h=t;if(n.isDistanceMatrix||(h=x(t,n.disFunc)),'string'==typeof n.kind)switch(n.kind){case'single':n.kind=o;break;case'complete':n.kind=s;break;case'average':n.kind=r;break;case'centroid':n.kind=l;break;case'ward':n.kind=a;break;default:throw new RangeError('Unknown kind of similarity');}else if('function'!=typeof n.kind)throw new TypeError('Undefined kind of similarity');for(var g=Array(c),w=0;w<h.length;w++)g[w]=new m(w);for(var i=1e6,b={},d=0;1<g.length;){b={},i=1e6;for(var v=0;v<g.length;v++)for(var j=v+1;j<g.length;j++){var k,M;if(g[v]instanceof m)k=[g[v].index];else{k=Array(g[v].index.length);for(var I=0;I<k.length;I++)k[I]=g[v].index[I].index}if(g[j]instanceof m)M=[g[j].index];else{M=Array(g[j].index.length);for(var e=0;e<M.length;e++)M[e]=g[j].index[e].index}d=n.kind(k,M,h).toFixed(4),d in b?b[d].push([g[v],g[j]]):b[d]=[[g[v],g[j]]],i=u(d,i)}for(var f,S=b[i.toFixed(4)],C=Array(S.length),D=0;0<S.length;){f=S.shift();for(var z,R=0;R<S.length;R++)if(z=S[R].filter(function(e){return-1!==f.indexOf(e)}),0<z.length){var V=S[R].filter(function(e){return-1===f.indexOf(e)});f=f.concat(V),S.splice(R--,1)}C[D++]=f}C.length=D;for(var L,E=0;E<C.length;E++){L=new p,L.children=C[E].concat(),L.distance=i,L.index=Array(c);for(var P=0,A=0;A<C[E].length;A++)C[E][A]instanceof m?L.index[P++]=C[E][A]:(P+=C[E][A].index.length,L.index=C[E][A].index.concat(L.index)),g.splice(g.indexOf(C[E][A]),1);L.index.length=P,g.push(L)}}return g[0]}},function(e,t,n){'use strict';function i(e,t,n){for(var o=1e101,s=0;s<e.length;s++)for(var i,r=s;r<t.length;r++)i=n(e[s],t[r]),o=u(i,o);return o}function o(e,t,n){for(var o=-1,s=0;s<e.length;s++)for(var i,r=s;r<t.length;r++)i=n(e[s],t[r]),o=h(i,o);return o}function s(e,t,n){for(var o=0,s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o+=n(e[s],t[i]);return o/(e.length*t.length)}function r(e,t,n){for(var o=0,s=0,r=0,l=0,a=0;a<e.length;a++)o+=e[a][0],s+=e[a][1];for(var i=0;i<t.length;i++)r+=t[i][0],l+=t[i][1];return o/=e.length,s/=e.length,r/=t.length,l/=t.length,n([o,s],[r,l])}function l(e,t,n){for(var o=0,s=0,r=0,l=0,a=0;a<e.length;a++)o+=e[a][0],s+=e[a][1];for(var i=0;i<t.length;i++)r+=t[i][0],l+=t[i][1];return o/=e.length,s/=e.length,r/=t.length,l/=t.length,n([o,s],[r,l])*e.length*t.length/(e.length+t.length)}function a(t,n,o){for(var s={d:0,p:0},r=Array(t[0].length),l=0;l<t[0].length;l++)r[l]=n[t[0][l]];for(var e=Array(t[1].length),a=0;a<t[1].length;a++)e[a]=n[t[1][a]];for(var c,d,h=0;h<r.length;h++){c=0;for(var i=0;i<r.length;i++)h!==i&&(c+=o(r[h],r[i]));c/=r.length-1,d=0;for(var g=0;g<e.length;g++)d+=o(r[h],e[g]);d/=e.length,c-d>s.d&&(s.d=c-d,s.p=h)}return s}function c(e,t,n){for(var o=0,s=0,r=0;r<e.length;r++)for(var i=r;i<e.length;i++)o+=n(t[e[r].index],t[e[i].index]),s++;return o/s}const d=n(8),g=n(9),p=n(3);var x={dist:d,kind:'single'};e.exports=function(t,n){if(n=Object.assign({},x,n),'string'==typeof n.kind)switch(n.kind){case'single':n.kind=i;break;case'complete':n.kind=o;break;case'average':n.kind=s;break;case'centroid':n.kind=r;break;case'ward':n.kind=l;break;default:throw new RangeError('Unknown kind of similarity');}else if('function'!=typeof n.kind)throw new TypeError('Undefined kind of similarity');var u=new p;u.children=Array(t.length),u.index=Array(t.length);for(var k=0;k<t.length;k++)u.children[k]=new g(k),u.index[k]=new g(k);u.distance=c(u.index,t,n.dist);for(var y,m,w,b,v,M=[u];0<M.length;){m=0,w=0;for(var I=0;I<M.length;I++){y=0;for(var S=0;S<M[I].length;S++)for(var j=S+1;j<M[I].length;j++)y=h(n.dist(t[M[I].index[S].index],t[M[I].index[j].index]),y);y>m&&(m=y,w=I)}if(m=0,2===M[w].index.length)M[w].children=[M[w].index[0],M[w].index[1]],M[w].distance=n.dist(t[M[w].index[0].index],t[M[w].index[1].index]);else if(3===M[w].index.length){M[w].children=[M[w].index[0],M[w].index[1],M[w].index[2]];var D=[n.dist(t[M[w].index[0].index],t[M[w].index[1].index]),n.dist(t[M[w].index[1].index],t[M[w].index[2].index])];M[w].distance=(D[0]+D[1])/2}else{for(var d=new p,C=new p,z=[Array(M[w].index.length),[]],R=0;R<z[0].length;R++)z[0][R]=R;for(var V=0;V<z[0].length;V++){b=0;for(var L=0;L<z[0].length;L++)V!==L&&(b+=n.dist(t[M[w].index[z[0][L]].index],t[M[w].index[z[0][V]].index]));b/=z[0].length-1,b>m&&(m=b,v=V)}for(z[1]=[v],z[0].splice(v,1),b=a(z,t,n.dist);0<b.d;)z[1].push(z[0][b.p]),z[0].splice(b.p,1),b=a(z,t,n.dist);var E=Array(z[0].length);d.index=Array(z[0].length);for(var P=0;P<E.length;P++)E[P]=t[M[w].index[z[0][P]].index],d.index[P]=M[w].index[z[0][P]],d.children[P]=M[w].index[z[0][P]];var e=Array(z[1].length);C.index=Array(z[1].length);for(var A=0;A<e.length;A++)e[A]=t[M[w].index[z[1][A]].index],C.index[A]=M[w].index[z[1][A]],C.children[A]=M[w].index[z[1][A]];d.distance=c(d.index,t,n.dist),C.distance=c(C.index,t,n.dist),M.push(d),M.push(C),M[w].children=[d,C]}M.splice(w,1)}return u}},function(e,t,n){'use strict';t.agnes=n(31),t.diana=n(32)},function(e,t,n){'use strict';function o(e){if(!(this instanceof o))return new o(e);if(e=r.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t,n,i,c=e,a=c.rows,g=new r(a,a),l=!0;for(n=0;n<a;n++){var u=g[n],m=0;for(i=0;i<n;i++){var d=g[i],p=0;for(t=0;t<i;t++)p+=d[t]*u[t];u[i]=p=(c[n][i]-p)/g[i][i],m+=p*p}for(m=c[n][n]-m,l&=0<m,g[n][n]=v(h(m,0)),i=n+1;i<a;i++)g[n][i]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=g}var r=n(0).Matrix;o.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=r.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var o,i,s,l=e.columns,a=e.clone();for(s=0;s<n;s++)for(i=0;i<l;i++){for(o=0;o<s;o++)a[s][i]-=a[o][i]*t[s][o];a[s][i]/=t[s][s]}for(s=n-1;0<=s;s--)for(i=0;i<l;i++){for(o=s+1;o<n;o++)a[s][i]-=a[o][i]*t[o][s];a[s][i]/=t[s][s]}return a}},e.exports=o},function(e,t,n){'use strict';function o(t,c){if(c=Object.assign({},x,c),!(this instanceof o))return new o(t,c);if(t=g.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var h,i,u=t.columns,n=p(u,u,0),m=Array(u),d=Array(u),e=t,j=!1;if(j=!!c.assumeSymmetric||t.isSymmetric(),j){for(h=0;h<u;h++)for(i=0;i<u;i++)n[h][i]=e.get(h,i);s(u,d,m,n),r(u,d,m,n)}else{var k=p(u,u,0),f=Array(u);for(i=0;i<u;i++)for(h=0;h<u;h++)k[h][i]=e.get(h,i);l(u,k,f,n),a(u,d,m,n,k)}this.n=u,this.e=d,this.d=m,this.V=n}function s(t,n,e,o){var s,r,l,a,i,c,d,h;for(i=0;i<t;i++)e[i]=o[t-1][i];for(a=t-1;0<a;a--){for(h=0,l=0,c=0;c<a;c++)h+=M(e[c]);if(0===h)for(n[a]=e[a-1],i=0;i<a;i++)e[i]=o[a-1][i],o[a][i]=0,o[i][a]=0;else{for(c=0;c<a;c++)e[c]/=h,l+=e[c]*e[c];for(s=e[a-1],r=v(l),0<s&&(r=-r),n[a]=h*r,l-=s*r,e[a-1]=s-r,i=0;i<a;i++)n[i]=0;for(i=0;i<a;i++){for(s=e[i],o[i][a]=s,r=n[i]+o[i][i]*s,c=i+1;c<=a-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<a;i++)n[i]/=l,s+=n[i]*e[i];for(d=s/(l+l),i=0;i<a;i++)n[i]-=d*e[i];for(i=0;i<a;i++){for(s=e[i],r=n[i],c=i;c<=a-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[a-1][i],o[a][i]=0}}e[a]=l}for(a=0;a<t-1;a++){if(o[t-1][a]=o[a][a],o[a][a]=1,l=e[a+1],0!==l){for(c=0;c<=a;c++)e[c]=o[c][a+1]/l;for(i=0;i<=a;i++){for(r=0,c=0;c<=a;c++)r+=o[c][a+1]*o[c][i];for(c=0;c<=a;c++)o[c][i]-=r*e[c]}}for(c=0;c<=a;c++)o[c][a+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,u,x,l,j,p,k,y,c,w,b,v,I,S;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var C=0,f=0,D=2.220446049250313e-16;for(x=0;x<t;x++){for(f=h(f,M(e[x])+M(n[x])),l=x;l<t&&!(M(n[l])<=D*f);)l++;if(l>x){S=0;do{for(++S,a=e[x],j=(e[x+1]-a)/(2*n[x]),p=m(j,1),0>j&&(p=-p),e[x]=n[x]/(j+p),e[x+1]=n[x]*(j+p),k=e[x+1],d=a-e[x],g=x+2;g<t;g++)e[g]-=d;for(C+=d,j=e[l],y=1,c=y,w=y,b=n[x+1],v=0,I=0,g=l-1;g>=x;g--)for(w=c,c=y,I=v,a=y*n[g],d=y*j,p=m(j,n[g]),n[g+1]=v*p,v=n[g]/p,y=j/p,j=y*e[g]-v*a,e[g+1]=d+v*(y*a+v*e[g]),u=0;u<t;u++)d=o[u][g+1],o[u][g+1]=v*o[u][g]+y*d,o[u][g]=y*o[u][g]-v*d;j=-v*I*w*b*n[x]/k,n[x]=v*j,e[x]=y*j}while(M(n[x])>D*f)}e[x]+=C,n[x]=0}for(g=0;g<t-1;g++){for(u=g,j=e[g],i=g+1;i<t;i++)e[i]<j&&(u=i,j=e[i]);if(u!==g)for(e[u]=e[g],e[g]=j,i=0;i<t;i++)j=o[i][g],o[i][g]=o[i][u],o[i][u]=j}}function l(e,t,n,o){var s,r,l,a,i,c,d,h=0,u=e-1;for(c=h+1;c<=u-1;c++){for(d=0,a=c;a<=u;a++)d+=M(t[a][c-1]);if(0!==d){for(l=0,a=u;a>=c;a--)n[a]=t[a][c-1]/d,l+=n[a]*n[a];for(r=v(l),0<n[c]&&(r=-r),l-=n[c]*r,n[c]-=r,i=c;i<e;i++){for(s=0,a=u;a>=c;a--)s+=n[a]*t[a][i];for(s/=l,a=c;a<=u;a++)t[a][i]-=s*n[a]}for(a=0;a<=u;a++){for(s=0,i=u;i>=c;i--)s+=n[i]*t[a][i];for(s/=l,i=c;i<=u;i++)t[a][i]-=s*n[i]}n[c]=d*n[c],t[c][c-1]=d*r}}for(a=0;a<e;a++)for(i=0;i<e;i++)o[a][i]=a===i?1:0;for(c=u-1;c>=h+1;c--)if(0!==t[c][c-1]){for(a=c+1;a<=u;a++)n[a]=t[a][c-1];for(i=c;i<=u;i++){for(r=0,a=c;a<=u;a++)r+=n[a]*o[a][i];for(r=r/n[c]/t[c][c-1],a=c;a<=u;a++)o[a][i]+=r*n[a]}}}function a(o,a,e,d,g){var f,i,j,k,l,m,t,w,x,y,b,I,S,C,D,R=o-1,n=0,V=o-1,L=2.220446049250313e-16,E=0,P=0,A=0,p=0,F=0,q=0,_=0,O=0;for(f=0;f<o;f++)for((f<n||f>V)&&(e[f]=g[f][f],a[f]=0),i=h(f-1,0);i<o;i++)P+=M(g[f][i]);for(;R>=n;){for(k=R;k>n&&(q=M(g[k-1][k-1])+M(g[k][k]),0===q&&(q=P),!(M(g[k][k-1])<L*q));)k--;if(k===R)g[R][R]+=E,e[R]=g[R][R],a[R]=0,R--,O=0;else if(k===R-1){if(t=g[R][R-1]*g[R-1][R],A=(g[R-1][R-1]-g[R][R])/2,p=A*A+t,_=v(M(p)),g[R][R]+=E,g[R-1][R-1]=g[R-1][R-1]+E,w=g[R][R],0<=p){for(_=0<=A?A+_:A-_,e[R-1]=w+_,e[R]=e[R-1],0!==_&&(e[R]=w-t/_),a[R-1]=0,a[R]=0,w=g[R][R-1],q=M(w)+M(_),A=w/q,p=_/q,F=v(A*A+p*p),A/=F,p/=F,i=R-1;i<o;i++)_=g[R-1][i],g[R-1][i]=p*_+A*g[R][i],g[R][i]=p*g[R][i]-A*_;for(f=0;f<=R;f++)_=g[f][R-1],g[f][R-1]=p*_+A*g[f][R],g[f][R]=p*g[f][R]-A*_;for(f=n;f<=V;f++)_=d[f][R-1],d[f][R-1]=p*_+A*d[f][R],d[f][R]=p*d[f][R]-A*_}else e[R-1]=w+A,e[R]=w+A,a[R-1]=_,a[R]=-_;R-=2,O=0}else{if(w=g[R][R],x=0,t=0,k<R&&(x=g[R-1][R-1],t=g[R][R-1]*g[R-1][R]),10==O){for(E+=w,f=n;f<=R;f++)g[f][f]-=w;q=M(g[R][R-1])+M(g[R-1][R-2]),w=x=0.75*q,t=-0.4375*q*q}if(30==O&&(q=(x-w)/2,q=q*q+t,0<q)){for(q=v(q),x<w&&(q=-q),q=w-t/((x-w)/2+q),f=n;f<=R;f++)g[f][f]-=q;E+=q,w=x=t=0.964}for(++O,l=R-2;l>=k&&(_=g[l][l],F=w-_,q=x-_,A=(F*q-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-F-q,F=g[l+2][l+1],q=M(A)+M(p)+M(F),A/=q,p/=q,F/=q,l!==k)&&!(M(g[l][l-1])*(M(p)+M(F))<L*(M(A)*(M(g[l-1][l-1])+M(_)+M(g[l+1][l+1]))));)l--;for(f=l+2;f<=R;f++)g[f][f-2]=0,f>l+2&&(g[f][f-3]=0);for(j=l;j<=R-1&&(C=j!==R-1,j!==l&&(A=g[j][j-1],p=g[j+1][j-1],F=C?g[j+2][j-1]:0,w=M(A)+M(p)+M(F),0!==w&&(A/=w,p/=w,F/=w)),0!==w);j++)if(q=v(A*A+p*p+F*F),0>A&&(q=-q),0!==q){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-q*w,A+=q,w=A/q,x=p/q,_=F/q,p/=A,F/=A,i=j;i<o;i++)A=g[j][i]+p*g[j+1][i],C&&(A+=F*g[j+2][i],g[j+2][i]=g[j+2][i]-A*_),g[j][i]-=A*w,g[j+1][i]=g[j+1][i]-A*x;for(f=0;f<=u(R,j+3);f++)A=w*g[f][j]+x*g[f][j+1],C&&(A+=_*g[f][j+2],g[f][j+2]=g[f][j+2]-A*F),g[f][j]-=A,g[f][j+1]=g[f][j+1]-A*p;for(f=n;f<=V;f++)A=w*d[f][j]+x*d[f][j+1],C&&(A+=_*d[f][j+2],d[f][j+2]=d[f][j+2]-A*F),d[f][j]-=A,d[f][j+1]=d[f][j+1]-A*p}}}if(0!==P){for(R=o-1;0<=R;R--)if(A=e[R],p=a[R],0===p)for(k=R,g[R][R]=1,f=R-1;0<=f;f--){for(t=g[f][f]-A,F=0,i=k;i<=R;i++)F+=g[f][i]*g[i][R];if(0>a[f])_=t,q=F;else if(k=f,0===a[f]?g[f][R]=0===t?-F/(L*P):-F/t:(w=g[f][f+1],x=g[f+1][f],p=(e[f]-A)*(e[f]-A)+a[f]*a[f],m=(w*q-_*F)/p,g[f][R]=m,g[f+1][R]=M(w)>M(_)?(-F-t*m)/w:(-q-x*m)/_),m=M(g[f][R]),1<L*m*m)for(i=f;i<=R;i++)g[i][R]/=m}else if(0>p)for(k=R-1,M(g[R][R-1])>M(g[R-1][R])?(g[R-1][R-1]=p/g[R][R-1],g[R-1][R]=-(g[R][R]-A)/g[R][R-1]):(D=c(0,-g[R-1][R],g[R-1][R-1]-A,p),g[R-1][R-1]=D[0],g[R-1][R]=D[1]),g[R][R-1]=0,g[R][R]=1,f=R-2;0<=f;f--){for(y=0,b=0,i=k;i<=R;i++)y+=g[f][i]*g[i][R-1],b+=g[f][i]*g[i][R];if(t=g[f][f]-A,0>a[f])_=t,F=y,q=b;else if(k=f,0===a[f]?(D=c(-y,-b,t,p),g[f][R-1]=D[0],g[f][R]=D[1]):(w=g[f][f+1],x=g[f+1][f],I=(e[f]-A)*(e[f]-A)+a[f]*a[f]-p*p,S=2*(e[f]-A)*p,0===I&&0===S&&(I=L*P*(M(t)+M(p)+M(w)+M(x)+M(_))),D=c(w*F-_*y+p*b,w*q-_*b-p*y,I,S),g[f][R-1]=D[0],g[f][R]=D[1],M(w)>M(_)+M(p)?(g[f+1][R-1]=(-y-t*g[f][R-1]+p*g[f][R])/w,g[f+1][R]=(-b-t*g[f][R]-p*g[f][R-1])/w):(D=c(-F-x*g[f][R-1],-q-x*g[f][R],_,p),g[f+1][R-1]=D[0],g[f+1][R]=D[1])),m=h(M(g[f][R-1]),M(g[f][R])),1<L*m*m)for(i=f;i<=R;i++)g[i][R-1]=g[i][R-1]/m,g[i][R]/=m}for(f=0;f<o;f++)if(f<n||f>V)for(i=f;i<o;i++)d[f][i]=g[f][i];for(i=o-1;i>=n;i--)for(f=n;f<=V;f++){for(_=0,j=n;j<=u(i,V);j++)_+=d[f][j]*g[j][i];d[f][i]=_}}}function c(e,t,n,i){var o,s;return M(n)>M(i)?(o=i/n,s=n+o*i,[(e+o*t)/s,(t-o*e)/s]):(o=n/i,s=i+o*n,[(o*e+t)/s,(o*t-e)/s])}const g=n(0).Matrix,i=n(4),m=i.hypotenuse,p=i.getFilled2DArray,x={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return g.isMatrix(this.V)||(this.V=new g(this.V)),this.V},get diagonalMatrix(){var t,i,o=this.n,n=this.e,e=this.d,s=new g(o,o);for(t=0;t<o;t++){for(i=0;i<o;i++)s[t][i]=0;s[t][t]=e[t],0<n[t]?s[t][t+1]=n[t]:0>n[t]&&(s[t][t-1]=n[t])}return s}},e.exports=o},function(e,t,n){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t,i,l,a,c=e.clone(),d=e.rows,h=e.columns,n=Array(h);for(l=0;l<h;l++){var g=0;for(t=l;t<d;t++)g=s(g,c[t][l]);if(0!==g){for(0>c[l][l]&&(g=-g),t=l;t<d;t++)c[t][l]/=g;for(c[l][l]+=1,i=l+1;i<h;i++){for(a=0,t=l;t<d;t++)a+=c[t][l]*c[t][i];for(a=-a/c[l][l],t=l;t<d;t++)c[t][i]+=a*c[t][l]}}n[l]=-g}this.QR=c,this.Rdiag=n}var r=n(0).Matrix,s=n(4).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var l,i,a,c,d=e.columns,h=e.clone(),g=t.columns;for(a=0;a<g;a++)for(i=0;i<d;i++){for(c=0,l=a;l<o;l++)c+=t[l][a]*h[l][i];for(c=-c/t[a][a],l=a;l<o;l++)h[l][i]+=c*t[l][a]}for(a=g-1;0<=a;a--){for(i=0;i<d;i++)h[a][i]/=this.Rdiag[a];for(l=0;l<a;l++)for(i=0;i<d;i++)h[l][i]-=h[a][i]*t[l][a]}return h.subMatrix(0,g-1,0,d-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e,t,i=this.QR,o=i.columns,n=new r(o,o);for(e=0;e<o;e++)for(t=0;t<o;t++)n[e][t]=e<t?i[e][t]:e===t?this.Rdiag[e]:0;return n},get orthogonalMatrix(){var e,t,n,i,o=this.QR,l=o.rows,a=o.columns,c=new r(l,a);for(n=a-1;0<=n;n--){for(e=0;e<l;e++)c[e][n]=0;for(c[n][n]=1,t=n;t<a;t++)if(0!==o[n][n]){for(i=0,e=n;e<l;e++)i+=o[e][n]*c[e][t];for(i=-i/o[n][n],e=n;e<l;e++)c[e][t]+=i*o[e][n]}}return c}},e.exports=o},function(e,t,n){'use strict';function i(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new a(e).solve(t):new c(e).solve(t)}var s=n(0).Matrix,r=n(12),l=n(35),a=n(11),c=n(36),d=n(34);s.inverse=s.inv=i,s.prototype.inverse=s.prototype.inv=function(){return i(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:l,EVD:l,LuDecomposition:a,LU:a,QrDecomposition:c,QR:c,CholeskyDecomposition:d,CHO:d,inverse:i,solve:o}},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,n){'use strict';var i=n(1);e.exports=class extends i{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,n){return this.matrix.set(e,this.column,n),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,n){'use strict';var i=n(1);e.exports=class extends i{constructor(e){super(e,e.rows,e.columns)}set(e,t,n){return this.matrix.set(e,this.columns-t-1,n),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,n){'use strict';var i=n(1);e.exports=class extends i{constructor(e){super(e,e.rows,e.columns)}set(e,t,n){return this.matrix.set(this.rows-e-1,t,n),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,n){'use strict';var i=n(1);e.exports=class extends i{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,n){return this.matrix.set(this.row,t,n),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,n){'use strict';var i=n(1),o=n(2);e.exports=class extends i{constructor(e,t,n){var i=o.checkIndices(e,t,n);super(e,i.row.length,i.column.length),this.rowIndices=i.row,this.columnIndices=i.column}set(e,t,n){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],n),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,n){'use strict';var i=n(1),o=n(2);e.exports=class extends i{constructor(e,t,n,i,s){o.checkRange(e,t,n,i,s),super(e,n-t+1,s-i+1),this.startRow=t,this.startColumn=i}set(e,t,n){return this.matrix.set(this.startRow+e,this.startColumn+t,n),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,n){'use strict';var i=n(1);e.exports=class extends i{constructor(e){super(e,e.columns,e.rows)}set(e,t,n){return this.matrix.set(t,e,n),this}get(e,t){return this.matrix.get(t,e)}}},function(e){'use strict';function t(e){var t=v(2*e.length+0.25)-0.5,n=[],o=Array(t),s=t,l=0,i=[];for(l=t-1;0<=l;l--)o[l]=1;for(var a=-1,d=[];0<s;){if(0===d.length){for(i=Array(t),l=0;l<t;l++)i[l]=0;for(n.push(i),a=0;0==o[a];a++);}else a=d.splice(0,1);i[a]=1,o[a]=0,s--;var g=Array(t);for(l=0;l<t;l++){var m=h(a,l),c=u(a,l);g[l]=e[c*(2*t-c-1)/2+m],1==g[l]&&1==o[l]&&0==i[l]&&(d.push(l),i[l]=1)}}return n}const n={threshold:0,out:'assignment'};e.exports=function(e,o){const s=Object.assign({},n,o);var r,l,i,a;if('number'==typeof e[0])r=t(e);else if('object'==typeof e[0]){for(var c=e.length,d=Array(c*(c+1)/2),h=0,l=0;l<c;l++)for(var i=l;i<c;i++)d[h++]=e[l][i]>s.threshold?1:0;r=t(d)}if('indexes'===s.out||'values'===s.out){var g=Array(r.length);for(l=0;l<r.length;l++)for(g[l]=[],i=0;i<r[l].length;i++)0!=r[l][i]&&g[l].push(i);if('values'===s.out){var u=Array(g.length);for(l=0;l<g.length;l++)for(u[l]=Array(g[l].length),i=0;i<g[l].length;i++)for(u[l][i]=Array(g[l].length),a=0;a<g[l].length;a++)u[l][i][a]=e[g[l][i]][g[l][a]];return u}return g}return r}},function(e,r,i){'use strict';function s(e,t){return e-t}var l=i(14);r.max=function(e){for(var t=-Infinity,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)e[n][i]>t&&(t=e[n][i]);return t},r.min=function(e){for(var t=Infinity,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)e[n][i]<t&&(t=e[n][i]);return t},r.minMax=function(e){for(var t=Infinity,n=-Infinity,o=0;o<e.length;o++)for(var i=0;i<e[o].length;i++)e[o][i]<t&&(t=e[o][i]),e[o][i]>n&&(n=e[o][i]);return{min:t,max:n}},r.entropy=function(e,n){'undefined'==typeof n&&(n=0);for(var o=0,s=e.length,r=e[0].length,l=0;l<s;l++)for(var i=0;i<r;i++)o+=e[l][i]*t(e[l][i]+n);return-o},r.mean=function(e,t){'undefined'==typeof t&&(t=0);var n,o,s,i,r=e.length,l=e[0].length;if(-1===t){for(n=[0],o=r*l,s=0;s<r;s++)for(i=0;i<l;i++)n[0]+=e[s][i];n[0]/=o}else if(0===t)for(n=Array(l),o=r,i=0;i<l;i++){for(n[i]=0,s=0;s<r;s++)n[i]+=e[s][i];n[i]/=o}else if(1===t)for(n=Array(r),o=l,i=0;i<r;i++){for(n[i]=0,s=0;s<l;s++)n[i]+=e[i][s];n[i]/=o}else throw new Error('Invalid dimension');return n},r.sum=function(e,t){'undefined'==typeof t&&(t=0);var n,o,i,s=e.length,r=e[0].length;if(-1===t)for(n=[0],o=0;o<s;o++)for(i=0;i<r;i++)n[0]+=e[o][i];else if(0===t)for(n=Array(r),i=0;i<r;i++)for(n[i]=0,o=0;o<s;o++)n[i]+=e[o][i];else if(1===t)for(n=Array(s),i=0;i<s;i++)for(n[i]=0,o=0;o<r;o++)n[i]+=e[i][o];else throw new Error('Invalid dimension');return n},r.product=function(e,t){'undefined'==typeof t&&(t=0);var n,o,i,s=e.length,r=e[0].length;if(-1===t)for(n=[1],o=0;o<s;o++)for(i=0;i<r;i++)n[0]*=e[o][i];else if(0===t)for(n=Array(r),i=0;i<r;i++)for(n[i]=1,o=0;o<s;o++)n[i]*=e[o][i];else if(1===t)for(n=Array(s),i=0;i<s;i++)for(n[i]=1,o=0;o<r;o++)n[i]*=e[i][o];else throw new Error('Invalid dimension');return n},r.standardDeviation=function(e,t,n){for(var o=r.variance(e,t,n),s=o.length,l=0;l<s;l++)o[l]=v(o[l]);return o},r.variance=function(e,t,n){'undefined'==typeof n&&(n=!0),t=t||r.mean(e);var o=e.length;if(0===o)return[];for(var s=e[0].length,l=Array(s),a=0;a<s;a++){for(var c=0,d=0,h=0,g=0;g<o;g++)h=e[g][a]-t[a],c+=h,d+=h*h;l[a]=n?(d-c*c/o)/(o-1):(d-c*c/o)/o}return l},r.median=function(e){for(var t,o=e.length,r=e[0].length,l=Array(r),a=0;a<r;a++){t=Array(o);for(var i=0;i<o;i++)t[i]=e[i][a];t.sort(s);var c=t.length;l[a]=0==c%2?0.5*(t[c/2]+t[c/2-1]):t[n(c/2)]}return l},r.mode=function(e){var t,n,i=e.length,o=e[0].length,s=Array(o);for(t=0;t<o;t++){for(var r=Array(i),l=0;l<i;l++)r[l]=0;var a=Array(i),c=0;for(n=0;n<i;n++){var d=a.indexOf(e[n][t]);0<=d?r[d]++:(a[c]=e[n][t],r[c]=1,c++)}var h=0,g=0;for(n=0;n<c;n++)r[n]>h&&(h=r[n],g=n);s[t]=a[g]}return s},r.skewness=function(e,t){'undefined'==typeof t&&(t=!0);for(var s=r.mean(e),c=e.length,n=s.length,l=Array(n),d=0;d<n;d++){for(var h,u=0,m=0,p=0;p<c;p++)h=e[p][d]-s[d],u+=h*h,m+=h*h*h;var i=u/c,x=m/c,j=x/o(i,3/2);if(t){var g=v(c*(c-1));l[d]=g/(c-2)*j}else l[d]=j}return l},r.kurtosis=function(e,t){'undefined'==typeof t&&(t=!0);for(var o=r.mean(e),s=e.length,n=e[0].length,l=Array(n),a=0;a<n;a++){for(var c,d=0,h=0,g=0;g<s;g++)c=e[g][a]-o[a],d+=c*c,h+=c*c*c*c;var i=d/s,u=h/s;if(t){var m=d/(s-1),p=h/(m*m);l[a]=s*(s+1)/((s-1)*(s-2)*(s-3))*p-3*((s-1)*(s-1)/((s-2)*(s-3)))}else l[a]=u/(i*i)-3}return l},r.standardError=function(e){for(var t=e.length,n=r.standardDeviation(e),o=n.length,s=Array(o),l=v(t),a=0;a<o;a++)s[a]=n[a]/l;return s},r.covariance=function(e,t){return r.scatter(e,void 0,t)},r.scatter=function(e,t,n){'undefined'==typeof n&&(n=0),'undefined'==typeof t&&(0===n?t=e.length-1:1===n&&(t=e[0].length-1));var o=r.mean(e,n),l=e.length;if(0===l)return[[]];var a,c,i,d,s,h=e[0].length;if(0===n){for(a=Array(h),c=0;c<h;c++)a[c]=Array(h);for(c=0;c<h;c++)for(i=c;i<h;i++){for(d=0,s=0;s<l;s++)d+=(e[s][i]-o[i])*(e[s][c]-o[c]);d/=t,a[c][i]=d,a[i][c]=d}}else if(1===n){for(a=Array(l),c=0;c<l;c++)a[c]=Array(l);for(c=0;c<l;c++)for(i=c;i<l;i++){for(d=0,s=0;s<h;s++)d+=(e[i][s]-o[i])*(e[c][s]-o[c]);d/=t,a[c][i]=d,a[i][c]=d}}else throw new Error('Invalid dimension');return a},r.correlation=function(e){var t,n,i=r.mean(e),o=r.standardDeviation(e,!0,i),s=r.zScores(e,i,o),a=e.length,d=e[0].length,h=Array(d);for(t=0;t<d;t++)h[t]=Array(d);for(t=0;t<d;t++)for(n=t;n<d;n++){for(var g=0,c=0,u=s.length;c<u;c++)g+=s[c][n]*s[c][t];g/=a-1,h[t][n]=g,h[n][t]=g}return h},r.zScores=function(e,t,n){return t=t||r.mean(e),'undefined'==typeof n&&(n=r.standardDeviation(e,!0,t)),r.standardize(r.center(e,t,!1),n,!0)},r.center=function(e,t,n){t=t||r.mean(e);var o,i,s,a=e,c=e.length;if(!n)for(a=Array(c),o=0;o<c;o++)a[o]=Array(e[o].length);for(o=0;o<c;o++){var l=a[o];for(i=0,s=l.length;i<s;i++)l[i]=e[o][i]-t[i]}return a},r.standardize=function(e,t,n){'undefined'==typeof t&&(t=r.standardDeviation(e));var o,i,s,a=e,c=e.length;if(!n)for(a=Array(c),o=0;o<c;o++)a[o]=Array(e[o].length);for(o=0;o<c;o++){var l=a[o],d=e[o];for(i=0,s=l.length;i<s;i++)0===t[i]||isNaN(t[i])||(l[i]=d[i]/t[i])}return a},r.weightedVariance=function(e,t){var n=r.mean(e),o=e.length;if(0===o)return[];for(var s=e[0].length,l=Array(s),c=0;c<s;c++){for(var d=0,h=0,a=0,g=0;g<o;g++){var i=e[g][c]-n[c],u=t[g];d+=u*(i*i),a+=u,h+=u*u}l[c]=d*(a/(a*a-h))}return l},r.weightedMean=function(e,t,n){'undefined'==typeof n&&(n=0);var o=e.length;if(0===o)return[];var s,r,i,a,c,d,h=e[0].length;if(0===n){for(s=Array(h),r=0;r<h;r++)s[r]=0;for(r=0;r<o;r++)for(d=e[r],c=t[r],a=0;a<h;a++)s[a]+=d[a]*c}else if(1===n){for(s=Array(o),r=0;r<o;r++)s[r]=0;for(a=0;a<o;a++)for(d=e[a],c=t[a],r=0;r<h;r++)s[a]+=d[r]*c}else throw new Error('Invalid dimension');var g=l.sum(t);if(0!==g)for(r=0,i=s.length;r<i;r++)s[r]/=g;return s},r.weightedCovariance=function(e,t,n,o){o=o||0,n=n||r.weightedMean(e,t,o);for(var s=0,l=0,a=0,i=t.length;a<i;a++)s+=t[a],l+=t[a]*t[a];var c=s/(s*s-l);return r.weightedScatter(e,t,n,c,o)},r.weightedScatter=function(e,t,n,o,l){l=l||0,n=n||r.weightedMean(e,t,l),'undefined'==typeof o&&(o=1);var a=e.length;if(0===a)return[[]];var c,d,i,h,g,s=e[0].length;if(0===l){for(c=Array(s),d=0;d<s;d++)c[d]=Array(s);for(d=0;d<s;d++)for(i=d;i<s;i++){for(g=0,h=0;h<a;h++)g+=t[h]*(e[h][i]-n[i])*(e[h][d]-n[d]);c[d][i]=g*o,c[i][d]=g*o}}else if(1===l){for(c=Array(a),d=0;d<a;d++)c[d]=Array(a);for(d=0;d<a;d++)for(i=d;i<a;i++){for(g=0,h=0;h<s;h++)g+=t[h]*(e[i][h]-n[i])*(e[d][h]-n[d]);c[d][i]=g*o,c[i][d]=g*o}}else throw new Error('Invalid dimension');return c}},function(e){'use strict';e.exports=Number.isNaN||function(e){return e!==e}},function(e){function t(){throw new Error('setTimeout has not been defined')}function n(){throw new Error('clearTimeout has not been defined')}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===t||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(e){if(d===clearTimeout)return clearTimeout(e);if((d===n||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function s(){m&&g&&(m=!1,g.length?u=g.concat(u):p=-1,u.length&&r())}function r(){if(!m){var e=o(s);m=!0;for(var t=u.length;t;){for(g=u,u=[];++p<t;)g&&g[p].run();p=-1,t=u.length}g=null,m=!1,i(e)}}function l(e,t){this.fun=e,this.array=t}function a(){}var c,d,h=e.exports={};(function(){try{c='function'==typeof setTimeout?setTimeout:t}catch(n){c=t}try{d='function'==typeof clearTimeout?clearTimeout:n}catch(t){d=n}})();var g,u=[],m=!1,p=-1;h.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new l(e,t)),1!==u.length||m||o(r)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title='browser',h.browser=!0,h.env={},h.argv=[],h.version='',h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(){return[]},h.binding=function(){throw new Error('process.binding is not supported')},h.cwd=function(){return'/'},h.chdir=function(){throw new Error('process.chdir is not supported')},h.umask=function(){return 0}},function(e){e.exports='function'==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e){e.exports=function(e){return e&&'object'==typeof e&&'function'==typeof e.copy&&'function'==typeof e.fill&&'function'==typeof e.readUInt8}},function(e,t,n){(function(e,i){function o(e,n){var i={seen:[],stylize:r};return 3<=arguments.length&&(i.depth=arguments[2]),4<=arguments.length&&(i.colors=arguments[3]),p(n)?i.showHidden=n:n&&t._extend(i,n),f(i.showHidden)&&(i.showHidden=!1),f(i.depth)&&(i.depth=2),f(i.colors)&&(i.colors=!1),f(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=s),a(i,e,i.depth)}function s(e,t){var n=o.styles[t];return n?'\x1B['+o.colors[n][0]+'m'+e+'\x1B['+o.colors[n][1]+'m':e}function r(e){return e}function l(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function a(e,i,o){if(e.customInspect&&i&&M(i.inspect)&&i.inspect!==t.inspect&&!(i.constructor&&i.constructor.prototype===i)){var s=i.inspect(o,e);return k(s)||(s=a(e,s,o)),s}var r=c(e,i);if(r)return r;var p=Object.keys(i),x=l(p);if(e.showHidden&&(p=Object.getOwnPropertyNames(i)),v(i)&&(0<=p.indexOf('message')||0<=p.indexOf('description')))return d(i);if(0===p.length){if(M(i)){var j=i.name?': '+i.name:'';return e.stylize('[Function'+j+']','special')}if(y(i))return e.stylize(RegExp.prototype.toString.call(i),'regexp');if(b(i))return e.stylize(Date.prototype.toString.call(i),'date');if(v(i))return d(i)}var f='',w=!1,I=['{','}'];if(m(i)&&(w=!0,I=['[',']']),M(i)){var S=i.name?': '+i.name:'';f=' [Function'+S+']'}if(y(i)&&(f=' '+RegExp.prototype.toString.call(i)),b(i)&&(f=' '+Date.prototype.toUTCString.call(i)),v(i)&&(f=' '+d(i)),0===p.length&&(!w||0==i.length))return I[0]+f+I[1];if(0>o)return y(i)?e.stylize(RegExp.prototype.toString.call(i),'regexp'):e.stylize('[Object]','special');e.seen.push(i);var n;return n=w?h(e,i,o,x,p):p.map(function(t){return g(e,i,o,x,t,w)}),e.seen.pop(),u(n,f,I)}function c(e,t){if(f(t))return e.stylize('undefined','undefined');if(k(t)){var n='\''+JSON.stringify(t).replace(/^"|"$/g,'').replace(/'/g,'\\\'').replace(/\\"/g,'"')+'\'';return e.stylize(n,'string')}return x(t)?e.stylize(''+t,'number'):p(t)?e.stylize(''+t,'boolean'):j(t)?e.stylize('null','null'):void 0}function d(e){return'['+Error.prototype.toString.call(e)+']'}function h(e,t,n,o,s){for(var r=[],a=0,i=t.length;a<i;++a)D(t,a+'')?r.push(g(e,t,n,o,a+'',!0)):r.push('');return s.forEach(function(i){i.match(/^\d+$/)||r.push(g(e,t,n,o,i,!0))}),r}function g(e,t,n,i,o,s){var r,l,c;if(c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},c.get?c.set?l=e.stylize('[Getter/Setter]','special'):l=e.stylize('[Getter]','special'):c.set&&(l=e.stylize('[Setter]','special')),D(i,o)||(r='['+o+']'),l||(0>e.seen.indexOf(c.value)?(l=j(n)?a(e,c.value,null):a(e,c.value,n-1),-1<l.indexOf('\n')&&(s?l=l.split('\n').map(function(e){return'  '+e}).join('\n').substr(2):l='\n'+l.split('\n').map(function(e){return'   '+e}).join('\n'))):l=e.stylize('[Circular]','special')),f(r)){if(s&&o.match(/^\d+$/))return l;r=JSON.stringify(''+o),r.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,'name')):(r=r.replace(/'/g,'\\\'').replace(/\\"/g,'"').replace(/(^"|"$)/g,'\''),r=e.stylize(r,'string'))}return r+': '+l}function u(e,t,n){var i=0,o=e.reduce(function(e,t){return i++,0<=t.indexOf('\n')&&i++,e+t.replace(/\u001b\[\d\d?m/g,'').length+1},0);return 60<o?n[0]+(''===t?'':t+'\n ')+' '+e.join(',\n  ')+' '+n[1]:n[0]+t+' '+e.join(', ')+' '+n[1]}function m(e){return Array.isArray(e)}function p(e){return'boolean'==typeof e}function j(e){return null===e}function x(e){return'number'==typeof e}function k(e){return'string'==typeof e}function f(e){return void 0===e}function y(e){return w(e)&&'[object RegExp]'===I(e)}function w(e){return'object'==typeof e&&null!==e}function b(e){return w(e)&&'[object Date]'===I(e)}function v(t){return w(t)&&('[object Error]'===I(t)||t instanceof Error)}function M(e){return'function'==typeof e}function I(e){return Object.prototype.toString.call(e)}function S(e){return 10>e?'0'+e.toString(10):e.toString(10)}function C(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(':');return[e.getDate(),L[e.getMonth()],t].join(' ')}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var z=/%[sdj%]/g;t.format=function(e){if(!k(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(' ')}for(var n=1,i=arguments,s=i.length,r=(e+'').replace(z,function(e){if('%%'===e)return'%';if(n>=s)return e;switch(e){case'%s':return i[n++]+'';case'%d':return+i[n++];case'%j':try{return JSON.stringify(i[n++])}catch(e){return'[Circular]'}default:return e;}}),l=i[n];n<s;l=i[++n])r+=j(l)||!w(l)?' '+l:' '+o(l);return r},t.deprecate=function(n,o){if(f(e.process))return function(){return t.deprecate(n,o).apply(this,arguments)};if(!0===i.noDeprecation)return n;var s=!1;return function(){if(!s){if(i.throwDeprecation)throw new Error(o);else i.traceDeprecation?console.trace(o):console.error(o);s=!0}return n.apply(this,arguments)}};var R,V={};t.debuglog=function(e){if(f(R)&&(R=i.env.NODE_DEBUG||''),e=e.toUpperCase(),!V[e])if(new RegExp('\\b'+e+'\\b','i').test(R)){var n=i.pid;V[e]=function(){var i=t.format.apply(t,arguments);console.error('%s %d: %s',e,n,i)}}else V[e]=function(){};return V[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:'cyan',number:'yellow',boolean:'yellow',undefined:'grey',null:'bold',string:'green',date:'magenta',regexp:'red'},t.isArray=m,t.isBoolean=p,t.isNull=j,t.isNullOrUndefined=function(e){return null==e},t.isNumber=x,t.isString=k,t.isSymbol=function(e){return'symbol'==typeof e},t.isUndefined=f,t.isRegExp=y,t.isObject=w,t.isDate=b,t.isError=v,t.isFunction=M,t.isPrimitive=function(e){return null===e||'boolean'==typeof e||'number'==typeof e||'string'==typeof e||'symbol'==typeof e||'undefined'==typeof e},t.isBuffer=n(51);var L=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];t.log=function(){console.log('%s - %s',C(),t.format.apply(t,arguments))},t.inherits=n(50),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),o=n.length;o--;)e[n[o]]=t[n[o]];return e}}).call(t,n(53),n(49))},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(n){'object'==typeof window&&(t=window)}e.exports=t}])});
//# sourceMappingURL=nmr-simulation.min.js.map