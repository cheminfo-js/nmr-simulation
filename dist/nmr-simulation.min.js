var _NumberMAX_VALUE=Number.MAX_VALUE,_Mathround=Math.round,_Mathexp=Math.exp,_Mathceil=Math.ceil,_Mathlog=Math.log,_Mathpow=Math.pow,_Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathsqrt=Math.sqrt,_Mathabs=Math.abs,_NumberisInteger=Number.isInteger;(function(I,D){'object'==typeof exports&&'object'==typeof module?module.exports=D():'function'==typeof define&&define.amd?define([],D):'object'==typeof exports?exports.nmrSimulation=D():I.nmrSimulation=D()})(this,function(){return function(u){function I(R){if(D[R])return D[R].exports;var E=D[R]={i:R,l:!1,exports:{}};return u[R].call(E.exports,E,E.exports,I),E.l=!0,E.exports}var D={};return I.m=u,I.c=D,I.i=function(R){return R},I.d=function(R,E,P){I.o(R,E)||Object.defineProperty(R,E,{configurable:!1,enumerable:!0,get:P})},I.n=function(R){var E=R&&R.__esModule?function(){return R['default']}:function(){return R};return I.d(E,'a',E),E},I.o=function(R,E){return Object.prototype.hasOwnProperty.call(R,E)},I.p='',I(I.s=53)}([function(u,I,D){'use strict';D(37);var R=D(10),E=D(2);class P extends R(Array){constructor(F,O){var W;if(1===arguments.length&&'number'==typeof F)return Array(F);if(P.isMatrix(F))return F.clone();if(_NumberisInteger(F)&&0<F){if(super(F),_NumberisInteger(O)&&0<O)for(W=0;W<F;W++)this[W]=Array(O);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(F)){const T=F;if(F=T.length,O=T[0].length,'number'!=typeof O||0===O)throw new TypeError('Data must be a 2D array with at least one element');for(super(F),W=0;W<F;W++){if(T[W].length!==O)throw new RangeError('Inconsistent array dimensions');this[W]=[].concat(T[W])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=F,this.columns=O,this}set(F,O,W){return this[F][O]=W,this}get(F,O){return this[F][O]}clone(){for(var F=new this.constructor[Symbol.species](this.rows,this.columns),O=0;O<this.rows;O++)for(var W=0;W<this.columns;W++)F.set(O,W,this.get(O,W));return F}removeRow(F){if(E.checkRowIndex(this,F),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(F,1),this.rows-=1,this}addRow(F,O){return void 0===O&&(O=F,F=this.rows),E.checkRowIndex(this,F,!0),O=E.checkRowVector(this,O,!0),this.splice(F,0,O),this.rows+=1,this}removeColumn(F){if(E.checkColumnIndex(this,F),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var O=0;O<this.rows;O++)this[O].splice(F,1);return this.columns-=1,this}addColumn(F,O){'undefined'==typeof O&&(O=F,F=this.columns),E.checkColumnIndex(this,F,!0),O=E.checkColumnVector(this,O);for(var W=0;W<this.rows;W++)this[W].splice(F,0,O[W]);return this.columns+=1,this}}I.Matrix=P,P.abstractMatrix=R},function(u,I,D){'use strict';var R=D(10),E=D(0);class P extends R(){constructor(F,O,W){super(),this.matrix=F,this.rows=O,this.columns=W}static get[Symbol.species](){return E.Matrix}}u.exports=P},function(u,I,D){'use strict';var R=D(0);I.checkRowIndex=function(P,F,O){var W=O?P.rows:P.rows-1;if(0>F||F>W)throw new RangeError('Row index out of range')},I.checkColumnIndex=function(P,F,O){var W=O?P.columns:P.columns-1;if(0>F||F>W)throw new RangeError('Column index out of range')},I.checkRowVector=function(P,F){if(F.to1DArray&&(F=F.to1DArray()),F.length!==P.columns)throw new RangeError('vector size must be the same as the number of columns');return F},I.checkColumnVector=function(P,F){if(F.to1DArray&&(F=F.to1DArray()),F.length!==P.rows)throw new RangeError('vector size must be the same as the number of rows');return F},I.checkIndices=function(P,F,O){var W=F.some((Z)=>{return 0>Z||Z>=P.rows}),T=O.some((Z)=>{return 0>Z||Z>=P.columns});if(W||T)throw new RangeError('Indices are out of range');if('object'!=typeof F||'object'!=typeof O)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(F)||(F=Array.from(F)),Array.isArray(O)||(F=Array.from(O)),{row:F,column:O}},I.checkRange=function(P,F,O,W,T){if(5!==arguments.length)throw new TypeError('Invalid argument type');var Z=Array.from(arguments).slice(1).some(function(Q){return'number'!=typeof Q});if(Z)throw new TypeError('Invalid argument type');if(F>O||W>T||0>F||F>=P.rows||0>O||O>=P.rows||0>W||W>=P.columns||0>T||T>=P.columns)throw new RangeError('Submatrix indices are out of range')},I.getRange=function(P,F){for(var O=Array(F-P+1),W=0;W<O.length;W++)O[W]=P+W;return O},I.sumByRow=function(P){for(var F=R.Matrix.zeros(P.rows,1),O=0;O<P.rows;++O)for(var W=0;W<P.columns;++W)F.set(O,0,F.get(O,0)+P.get(O,W));return F},I.sumByColumn=function(P){for(var F=R.Matrix.zeros(1,P.columns),O=0;O<P.rows;++O)for(var W=0;W<P.columns;++W)F.set(0,W,F.get(0,W)+P.get(O,W));return F},I.sumAll=function(P){for(var F=0,O=0;O<P.rows;O++)for(var W=0;W<P.columns;W++)F+=P.get(O,W);return F}},function(u,I,D){'use strict';function R(){this.children=[],this.distance=-1,this.index=[]}const E=D(21);R.prototype.cut=function(P){if(0>P)throw new RangeError('Threshold too small');var F=new R;F.children=this.children,F.distance=this.distance,F.index=this.index;for(var T,O=[F],W=[];0<O.length;)T=O.shift(),P>=T.distance?W.push(T):O=O.concat(T.children);return W},R.prototype.group=function(P){if(!_NumberisInteger(P)||1>P)throw new RangeError('Number of groups must be a positive integer');const F=new E(function(T,Z){return Z.distance-T.distance});for(F.push(this);F.size()<P;){var O=F.pop();if(0===O.children.length)break;O.children.forEach((T)=>F.push(T))}var W=new R;return W.children=F.toArray(),W.distance=this.distance,W},R.prototype.traverse=function(P){function F(O,W){if(W(O),O.children)for(var T=O.children.length-1;0<=T;T--)F(O.children[T],W)}F(this,P)},u.exports=R},function(u,I){'use strict';I.hypotenuse=function(E,P){var F;return _Mathabs(E)>_Mathabs(P)?(F=P/E,_Mathabs(E)*_Mathsqrt(1+F*F)):0===P?0:(F=E/P,_Mathabs(P)*_Mathsqrt(1+F*F))},I.getEmpty2DArray=function(R,E){for(var P=Array(R),F=0;F<R;F++)P[F]=Array(E);return P},I.getFilled2DArray=function(R,E,P){for(var F=Array(R),O=0;O<R;O++){F[O]=Array(E);for(var W=0;W<E;W++)F[O][W]=P}return F}},function(u,I,D){'use strict';u.exports=D(0).Matrix,u.exports.Decompositions=u.exports.DC=D(36)},function(u){u.exports=function(R,E){R=R||0;for(var P=Array(R),F=0;F<R;F++)P[F]=E;return P}},function(u){u.exports=function(D,R,E,P,F){var O,W;if(void 0===P)P=0;else if(P|=0,0>P||P>=D.length)throw new RangeError('invalid lower bound');if(void 0===F)F=D.length-1;else if(F|=0,F<P||F>=D.length)throw new RangeError('invalid upper bound');for(;P<=F;)if(O=P+(F-P>>1),W=+E(D[O],R,O,D),0>W)P=O+1;else if(0<W)F=O-1;else return O;return~P}},function(u){'use strict';function R(P,F){for(var O=0,W=0;W<P.length;W++)O+=(P[W]-F[W])*(P[W]-F[W]);return O}function E(P,F){return _Mathsqrt(R(P,F))}u.exports=E,E.squared=R},function(u,I,D){'use strict';function R(F){E.call(this),this.index=F,this.distance=0,this.children=[]}const E=D(3),P=D(51);P.inherits(R,E),u.exports=R},function(module,exports,__webpack_require__){'use strict';function abstractMatrix(superCtor){function checkDimensions(u,I){if(u.rows!==I.rows||u.columns!==I.columns)throw new RangeError('Matrices dimensions must be equal')}function compareNumbers(u,I){return u-I}function fillTemplateFunction(u,I){for(var D in I)u=u.replace(new RegExp('%'+D+'%','g'),I[D]);return u}superCtor===void 0&&(superCtor=Object);class Matrix extends superCtor{static get[Symbol.species](){return this}static from1DArray(u,I,D){if(u*I!==D.length)throw new RangeError('Data length does not match given dimensions');for(var E=new this(u,I),P=0;P<u;P++)for(var F=0;F<I;F++)E.set(P,F,D[P*I+F]);return E}static rowVector(u){for(var I=new this(1,u.length),D=0;D<u.length;D++)I.set(0,D,u[D]);return I}static columnVector(u){for(var I=new this(u.length,1),D=0;D<u.length;D++)I.set(D,0,u[D]);return I}static empty(u,I){return new this(u,I)}static zeros(u,I){return this.empty(u,I).fill(0)}static ones(u,I){return this.empty(u,I).fill(1)}static rand(u,I,D){D===void 0&&(D=Math.random);for(var R=this.empty(u,I),E=0;E<u;E++)for(var P=0;P<I;P++)R.set(E,P,D());return R}static randInt(u,I,D,R){D===void 0&&(D=1e3),R===void 0&&(R=Math.random);for(var E=this.empty(u,I),P=0;P<u;P++)for(var O,F=0;F<I;F++)O=_Mathfloor(R()*D),E.set(P,F,O);return E}static eye(u,I,D){I===void 0&&(I=u),D===void 0&&(D=1);for(var R=_Mathmin(u,I),E=this.zeros(u,I),P=0;P<R;P++)E.set(P,P,D);return E}static diag(u,I,D){var R=u.length;I===void 0&&(I=R),D===void 0&&(D=I);for(var E=_Mathmin(R,I,D),P=this.zeros(I,D),F=0;F<E;F++)P.set(F,F,u[F]);return P}static min(u,I){u=this.checkMatrix(u),I=this.checkMatrix(I);for(var D=u.rows,R=u.columns,E=new this(D,R),P=0;P<D;P++)for(var F=0;F<R;F++)E.set(P,F,_Mathmin(u.get(P,F),I.get(P,F)));return E}static max(u,I){u=this.checkMatrix(u),I=this.checkMatrix(I);for(var D=u.rows,R=u.columns,E=new this(D,R),P=0;P<D;P++)for(var F=0;F<R;F++)E.set(P,F,_Mathmax(u.get(P,F),I.get(P,F)));return E}static checkMatrix(u){return Matrix.isMatrix(u)?u:new this(u)}static isMatrix(u){return null!=u&&'Matrix'===u.klass}get size(){return this.rows*this.columns}apply(u){if('function'!=typeof u)throw new TypeError('callback must be a function');for(var I=this.rows,D=this.columns,R=0;R<I;R++)for(var E=0;E<D;E++)u.call(this,R,E);return this}to1DArray(){for(var u=Array(this.size),I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)u[I*this.columns+D]=this.get(I,D);return u}to2DArray(){for(var u=Array(this.rows),I=0;I<this.rows;I++){u[I]=Array(this.columns);for(var D=0;D<this.columns;D++)u[I][D]=this.get(I,D)}return u}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var u=0;u<this.rows;u++)for(var I=0;I<=u;I++)if(this.get(u,I)!==this.get(I,u))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(u,I){u=u||1,I=I||1;for(var D=new this.constructor[Symbol.species](this.rows*u,this.columns*I),R=0;R<u;R++)for(var E=0;E<I;E++)D.setSubMatrix(this,this.rows*R,this.columns*E);return D}fill(u){for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,u);return this}neg(){return this.mulS(-1)}getRow(u){util.checkRowIndex(this,u);for(var I=Array(this.columns),D=0;D<this.columns;D++)I[D]=this.get(u,D);return I}getRowVector(u){return this.constructor.rowVector(this.getRow(u))}setRow(u,I){util.checkRowIndex(this,u),I=util.checkRowVector(this,I);for(var D=0;D<this.columns;D++)this.set(u,D,I[D]);return this}swapRows(u,I){util.checkRowIndex(this,u),util.checkRowIndex(this,I);for(var R,D=0;D<this.columns;D++)R=this.get(u,D),this.set(u,D,this.get(I,D)),this.set(I,D,R);return this}getColumn(u){util.checkColumnIndex(this,u);for(var I=Array(this.rows),D=0;D<this.rows;D++)I[D]=this.get(D,u);return I}getColumnVector(u){return this.constructor.columnVector(this.getColumn(u))}setColumn(u,I){util.checkColumnIndex(this,u),I=util.checkColumnVector(this,I);for(var D=0;D<this.rows;D++)this.set(D,u,I[D]);return this}swapColumns(u,I){util.checkColumnIndex(this,u),util.checkColumnIndex(this,I);for(var R,D=0;D<this.rows;D++)R=this.get(D,u),this.set(D,u,this.get(D,I)),this.set(D,I,R);return this}addRowVector(u){u=util.checkRowVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)+u[D]);return this}subRowVector(u){u=util.checkRowVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)-u[D]);return this}mulRowVector(u){u=util.checkRowVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)*u[D]);return this}divRowVector(u){u=util.checkRowVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)/u[D]);return this}addColumnVector(u){u=util.checkColumnVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)+u[I]);return this}subColumnVector(u){u=util.checkColumnVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)-u[I]);return this}mulColumnVector(u){u=util.checkColumnVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)*u[I]);return this}divColumnVector(u){u=util.checkColumnVector(this,u);for(var I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.set(I,D,this.get(I,D)/u[I]);return this}mulRow(u,I){util.checkRowIndex(this,u);for(var D=0;D<this.columns;D++)this.set(u,D,this.get(u,D)*I);return this}mulColumn(u,I){util.checkColumnIndex(this,u);for(var D=0;D<this.rows;D++)this.set(D,u,this.get(D,u)*I);return this}max(){for(var u=this.get(0,0),I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.get(I,D)>u&&(u=this.get(I,D));return u}maxIndex(){for(var u=this.get(0,0),I=[0,0],D=0;D<this.rows;D++)for(var R=0;R<this.columns;R++)this.get(D,R)>u&&(u=this.get(D,R),I[0]=D,I[1]=R);return I}min(){for(var u=this.get(0,0),I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)this.get(I,D)<u&&(u=this.get(I,D));return u}minIndex(){for(var u=this.get(0,0),I=[0,0],D=0;D<this.rows;D++)for(var R=0;R<this.columns;R++)this.get(D,R)<u&&(u=this.get(D,R),I[0]=D,I[1]=R);return I}maxRow(u){util.checkRowIndex(this,u);for(var I=this.get(u,0),D=1;D<this.columns;D++)this.get(u,D)>I&&(I=this.get(u,D));return I}maxRowIndex(u){util.checkRowIndex(this,u);for(var I=this.get(u,0),D=[u,0],R=1;R<this.columns;R++)this.get(u,R)>I&&(I=this.get(u,R),D[1]=R);return D}minRow(u){util.checkRowIndex(this,u);for(var I=this.get(u,0),D=1;D<this.columns;D++)this.get(u,D)<I&&(I=this.get(u,D));return I}minRowIndex(u){util.checkRowIndex(this,u);for(var I=this.get(u,0),D=[u,0],R=1;R<this.columns;R++)this.get(u,R)<I&&(I=this.get(u,R),D[1]=R);return D}maxColumn(u){util.checkColumnIndex(this,u);for(var I=this.get(0,u),D=1;D<this.rows;D++)this.get(D,u)>I&&(I=this.get(D,u));return I}maxColumnIndex(u){util.checkColumnIndex(this,u);for(var I=this.get(0,u),D=[0,u],R=1;R<this.rows;R++)this.get(R,u)>I&&(I=this.get(R,u),D[0]=R);return D}minColumn(u){util.checkColumnIndex(this,u);for(var I=this.get(0,u),D=1;D<this.rows;D++)this.get(D,u)<I&&(I=this.get(D,u));return I}minColumnIndex(u){util.checkColumnIndex(this,u);for(var I=this.get(0,u),D=[0,u],R=1;R<this.rows;R++)this.get(R,u)<I&&(I=this.get(R,u),D[0]=R);return D}diag(){for(var u=_Mathmin(this.rows,this.columns),I=Array(u),D=0;D<u;D++)I[D]=this.get(D,D);return I}sum(u){return'row'===u?util.sumByRow(this):'column'===u?util.sumByColumn(this):util.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var u=1,I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)u*=this.get(I,D);return u}cumulativeSum(){for(var u=0,I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)u+=this.get(I,D),this.set(I,D,u);return this}dot(u){Matrix.isMatrix(u)&&(u=u.to1DArray());var I=this.to1DArray();if(I.length!==u.length)throw new RangeError('vectors do not have the same size');for(var D=0,R=0;R<I.length;R++)D+=I[R]*u[R];return D}mmul(u){u=this.constructor.checkMatrix(u),this.columns!==u.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var I=this.rows,D=this.columns,R=u.columns,E=new this.constructor[Symbol.species](I,R),P=Array(D),F=0;F<R;F++){for(var O=0;O<D;O++)P[O]=u.get(O,F);for(var T,W=0;W<I;W++){for(T=0,O=0;O<D;O++)T+=this.get(W,O)*P[O];E.set(W,F,T)}}return E}strassen2x2(u){var I=new this.constructor[Symbol.species](2,2);const D=this.get(0,0),R=u.get(0,0),E=this.get(0,1),P=u.get(0,1),F=this.get(1,0),O=u.get(1,0),W=this.get(1,1),T=u.get(1,1),Z=(D+W)*(R+T),Q=(F+W)*R,K=D*(P-T),G=W*(O-R),$=(D+E)*T;return I.set(0,0,Z+G-$+(E-W)*(O+T)),I.set(0,1,K+$),I.set(1,0,Q+G),I.set(1,1,Z-Q+K+(F-D)*(R+P)),I}strassen3x3(u){var I=new this.constructor[Symbol.species](3,3);const D=this.get(0,0),R=this.get(0,1),E=this.get(0,2),P=this.get(1,0),F=this.get(1,1),O=this.get(1,2),W=this.get(2,0),T=this.get(2,1),Z=this.get(2,2),Q=u.get(0,0),K=u.get(0,1),G=u.get(0,2),$=u.get(1,0),ee=u.get(1,1),te=u.get(1,2),ne=u.get(2,0),ie=u.get(2,1),se=u.get(2,2),le=(D-P)*(-K+ee),ce=(-D+P+F)*(Q-K+ee),de=(P+F)*(-Q+K),ue=D*Q,he=(-D+W+T)*(Q-G+te),ge=(-D+W)*(G-te),me=(W+T)*(-Q+G),je=(-E+T+Z)*(ee+ne-ie),ke=(E-Z)*(ee-ie),fe=E*ne,ye=(T+Z)*(-ne+ie),we=(-E+F+O)*(te+ne-se),be=(E-O)*(te-se),ve=(F+O)*(-ne+se);return I.set(0,0,ue+fe+R*$),I.set(0,1,(D+R+E-P-F-T-Z)*ee+ce+de+ue+je+fe+ye),I.set(0,2,ue+he+me+(D+R+E-F-O-W-T)*te+fe+we+ve),I.set(1,0,le+F*(-Q+K+$-ee-te-ne+se)+ce+ue+fe+we+be),I.set(1,1,le+ce+de+ue+O*ie),I.set(1,2,fe+we+be+ve+P*G),I.set(2,0,ue+he+ge+T*(-Q+G+$-ee-te-ne+ie)+je+ke+fe),I.set(2,1,je+ke+fe+ye+W*K),I.set(2,2,ue+he+ge+me+Z*se),I}mmulStrassen(u){function I(Z,Q,K){var G=Z.rows,$=Z.columns;if(G===Q&&$===K)return Z;var ee=Matrix.zeros(Q,K);return ee=ee.setSubMatrix(Z,0,0),ee}function D(Z,Q,K,G){if(512>=K||512>=G)return Z.mmul(Q);1==K%2&&1==G%2?(Z=I(Z,K+1,G+1),Q=I(Q,K+1,G+1)):1==K%2?(Z=I(Z,K+1,G),Q=I(Q,K+1,G)):1==G%2&&(Z=I(Z,K,G+1),Q=I(Q,K,G+1));var $=parseInt(Z.rows/2),ee=parseInt(Z.columns/2),te=Z.subMatrix(0,$-1,0,ee-1),ne=Q.subMatrix(0,$-1,0,ee-1),ie=Z.subMatrix(0,$-1,ee,Z.columns-1),se=Q.subMatrix(0,$-1,ee,Q.columns-1),oe=Z.subMatrix($,Z.rows-1,0,ee-1),le=Q.subMatrix($,Q.rows-1,0,ee-1),ae=Z.subMatrix($,Z.rows-1,ee,Z.columns-1),ce=Q.subMatrix($,Q.rows-1,ee,Q.columns-1),de=D(Matrix.add(te,ae),Matrix.add(ne,ce),$,ee),ue=D(Matrix.add(oe,ae),ne,$,ee),he=D(te,Matrix.sub(se,ce),$,ee),ge=D(ae,Matrix.sub(le,ne),$,ee),me=D(Matrix.add(te,ie),ce,$,ee),pe=D(Matrix.sub(oe,te),Matrix.add(ne,se),$,ee),xe=D(Matrix.sub(ie,ae),Matrix.add(le,ce),$,ee),je=Matrix.add(de,ge);je.sub(me),je.add(xe);var ke=Matrix.add(he,me),fe=Matrix.add(ue,ge),ye=Matrix.sub(de,ue);ye.add(he),ye.add(pe);var we=Matrix.zeros(2*je.rows,2*je.columns);return we=we.setSubMatrix(je,0,0),we=we.setSubMatrix(ke,je.rows,0),we=we.setSubMatrix(fe,0,je.columns),we=we.setSubMatrix(ye,je.rows,je.columns),we.subMatrix(0,K-1,0,G-1)}var R=this.clone(),E=R.rows,P=R.columns,F=u.rows,O=u.columns;P!==F&&console.warn(`Multiplying ${E} x ${P} and ${F} x ${O} matrix: dimensions do not match.`);var W=_Mathmax(E,F),T=_Mathmax(P,O);return R=I(R,W,T),u=I(u,W,T),D(R,u,W,T)}scaleRows(u,I){if(u=void 0===u?0:u,I=void 0===I?1:I,u>=I)throw new RangeError('min should be strictly smaller than max');for(var E,D=this.constructor.empty(this.rows,this.columns),R=0;R<this.rows;R++)E=arrayUtils.scale(this.getRow(R),{min:u,max:I}),D.setRow(R,E);return D}scaleColumns(u,I){if(u=void 0===u?0:u,I=void 0===I?1:I,u>=I)throw new RangeError('min should be strictly smaller than max');for(var E,D=this.constructor.empty(this.rows,this.columns),R=0;R<this.columns;R++)E=arrayUtils.scale(this.getColumn(R),{min:u,max:I}),D.setColumn(R,E);return D}kroneckerProduct(u){u=this.constructor.checkMatrix(u);for(var I=this.rows,D=this.columns,R=u.rows,E=u.columns,P=new this.constructor[Symbol.species](I*R,D*E),F=0;F<I;F++)for(var O=0;O<D;O++)for(var W=0;W<R;W++)for(var T=0;T<E;T++)P[R*F+W][E*O+T]=this.get(F,O)*u.get(W,T);return P}transpose(){for(var u=new this.constructor[Symbol.species](this.columns,this.rows),I=0;I<this.rows;I++)for(var D=0;D<this.columns;D++)u.set(D,I,this.get(I,D));return u}sortRows(u){u===void 0&&(u=compareNumbers);for(var I=0;I<this.rows;I++)this.setRow(I,this.getRow(I).sort(u));return this}sortColumns(u){u===void 0&&(u=compareNumbers);for(var I=0;I<this.columns;I++)this.setColumn(I,this.getColumn(I).sort(u));return this}subMatrix(u,I,D,R){util.checkRange(this,u,I,D,R);for(var E=new this.constructor[Symbol.species](I-u+1,R-D+1),P=u;P<=I;P++)for(var F=D;F<=R;F++)E[P-u][F-D]=this.get(P,F);return E}subMatrixRow(u,I,D){if(void 0===I&&(I=0),void 0===D&&(D=this.columns-1),I>D||0>I||I>=this.columns||0>D||D>=this.columns)throw new RangeError('Argument out of range');for(var R=new this.constructor[Symbol.species](u.length,D-I+1),E=0;E<u.length;E++)for(var P=I;P<=D;P++){if(0>u[E]||u[E]>=this.rows)throw new RangeError('Row index out of range: '+u[E]);R.set(E,P-I,this.get(u[E],P))}return R}subMatrixColumn(u,I,D){if(void 0===I&&(I=0),void 0===D&&(D=this.rows-1),I>D||0>I||I>=this.rows||0>D||D>=this.rows)throw new RangeError('Argument out of range');for(var R=new this.constructor[Symbol.species](D-I+1,u.length),E=0;E<u.length;E++)for(var P=I;P<=D;P++){if(0>u[E]||u[E]>=this.columns)throw new RangeError('Column index out of range: '+u[E]);R.set(P-I,E,this.get(P,u[E]))}return R}setSubMatrix(u,I,D){u=this.constructor.checkMatrix(u);var R=I+u.rows-1,E=D+u.columns-1;util.checkRange(this,I,R,D,E);for(var P=0;P<u.rows;P++)for(var F=0;F<u.columns;F++)this[I+P][D+F]=u.get(P,F);return this}selection(u,I){for(var P,D=util.checkIndices(this,u,I),R=new this.constructor[Symbol.species](u.length,I.length),E=0;E<D.row.length;E++){P=D.row[E];for(var O,F=0;F<D.column.length;F++)O=D.column[F],R[E][F]=this.get(P,O)}return R}trace(){for(var u=_Mathmin(this.rows,this.columns),I=0,D=0;D<u;D++)I+=this.get(D,D);return I}transposeView(){return new MatrixTransposeView(this)}rowView(u){return util.checkRowIndex(this,u),new MatrixRowView(this,u)}columnView(u){return util.checkColumnIndex(this,u),new MatrixColumnView(this,u)}flipRowView(){return new MatrixFlipRowView(this)}flipColumnView(){return new MatrixFlipColumnView(this)}subMatrixView(u,I,D,R){return new MatrixSubView(this,u,I,D,R)}selectionView(u,I){return new MatrixSelectionView(this,u,I)}det(){if(this.isSquare()){var u,I,D,R;if(2===this.columns)return u=this.get(0,0),I=this.get(0,1),D=this.get(1,0),R=this.get(1,1),u*R-I*D;if(3===this.columns){var E,P,F;return E=this.selectionView([1,2],[1,2]),P=this.selectionView([1,2],[0,2]),F=this.selectionView([1,2],[0,1]),u=this.get(0,0),I=this.get(0,1),D=this.get(0,2),u*E.det()-I*P.det()+D*F.det()}return new LuDecomposition(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(u){void 0===u&&(u=Number.EPSILON);for(var I=new SvDecomposition(this,{autoTranspose:!0}),D=I.leftSingularVectors,R=I.rightSingularVectors,E=I.diagonal,P=0;P<E.length;P++)E[P]=_Mathabs(E[P])>u?1/E[P]:0;return E=this.constructor[Symbol.species].diag(E),R.mmul(E.mmul(D.transposeView()))}}Matrix.prototype.klass='Matrix',Matrix.random=Matrix.rand,Matrix.diagonal=Matrix.diag,Matrix.prototype.diagonal=Matrix.prototype.diag,Matrix.identity=Matrix.eye,Matrix.prototype.negate=Matrix.prototype.neg,Matrix.prototype.tensorProduct=Matrix.prototype.kroneckerProduct,Matrix.prototype.determinant=Matrix.prototype.det;var inplaceOperator=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,inplaceOperatorScalar=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,inplaceOperatorMatrix=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,staticOperator=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,inplaceMethod=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,staticMethod=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,inplaceMethodWithArgs=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,staticMethodWithArgs=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,inplaceMethodWithOneArgScalar=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,inplaceMethodWithOneArgMatrix=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,inplaceMethodWithOneArg=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,staticMethodWithOneArg=staticMethodWithArgs,operators=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],i;for(var operator of operators){var inplaceOp=eval(fillTemplateFunction(inplaceOperator,{name:operator[1],op:operator[0]})),inplaceOpS=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[1]+'S',op:operator[0]})),inplaceOpM=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[1]+'M',op:operator[0]})),staticOp=eval(fillTemplateFunction(staticOperator,{name:operator[1]}));for(i=1;i<operator.length;i++)Matrix.prototype[operator[i]]=inplaceOp,Matrix.prototype[operator[i]+'S']=inplaceOpS,Matrix.prototype[operator[i]+'M']=inplaceOpM,Matrix[operator[i]]=staticOp}var methods=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(u){methods.push(['Math.'+u,u])});for(var method of methods){var inplaceMeth=eval(fillTemplateFunction(inplaceMethod,{name:method[1],method:method[0]})),staticMeth=eval(fillTemplateFunction(staticMethod,{name:method[1]}));for(i=1;i<method.length;i++)Matrix.prototype[method[i]]=inplaceMeth,Matrix[method[i]]=staticMeth}var methodsWithArgs=[['Math.pow',1,'pow']];for(var methodWithArg of methodsWithArgs){var args='arg0';for(i=1;i<methodWithArg[1];i++)args+=`, arg${i}`;if(1!==methodWithArg[1]){var inplaceMethWithArgs=eval(fillTemplateFunction(inplaceMethodWithArgs,{name:methodWithArg[2],method:methodWithArg[0],args:args})),staticMethWithArgs=eval(fillTemplateFunction(staticMethodWithArgs,{name:methodWithArg[2],args:args}));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethWithArgs,Matrix[methodWithArg[i]]=staticMethWithArgs}else{var tmplVar={name:methodWithArg[2],args:args,method:methodWithArg[0]},inplaceMethod2=eval(fillTemplateFunction(inplaceMethodWithOneArg,tmplVar)),inplaceMethodS=eval(fillTemplateFunction(inplaceMethodWithOneArgScalar,tmplVar)),inplaceMethodM=eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix,tmplVar)),staticMethod2=eval(fillTemplateFunction(staticMethodWithOneArg,tmplVar));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethod2,Matrix.prototype[methodWithArg[i]+'M']=inplaceMethodM,Matrix.prototype[methodWithArg[i]+'S']=inplaceMethodS,Matrix[methodWithArg[i]]=staticMethod2}}return Matrix}module.exports=abstractMatrix;var LuDecomposition=__webpack_require__(11),SvDecomposition=__webpack_require__(12),arrayUtils=__webpack_require__(25),util=__webpack_require__(2),MatrixTransposeView=__webpack_require__(44),MatrixRowView=__webpack_require__(41),MatrixSubView=__webpack_require__(43),MatrixSelectionView=__webpack_require__(42),MatrixColumnView=__webpack_require__(38),MatrixFlipRowView=__webpack_require__(40),MatrixFlipColumnView=__webpack_require__(39)},function(u,I,D){'use strict';function R(P){if(!(this instanceof R))return new R(P);P=E.Matrix.checkMatrix(P);var Q,K,G,$,ee,te,ne,ie,se,oe,F=P.clone(),O=F.rows,W=F.columns,T=Array(O),Z=1;for(Q=0;Q<O;Q++)T[Q]=Q;for(se=Array(O),K=0;K<W;K++){for(Q=0;Q<O;Q++)se[Q]=F[Q][K];for(Q=0;Q<O;Q++){for(ie=F[Q],oe=_Mathmin(Q,K),ee=0,G=0;G<oe;G++)ee+=ie[G]*se[G];ie[K]=se[Q]-=ee}for($=K,Q=K+1;Q<O;Q++)_Mathabs(se[Q])>_Mathabs(se[$])&&($=Q);if($!==K){for(G=0;G<W;G++)te=F[$][G],F[$][G]=F[K][G],F[K][G]=te;ne=T[$],T[$]=T[K],T[K]=ne,Z=-Z}if(K<O&&0!==F[K][K])for(Q=K+1;Q<O;Q++)F[Q][K]/=F[K][K]}this.LU=F,this.pivotVector=T,this.pivotSign=Z}var E=D(0);R.prototype={isSingular:function(){for(var P=this.LU,F=P.columns,O=0;O<F;O++)if(0===P[O][O])return!0;return!1},get determinant(){var P=this.LU;if(!P.isSquare())throw new Error('Matrix must be square');for(var F=this.pivotSign,O=P.columns,W=0;W<O;W++)F*=P[W][W];return F},get lowerTriangularMatrix(){for(var P=this.LU,F=P.rows,O=P.columns,W=new E.Matrix(F,O),T=0;T<F;T++)for(var Z=0;Z<O;Z++)W[T][Z]=T>Z?P[T][Z]:T===Z?1:0;return W},get upperTriangularMatrix(){for(var P=this.LU,F=P.rows,O=P.columns,W=new E.Matrix(F,O),T=0;T<F;T++)for(var Z=0;Z<O;Z++)W[T][Z]=T<=Z?P[T][Z]:0;return W},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(P){P=E.Matrix.checkMatrix(P);var F=this.LU,O=F.rows;if(O!==P.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var W=P.columns,T=P.subMatrixRow(this.pivotVector,0,W-1),Z=F.columns,Q,K,G;for(G=0;G<Z;G++)for(Q=G+1;Q<Z;Q++)for(K=0;K<W;K++)T[Q][K]-=T[G][K]*F[Q][G];for(G=Z-1;0<=G;G--){for(K=0;K<W;K++)T[G][K]/=F[G][G];for(Q=0;Q<G;Q++)for(K=0;K<W;K++)T[Q][K]-=T[G][K]*F[Q][G]}return T}},u.exports=R},function(u,I,D){'use strict';function R(W,T){if(!(this instanceof R))return new R(W,T);W=E.Matrix.checkMatrix(W),T=T||{};var Z=W.rows,Q=W.columns,K=_Mathmin(Z,Q),G=!0,$=!0;!1===T.computeLeftSingularVectors&&(G=!1),!1===T.computeRightSingularVectors&&($=!1);var ne,ee=!0===T.autoTranspose,te=!1;if(!(Z<Q))ne=W.clone();else if(!ee)ne=W.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{ne=W.transpose(),Z=ne.rows,Q=ne.columns,te=!0;var ie=G;G=$,$=ie}var he,ge,me,pe,xe,je,ke,fe,ye,we,be,ve,Me,Ie,Se,Ce,De,ze,Ve,Re,qe,se=Array(_Mathmin(Z+1,Q)),oe=O(Z,K,0),le=O(Q,Q,0),ae=Array(Q),ce=Array(Z),de=_Mathmin(Z-1,Q),ue=_Mathmax(0,_Mathmin(Q-2,Z));for(me=0,we=_Mathmax(de,ue);me<we;me++){if(me<de){for(se[me]=0,he=me;he<Z;he++)se[me]=F(se[me],ne[he][me]);if(0!==se[me]){for(0>ne[me][me]&&(se[me]=-se[me]),he=me;he<Z;he++)ne[he][me]/=se[me];ne[me][me]+=1}se[me]=-se[me]}for(ge=me+1;ge<Q;ge++){if(me<de&&0!==se[me]){for(xe=0,he=me;he<Z;he++)xe+=ne[he][me]*ne[he][ge];for(xe=-xe/ne[me][me],he=me;he<Z;he++)ne[he][ge]+=xe*ne[he][me]}ae[ge]=ne[me][ge]}if(G&&me<de)for(he=me;he<Z;he++)oe[he][me]=ne[he][me];if(me<ue){for(ae[me]=0,he=me+1;he<Q;he++)ae[me]=F(ae[me],ae[he]);if(0!==ae[me]){for(0>ae[me+1]&&(ae[me]=0-ae[me]),he=me+1;he<Q;he++)ae[he]/=ae[me];ae[me+1]+=1}if(ae[me]=-ae[me],me+1<Z&&0!==ae[me]){for(he=me+1;he<Z;he++)ce[he]=0;for(ge=me+1;ge<Q;ge++)for(he=me+1;he<Z;he++)ce[he]+=ae[ge]*ne[he][ge];for(ge=me+1;ge<Q;ge++)for(xe=-ae[ge]/ae[me+1],he=me+1;he<Z;he++)ne[he][ge]+=xe*ce[he]}if($)for(he=me+1;he<Q;he++)le[he][me]=ae[he]}}if(pe=_Mathmin(Q,Z+1),de<Q&&(se[de]=ne[de][de]),Z<pe&&(se[pe-1]=0),ue+1<pe&&(ae[ue]=ne[ue][pe-1]),ae[pe-1]=0,G){for(ge=de;ge<K;ge++){for(he=0;he<Z;he++)oe[he][ge]=0;oe[ge][ge]=1}for(me=de-1;0<=me;me--)if(0!==se[me]){for(ge=me+1;ge<K;ge++){for(xe=0,he=me;he<Z;he++)xe+=oe[he][me]*oe[he][ge];for(xe=-xe/oe[me][me],he=me;he<Z;he++)oe[he][ge]+=xe*oe[he][me]}for(he=me;he<Z;he++)oe[he][me]=-oe[he][me];for(oe[me][me]=1+oe[me][me],he=0;he<me-1;he++)oe[he][me]=0}else{for(he=0;he<Z;he++)oe[he][me]=0;oe[me][me]=1}}if($)for(me=Q-1;0<=me;me--){if(me<ue&&0!==ae[me])for(ge=me+1;ge<Q;ge++){for(xe=0,he=me+1;he<Q;he++)xe+=le[he][me]*le[he][ge];for(xe=-xe/le[me+1][me],he=me+1;he<Q;he++)le[he][ge]+=xe*le[he][me]}for(he=0;he<Q;he++)le[he][me]=0;le[me][me]=1}for(var Le=pe-1,Ee=0,Pe=2.220446049250313e-16;0<pe;){for(me=pe-2;-1<=me&&-1!==me;me--)if(_Mathabs(ae[me])<=Pe*(_Mathabs(se[me])+_Mathabs(se[me+1]))){ae[me]=0;break}if(me===pe-2)be=4;else{for(je=pe-1;je>=me&&je!==me;je--)if(xe=(je===pe?0:_Mathabs(ae[je]))+(je===me+1?0:_Mathabs(ae[je-1])),_Mathabs(se[je])<=Pe*xe){se[je]=0;break}je===me?be=3:je===pe-1?be=1:(be=2,me=je)}switch(me++,be){case 1:{for(ke=ae[pe-2],ae[pe-2]=0,ge=pe-2;ge>=me;ge--)if(xe=F(se[ge],ke),fe=se[ge]/xe,ye=ke/xe,se[ge]=xe,ge!==me&&(ke=-ye*ae[ge-1],ae[ge-1]=fe*ae[ge-1]),$)for(he=0;he<Q;he++)xe=fe*le[he][ge]+ye*le[he][pe-1],le[he][pe-1]=-ye*le[he][ge]+fe*le[he][pe-1],le[he][ge]=xe;break}case 2:{for(ke=ae[me-1],ae[me-1]=0,ge=me;ge<pe;ge++)if(xe=F(se[ge],ke),fe=se[ge]/xe,ye=ke/xe,se[ge]=xe,ke=-ye*ae[ge],ae[ge]=fe*ae[ge],G)for(he=0;he<Z;he++)xe=fe*oe[he][ge]+ye*oe[he][me-1],oe[he][me-1]=-ye*oe[he][ge]+fe*oe[he][me-1],oe[he][ge]=xe;break}case 3:{for(ve=_Mathmax(_Mathmax(_Mathmax(_Mathmax(_Mathabs(se[pe-1]),_Mathabs(se[pe-2])),_Mathabs(ae[pe-2])),_Mathabs(se[me])),_Mathabs(ae[me])),Me=se[pe-1]/ve,Ie=se[pe-2]/ve,Se=ae[pe-2]/ve,Ce=se[me]/ve,De=ae[me]/ve,ze=((Ie+Me)*(Ie-Me)+Se*Se)/2,Ve=Me*Se*(Me*Se),Re=0,(0!==ze||0!==Ve)&&(Re=_Mathsqrt(ze*ze+Ve),0>ze&&(Re=-Re),Re=Ve/(ze+Re)),ke=(Ce+Me)*(Ce-Me)+Re,qe=Ce*De,ge=me;ge<pe-1;ge++){if(xe=F(ke,qe),fe=ke/xe,ye=qe/xe,ge!==me&&(ae[ge-1]=xe),ke=fe*se[ge]+ye*ae[ge],ae[ge]=fe*ae[ge]-ye*se[ge],qe=ye*se[ge+1],se[ge+1]=fe*se[ge+1],$)for(he=0;he<Q;he++)xe=fe*le[he][ge]+ye*le[he][ge+1],le[he][ge+1]=-ye*le[he][ge]+fe*le[he][ge+1],le[he][ge]=xe;if(xe=F(ke,qe),fe=ke/xe,ye=qe/xe,se[ge]=xe,ke=fe*ae[ge]+ye*se[ge+1],se[ge+1]=-ye*ae[ge]+fe*se[ge+1],qe=ye*ae[ge+1],ae[ge+1]=fe*ae[ge+1],G&&ge<Z-1)for(he=0;he<Z;he++)xe=fe*oe[he][ge]+ye*oe[he][ge+1],oe[he][ge+1]=-ye*oe[he][ge]+fe*oe[he][ge+1],oe[he][ge]=xe}ae[pe-2]=ke,++Ee;break}case 4:{if(0>=se[me]&&(se[me]=0>se[me]?-se[me]:0,$))for(he=0;he<=Le;he++)le[he][me]=-le[he][me];for(;me<Le&&!(se[me]>=se[me+1]);){if(xe=se[me],se[me]=se[me+1],se[me+1]=xe,$&&me<Q-1)for(he=0;he<Q;he++)xe=le[he][me+1],le[he][me+1]=le[he][me],le[he][me]=xe;if(G&&me<Z-1)for(he=0;he<Z;he++)xe=oe[he][me+1],oe[he][me+1]=oe[he][me],oe[he][me]=xe;me++}Ee=0,pe--;break}}}if(te){var Ae=le;le=oe,oe=Ae}this.m=Z,this.n=Q,this.s=se,this.U=oe,this.V=le}var E=D(0),P=D(4),F=P.hypotenuse,O=P.getFilled2DArray;R.prototype={get condition(){return this.s[0]/this.s[_Mathmin(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var T=_Mathmax(this.m,this.n)*this.s[0]*2.220446049250313e-16,Z=0,Q=this.s,K=0,G=Q.length;K<G;K++)Q[K]>T&&Z++;return Z},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*_Mathmax(this.m,this.n)*this.s[0]},get leftSingularVectors(){return E.Matrix.isMatrix(this.U)||(this.U=new E.Matrix(this.U)),this.U},get rightSingularVectors(){return E.Matrix.isMatrix(this.V)||(this.V=new E.Matrix(this.V)),this.V},get diagonalMatrix(){return E.Matrix.diag(this.s)},solve:function(W){var G,Z=this.threshold,Q=this.s.length,K=E.Matrix.zeros(Q,Q);for(G=0;G<Q;G++)K[G][G]=_Mathabs(this.s[G])<=Z?0:1/this.s[G];var $=this.U,ee=this.rightSingularVectors,te=ee.mmul(K),ne=ee.rows,ie=$.length,se=E.Matrix.zeros(ne,ie),oe,le,ae;for(G=0;G<ne;G++)for(oe=0;oe<ie;oe++){for(ae=0,le=0;le<Q;le++)ae+=te[G][le]*$[oe][le];se[G][oe]=ae}return se.mmul(W)},solveForDiagonal:function(W){return this.solve(E.Matrix.diag(W))},inverse:function(){var W=this.V,T=this.threshold,Z=W.length,Q=W[0].length,K=new E.Matrix(Z,this.s.length),G,$;for(G=0;G<Z;G++)for($=0;$<Q;$++)K[G][$]=_Mathabs(this.s[$])>T?W[G][$]/this.s[$]:0;var ee=this.U,te=ee.length,ne=ee[0].length,ie=new E.Matrix(Z,te),se,oe;for(G=0;G<Z;G++)for($=0;$<te;$++){for(oe=0,se=0;se<ne;se++)oe+=K[G][se]*ee[$][se];ie[G][$]=oe}return ie}},u.exports=R},function(module,exports,__webpack_require__){function fillTemplateFunction(u,I){for(var D in I)u=u.replace(new RegExp('%'+D+'%','g'),I[D]);return u}const HashTable=__webpack_require__(28);class SparseMatrix{constructor(u,I,D={}){if(u instanceof SparseMatrix){const F=u;return void this._init(F.rows,F.columns,F.elements.clone(),F.threshold)}if(Array.isArray(u)){const F=u;u=F.length,D=I||{},I=F[0].length,this._init(u,I,new HashTable(D),D.threshold);for(var R=0;R<u;R++)for(var P,E=0;E<I;E++)P=F[R][E],this.threshold&&_Mathabs(P)<this.threshold&&(P=0),0!==P&&this.elements.set(R*I+E,F[R][E])}else this._init(u,I,new HashTable(D),D.threshold)}_init(u,I,D,R){this.rows=u,this.columns=I,this.elements=D,this.threshold=R||0}static eye(u=1,I=u){const D=_Mathmin(u,I),R=new SparseMatrix(u,I,{initialCapacity:D});for(var E=0;E<D;E++)R.set(E,E,1);return R}clone(){return new SparseMatrix(this)}to2DArray(){const u=Array(this.rows);for(var I=0;I<this.rows;I++){u[I]=Array(this.columns);for(var D=0;D<this.columns;D++)u[I][D]=this.get(I,D)}return u}isSquare(){return this.rows===this.columns}isSymmetric(){if(!this.isSquare())return!1;var u=!0;return this.forEachNonZero((I,D,R)=>{return this.get(D,I)===R?R:(u=!1,!1)}),u}get cardinality(){return this.elements.size}get size(){return this.rows*this.columns}get(u,I){return this.elements.get(u*this.columns+I)}set(u,I,D){return this.threshold&&_Mathabs(D)<this.threshold&&(D=0),0===D?this.elements.remove(u*this.columns+I):this.elements.set(u*this.columns+I,D),this}mmul(u){this.columns!==u.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');const I=this.rows,D=u.columns,R=new SparseMatrix(I,D);return this.forEachNonZero((E,P,F)=>{return u.forEachNonZero((O,W,T)=>{return P===O&&R.set(E,W,R.get(E,W)+F*T),T}),F}),R}kroneckerProduct(u){const I=this.rows,D=this.columns,R=u.rows,E=u.columns,P=new SparseMatrix(I*R,D*E,{initialCapacity:this.cardinality*u.cardinality});return this.forEachNonZero((F,O,W)=>{return u.forEachNonZero((T,Z,Q)=>{return P.set(R*F+T,E*O+Z,W*Q),Q}),W}),P}forEachNonZero(u){return this.elements.forEachPair((I,D)=>{const R=0|I/this.columns,E=I%this.columns;let P=u(R,E,D);return!1!==P&&(this.threshold&&_Mathabs(P)<this.threshold&&(P=0),P!==D&&(0===P?this.elements.remove(I,!0):this.elements.set(I,P)),!0)}),this.elements.maybeShrinkCapacity(),this}getNonZeros(){const u=this.cardinality,I=Array(u),D=Array(u),R=Array(u);var E=0;return this.forEachNonZero((P,F,O)=>{return I[E]=P,D[E]=F,R[E]=O,E++,O}),{rows:I,columns:D,values:R}}setThreshold(u){return 0!==u&&u!==this.threshold&&(this.threshold=u,this.forEachNonZero((I,D,R)=>R)),this}}SparseMatrix.prototype.klass='Matrix',SparseMatrix.identity=SparseMatrix.eye,SparseMatrix.prototype.tensorProduct=SparseMatrix.prototype.kroneckerProduct,module.exports=SparseMatrix;var inplaceOperator=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,inplaceOperatorScalar=`
(function %name%S(value) {
    this.forEachNonZero((i, j, v) => v %op% value);
    return this;
})
`,inplaceOperatorMatrix=`
(function %name%M(matrix) {
    matrix.forEachNonZero((i, j, v) => {
        this.set(i, j, this.get(i, j) %op% v);
        return v;
    });
    return this;
})
`,staticOperator=`
(function %name%(matrix, value) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%(value);
})
`,inplaceMethod=`
(function %name%() {
    this.forEachNonZero((i, j, v) => %method%(v));
    return this;
})
`,staticMethod=`
(function %name%(matrix) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%();
})
`,operators=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']];for(var operator of operators)for(var i=1;i<operator.length;i++)SparseMatrix.prototype[operator[i]]=eval(fillTemplateFunction(inplaceOperator,{name:operator[i],op:operator[0]})),SparseMatrix.prototype[operator[i]+'S']=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[i]+'S',op:operator[0]})),SparseMatrix.prototype[operator[i]+'M']=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[i]+'M',op:operator[0]})),SparseMatrix[operator[i]]=eval(fillTemplateFunction(staticOperator,{name:operator[i]}));var methods=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(u){methods.push(['Math.'+u,u])});for(var method of methods)for(var i=1;i<method.length;i++)SparseMatrix.prototype[method[i]]=eval(fillTemplateFunction(inplaceMethod,{name:method[i],method:method[0]})),SparseMatrix[method[i]]=eval(fillTemplateFunction(staticMethod,{name:method[i]}))},function(u,I){'use strict';function R(E,P){return E-P}I.sum=function(P){for(var E=0,F=0;F<P.length;F++)E+=P[F];return E},I.max=function(P){for(var E=P[0],F=P.length,O=1;O<F;O++)P[O]>E&&(E=P[O]);return E},I.min=function(P){for(var E=P[0],F=P.length,O=1;O<F;O++)P[O]<E&&(E=P[O]);return E},I.minMax=function(P){for(var F=P[0],O=P[0],W=P.length,T=1;T<W;T++)P[T]<F&&(F=P[T]),P[T]>O&&(O=P[T]);return{min:F,max:O}},I.arithmeticMean=function(P){for(var F=0,O=P.length,W=0;W<O;W++)F+=P[W];return F/O},I.mean=I.arithmeticMean,I.geometricMean=function(P){for(var F=1,O=P.length,W=0;W<O;W++)F*=P[W];return _Mathpow(F,1/O)},I.logMean=function(P){for(var F=0,O=P.length,W=0;W<O;W++)F+=_Mathlog(P[W]);return F/O},I.grandMean=function(P,F){for(var O=0,W=0,T=P.length,Z=0;Z<T;Z++)O+=F[Z]*P[Z],W+=F[Z];return O/W},I.truncatedMean=function(P,F,O){O===void 0&&(O=!1),O||(P=[].concat(P).sort(R));for(var W=P.length,T=_Mathfloor(W*F),Z=0,Q=T;Q<W-T;Q++)Z+=P[Q];return Z/(W-2*T)},I.harmonicMean=function(P){for(var F=0,O=P.length,W=0;W<O;W++){if(0===P[W])throw new RangeError('value at index '+W+'is zero');F+=1/P[W]}return O/F},I.contraHarmonicMean=function(P){for(var F=0,O=0,W=P.length,T=0;T<W;T++)F+=P[T]*P[T],O+=P[T];if(0>O)throw new RangeError('sum of values is negative');return F/O},I.median=function(P,F){F===void 0&&(F=!1),F||(P=[].concat(P).sort(R));var O=P.length,W=_Mathfloor(O/2);return 0==O%2?0.5*(P[W-1]+P[W]):P[W]},I.variance=function(P,F){F===void 0&&(F=!0);for(var Q,O=I.mean(P),W=0,T=P.length,Z=0;Z<T;Z++)Q=P[Z]-O,W+=Q*Q;return F?W/(T-1):W/T},I.standardDeviation=function(P,F){return _Mathsqrt(I.variance(P,F))},I.standardError=function(P){return I.standardDeviation(P)/_Mathsqrt(P.length)},I.robustMeanAndStdev=function(P){var F=0,O=0,W=P.length,T=0;for(T=0;T<W;T++)F+=P[T];F/=W;var Z=Array(W);for(T=0;T<W;T++)Z[T]=_Mathabs(P[T]-F);return Z.sort(R),O=1==W%2?Z[(W-1)/2]/0.6745:0.5*(Z[W/2]+Z[W/2-1])/0.6745,{mean:F,stdev:O}},I.quartiles=function(P,F){'undefined'==typeof F&&(F=!1),F||(P=[].concat(P).sort(R));var O=P.length/4,W=P[_Mathceil(O)-1],T=I.median(P,!0),Z=P[_Mathceil(3*O)-1];return{q1:W,q2:T,q3:Z}},I.pooledStandardDeviation=function(P,F){return _Mathsqrt(I.pooledVariance(P,F))},I.pooledVariance=function(P,F){'undefined'==typeof F&&(F=!0);for(var O=0,W=0,T=P.length,Z=0;Z<T;Z++){var Q=P[Z],K=I.variance(Q);O+=(Q.length-1)*K,W+=F?Q.length-1:Q.length}return O/W},I.mode=function(P){var W,F=P.length,O=Array(F);for(W=0;W<F;W++)O[W]=0;var T=Array(F),Z=0;for(W=0;W<F;W++){var Q=T.indexOf(P[W]);0<=Q?O[Q]++:(T[Z]=P[W],O[Z]=1,Z++)}var K=0,G=0;for(W=0;W<Z;W++)O[W]>K&&(K=O[W],G=W);return T[G]},I.covariance=function(P,F,O){'undefined'==typeof O&&(O=!0);var W=I.mean(P),T=I.mean(F);if(P.length!==F.length)throw'Vectors do not have the same dimensions';for(var Z=0,Q=P.length,K=0;K<Q;K++){var G=P[K]-W,$=F[K]-T;Z+=G*$}return O?Z/(Q-1):Z/Q},I.skewness=function(P,F){'undefined'==typeof F&&(F=!0);for(var K,O=I.mean(P),W=0,T=0,Z=P.length,Q=0;Q<Z;Q++)K=P[Q]-O,W+=K*K,T+=K*K*K;var G=W/Z,$=T/Z,ee=$/_Mathpow(G,3/2);if(F){var te=_Mathsqrt(Z*(Z-1));return te/(Z-2)*ee}return ee},I.kurtosis=function(P,F){'undefined'==typeof F&&(F=!0);for(var K,O=I.mean(P),W=P.length,T=0,Z=0,Q=0;Q<W;Q++)K=P[Q]-O,T+=K*K,Z+=K*K*K*K;var G=T/W,$=Z/W;if(F){var ee=T/(W-1),ne=Z/(ee*ee);return W*(W+1)/((W-1)*(W-2)*(W-3))*ne-3*((W-1)*(W-1)/((W-2)*(W-3)))}return $/(G*G)-3},I.entropy=function(P,F){'undefined'==typeof F&&(F=0);for(var O=0,W=P.length,T=0;T<W;T++)O+=P[T]*_Mathlog(P[T]+F);return-O},I.weightedMean=function(P,F){for(var O=0,W=P.length,T=0;T<W;T++)O+=P[T]*F[T];return O},I.weightedStandardDeviation=function(P,F){return _Mathsqrt(I.weightedVariance(P,F))},I.weightedVariance=function(P,F){for(var O=I.weightedMean(P,F),W=0,T=P.length,Z=0,Q=0,K=0;K<T;K++){var G=P[K]-O,$=F[K];W+=$*(G*G),Q+=$,Z+=$*$}return W*(Q/(Q*Q-Z))},I.center=function(P,F){'undefined'==typeof F&&(F=!1);var O=P;F||(O=[].concat(P));for(var W=I.mean(O),T=O.length,Z=0;Z<T;Z++)O[Z]-=W},I.standardize=function(P,F,O){'undefined'==typeof F&&(F=I.standardDeviation(P)),'undefined'==typeof O&&(O=!1);for(var W=P.length,T=O?P:Array(W),Z=0;Z<W;Z++)T[Z]=P[Z]/F;return T},I.cumulativeSum=function(P){var F=P.length,O=Array(F);O[0]=P[0];for(var W=1;W<F;W++)O[W]=O[W-1]+P[W];return O}},function(u,I,D){'use strict';I.array=D(14),I.matrix=D(46)},function(u,I,D){'use strict';function R(P){if('number'!=typeof P||E(P))throw new TypeError('Expected a number')}var E=D(47);I.asc=function(P,F){return R(P),R(F),P-F},I.desc=function(P,F){return R(P),R(F),F-P}},function(u,I,D){'use strict';var R=D(5),E=D(6),P=D(45),F=D(32);class O{constructor(W,T,Z){this.chemicalShifts=W,this.couplingConstants=T,this.multiplicity=Z,this.nSpins=W.length,this._initConnectivity(),this._initClusters()}static fromSpinusPrediction(W){for(var te,T=W.split('\n'),Z=T.length-1,Q=Array(Z),K=Array(Z),G={},$=R.zeros(Z,Z),ee=0;ee<Z;ee++)te=T[ee].split('\t'),Q[ee]=+te[2],G[te[0]-1]=ee,K[ee]=+te[5];for(var ne=0;ne<Z;ne++){te=T[ne].split('\t');var ie=(te.length-4)/3;for(le=0;le<ie;le++){var se=te[4+3*le]-1,oe=G[se];$[ne][oe]=+te[6+3*le]}}for(var le=0;le<Z;le++)for(var ae=le;ae<Z;ae++)$[le][ae]=$[ae][le];return new O(Q,$,E(Z,2))}static fromPrediction(W){var T=O.ungroupAtoms(W),Z=T.length,Q=Array(Z),K=R.zeros(Z,Z),G=Array(Z),$={},ee,te,ne;for(ee=0;ee<Z;ee++)Q[ee]=T[ee].delta,$[T[ee].atomIDs[0]]=ee;for(ee=0;ee<Z;ee++){for(Q[ee]=T[ee].delta,ne=T[ee].j,te=0;te<ne.length;te++)K[$[T[ee].atomIDs[0]]][$[ne[te].assignment]]=ne[te].coupling,K[$[ne[te].assignment]][$[T[ee].atomIDs[0]]]=ne[te].coupling;G[ee]=T[ee].integral+1}return new O(Q,K,G)}static ungroupAtoms(W){var T=[];return W.forEach((Z)=>{for(var G,Q=Z.atomIDs,K=0;K<Q.length;K++)G=JSON.parse(JSON.stringify(Z)),G.atomIDs=[Q[K]],G.integral=1,T.push(G)}),T}_initClusters(){this.clusters=P(this.connectivity,{out:'indexes'})}_initConnectivity(){for(var W=this.couplingConstants,T=R.ones(W.length,W.length),Z=0;Z<W.length;Z++)for(var Q=Z;Q<W[Z].length;Q++)0===W[Z][Q]&&(T[Z][Q]=0,T[Q][Z]=0);this.connectivity=T}_calculateBetas(W,T){var Z=R.zeros(W.length,W.length),Q,K;for(Q=0;Q<W.rows;Q++)for(K=Q;K<W.columns;K++)0==this.chemicalShifts[Q]-this.chemicalShifts[K]?Q!==K&&0===W[Q][K]&&(Z[Q][K]=1,Z[K][Q]=1):(Z[Q][K]=1-_Mathabs(W[Q][K]/((this.chemicalShifts[Q]-this.chemicalShifts[K])*T)),Z[K][Q]=Z[Q][K]);return Z}ensureClusterSize(W){var T=this._calculateBetas(this.couplingConstants,W.frequency||400),Z=F.agnes(T,{isDistanceMatrix:!0}),Q=[];this._splitCluster(Z,Q,W.maxClusterSize||8,!1);var K=this._mergeClusters(Q);this.nClusters=K.length,this.clusters=Array(K.length);for(var G=0;G<this.nClusters;G++){this.clusters[G]=[];for(var $=0;$<this.nSpins;$++)0!==K[G][$]&&(0>K[G][$]?this.clusters[G].push(-($+1)):this.clusters[G].push($))}}_splitCluster(W,T,Z,Q){if(!Q&&W.index.length<=Z)T.push(this._getMembers(W));else{var K=!0,G=!1,$;try{for(var te,ne,ee=W.children[Symbol.iterator]();!(K=(te=ee.next()).done);K=!0)if(ne=te.value,!isNaN(ne.index)||ne.index.length<=Z){for(var ie=this._getMembers(ne),se=0,oe=0;oe<this.nSpins;oe++)if(1===ie[oe]){se++;for(var le=0;le<this.nSpins;le++)1===this.connectivity[oe][le]&&0===ie[le]&&(ie[le]=-1,se++)}se<=Z?T.push(ie):isNaN(ne.index)?this._splitCluster(ne,T,Z,!0):(ie[ne.index]=2,T.push(ie))}else this._splitCluster(ne,T,Z,!1)}catch(ae){G=!0,$=ae}finally{try{!K&&ee.return&&ee.return()}finally{if(G)throw $}}}}_getMembers(W){for(var T=Array(this.nSpins),Z=0;Z<this.nSpins;Z++)T[Z]=0;if(!isNaN(W.index))T[1*W.index]=1;else{var Q=!0,K=!1,G;try{for(var ee,te,$=W.index[Symbol.iterator]();!(Q=(ee=$.next()).done);Q=!0)te=ee.value,T[1*te.index]=1}catch(ne){K=!0,G=ne}finally{try{!Q&&$.return&&$.return()}finally{if(K)throw G}}}return T}_mergeClusters(W){var T=0,Z,Q,K,G,$,ee,te;for(K=W.length-1;0<=K;K--){for(Z=W[K],T=Z.length,$=0;$<T&&-1!==Z[$++];);if($<T)for(G=W.length-1;G>=K+1;G--){for(Q=W[G],$=0,ee=0,te=0;$<T;)-1==Z[$]*Q[$]&&ee++,(0!==Z[$]||0!==Q[$])&&te++,$++;if(0<ee&&te<=this.maxClusterSize){for($=0;$<T;)1===Q[$]?Z[$]=1:-1===Q[$]&&1!==Z[$]&&(Z[$]=-1),$++;W.splice(G,1),G++}}}return W}}u.exports=O},function(u,I,D){'use strict';function E(ee,te,ne,ie,se,oe,le){for(var ae=0|oe*(-te-ie)/(se-ie),ce=le.length,de=0,ue=0,he=ae-ce/2;he<ae+ce/2;he++)de=0|he,0<=he&&he<oe&&(ee[de]+=le[ue]*ne),ue++}function P(ee,te){ee.forEachNonZero((ne,ie,se)=>{return ne>ie?0:_Mathabs(se)<=te?0:se})}function F(ee,te,ne,ie,se){for(var oe=1,le=0;le<se.length;le++)oe*=ne[se[le]];for(var ae=new T(oe,oe),ce=0;ce<se.length;ce++){for(var de=se[ce],ue=G(ne[de]),he=void 0,ge=void 0,me=1,pe=0;pe<ce;pe++)me*=ne[se[pe]];he=T.eye(me),me=1;for(var xe=ce+1;xe<se.length;xe++)me*=ne[se[xe]];ge=T.eye(me);var je=ee[de],ke=he.kroneckerProduct(ue.z).kroneckerProduct(ge);ae.add(ke.mul(je));for(var ye,fe=0;fe<se.length;fe++)if(ye=se[fe],1===ie[de][ye]){for(var we=G(ne[ye]),be=void 0,ve=void 0,Me=1,Ie=0;Ie<fe;Ie++)Me*=ne[se[Ie]];be=T.eye(Me),Me=1;for(var Se=fe+1;Se<se.length;Se++)Me*=ne[se[Se]];ve=T.eye(Me);var Ce=he.kroneckerProduct(ue.x).kroneckerProduct(ge).mmul(be.kroneckerProduct(we.x).kroneckerProduct(ve));Ce.add(he.kroneckerProduct(ue.y).kroneckerProduct(ge).mul(-1).mmul(be.kroneckerProduct(we.y).kroneckerProduct(ve))),Ce.add(he.kroneckerProduct(ue.z).kroneckerProduct(ge).mmul(be.kroneckerProduct(we.z).kroneckerProduct(ve))),ae.add(Ce.mul(te[de][ye]/2))}}return ae}function O(ee,te,ne){for(var ie=Array(ne),oe=0;oe<ne;oe++)ie[oe]=ee+oe*((te-ee)/(ne-1));return ie}var W=D(5),T=D(13),Z=D(7),Q=D(16).asc,K=D(6),G=D(20),$=0.01;u.exports=function(ee,te){var ne,ie,se=te.frequency||400,oe=(te.from||0)*se,le=(te.to||10)*se,ae=te.lineWidth||1,ce=te.nbPoints||1024,de=te.maxClusterSize||10,ue=te.output||'y',he=ee.chemicalShifts.slice();for(ne=0;ne<he.length;ne++)he[ne]*=se;var ge=ce*ae/_Mathabs(le-oe)/2.355,me=20*ge,pe=0|me,xe=Array(pe),je=me/2;for(ne=0;ne<pe;ne++)xe[ne]=1e12*_Mathexp(-((ne-je)*(ne-je))/(2*(ge*ge)));for(var fe=new K(ce,0),ye=ee.multiplicity,we=function(){var Re=ee.clusters[be];for(ve=Array(Re.length),ne=0;ne<Re.length;ne++)ve[ne]=0>Re[ne]?-Re[ne]-1:Re[ne];Me=1,Ie=0;var qe=[],Le=[];if(Re.length>de){for(Se=0;0>Re[Se++];);for(Se=Re[Se-1],qe.push(-he[Se]),ne=0;ne<Re.length;ne++)if(0>Re[ne])for(De=ee.couplingConstants[Se][ve[ne]]/2,Ce=qe.length,ie=0;ie<Ce;ie++)qe.push(qe[ie]+De),qe[ie]-=De;for(qe.sort(Q),Ie=qe.length,Me=1,ne=0;ne<Ie;ne++)Le.push(1)}else{var Ee=F(he,ee.couplingConstants,ye,ee.connectivity,ve),Pe=Ee.rows,Ae=new W.DC.EVD(Ee),Fe=Ae.eigenvectorMatrix,_e=Ae.realEigenvalues,Oe=new T(Pe,Pe),Ue=Re.length;for(Me=0,ze=0;ze<Ue;ze++){var Ne=G(ye[ve[ze]]),We=1;for(ie=0;ie<ze;ie++)We*=ye[ve[ie]];var Te=T.eye(We);for(We=1,ie=ze+1;ie<Ue;ie++)We*=ye[ve[ie]];var Xe=T.eye(We),Ye=Te.kroneckerProduct(Ne.m).kroneckerProduct(Xe);0<=Re[ze]?(Oe.add(Ye.mul(Re[ze]+1)),Me++):Oe.add(Ye.mul(Re[ze]))}var Ze=W.zeros(Pe,Pe);Oe.forEachNonZero((et,tt,nt)=>{if(0<nt)for(var it=Fe[tt],st=0;st<it.length;st++)0!==it[st]&&Ze.set(et,st,Ze.get(et,st)+it[st]);return nt});var He=Ze.clone();Oe.forEachNonZero((et,tt,nt)=>{if(0>nt)for(var it=Fe[tt],st=0;st<it.length;st++)0!==it[st]&&He.set(et,st,He.get(et,st)+it[st]);return nt});var Be=Fe.transpose();Ze=Be.mmul(Ze),Ze=new T(Ze,{threshold:$}),P(Ze,$),He=Be.mmul(He),He=new T(He,{threshold:$}),P(He,$),He.forEachNonZero((et,tt,nt)=>{var it=Ze.get(et,tt);it=_Mathmin(_Mathabs(it),_Mathabs(nt)),it*=it,Ie+=it;var st=_e[et]-_e[tt],ot=Z(qe,st,Q);0>ot?(qe.splice(-1-ot,0,st),Le.splice(-1-ot,0,it)):Le[ot]+=it})}var Qe=qe.length;if(0<Qe){Me/=Ie;var Je=qe[0],Ge=Le[0],$e=1;for(ne=1;ne<Qe;ne++)_Mathabs(qe[ne]-Je/$e)<ae/32?(Ge+=Le[ne],Je+=qe[ne],$e++):(E(fe,Je/$e,Ge*Me,oe,le,ce,xe),Je=qe[ne],Ge=Le[ne],$e=1);E(fe,Je/$e,Ge*Me,oe,le,ce,xe)}},be=0;be<ee.clusters.length;be++){var ve,Me,Ie,Se,Ce,De,ze;we()}if('xy'===ue)return{x:O(te.from,te.to,ce),y:fe};if('y'===ue)return fe;throw new RangeError('wrong output option')}},function(u,I,D){'use strict';function E(W,T,Z,Q){return((W-T)*Q-1)/(Z-T)}function P(W,T){for(var Z=4,Q=_Mathmax(0,_Mathround(T.x-T.widthX*Z)),K=_Mathmin(W[0].length-1,_Mathround(T.x+T.widthX*Z)),G=_Mathmax(0,_Mathround(T.y-T.widthY*Z)),$=_Mathmin(W.length-1,_Mathround(T.y+T.widthY*Z)),ee=T.widthX*T.widthX,te=T.widthY*T.widthY,ne=G;ne<$;ne++)for(var ie=Q;ie<K;ie++){var se=_Mathpow(T.x-ie,2)/ee+_Mathpow(T.y-ne,2)/te,oe=1e4*T.z*_Mathexp(-se);W[ne][ie]+=oe}}var F=D(5),O={H:{frequency:400,lineWidth:10},C:{frequency:100,lineWidth:10}};u.exports=function(W,T){var Z,Q=W[0].fromAtomLabel,K=W[0].toLabel,G=T.frequencyX||O[Q].frequency,$=T.frequencyY||O[K].frequency,ee=T.lineWidthX||O[Q].lineWidth,te=T.lineWidthY||O[K].lineWidth,se=W[0].fromChemicalShift,oe=W[0].fromChemicalShift,le=W[0].toChemicalShift,ae=W[0].toChemicalShift;for(Z=1;Z<W.length;)se=_Mathmin(se,W[Z].fromChemicalShift),oe=_Mathmax(oe,W[Z].fromChemicalShift),le=_Mathmin(le,W[Z].toChemicalShift),ae=_Mathmax(ae,W[Z].toChemicalShift),Z++;null===T.firstX||isNaN(T.firstX)||(se=T.firstX),null===T.firstY||isNaN(T.firstY)||(le=T.firstY),null===T.lastX||isNaN(T.lastX)||(oe=T.lastX),null===T.lastY||isNaN(T.lastY)||(ae=T.lastY);var ce=T.nbPointsX||512,de=T.nbPointsY||512,ue=new F(de,ce).fill(0);for(Z=0;Z<W.length;){var he={x:E(W[Z].fromChemicalShift,se,oe,ce),y:E(W[Z].toChemicalShift,le,ae,de),z:W[Z].fromAtoms.length+W[Z].toAtoms.length,widthX:E(ee/G+se,se,oe,ce),widthY:E(te/$+le,le,ae,de)};P(ue,he),Z++}return ue}},function(u,I,D){'use strict';function R(W){for(var T=(W-1)/2,Z=Array(W),Q=Array(W),K=0;K<W;K++)Z[K]=W-1-K-T,Q[K]=_Mathsqrt(T*(T+1)-Z[K]*(Z[K]+1));var G=E(Q,1,W,W);for(K=0;K<W;K++)Q[K]=_Mathsqrt(T*(T+1)-Z[K]*(Z[K]-1));var $=E(Q,-1,W,W),ee=G.clone().add($).mul(0.5),te=$.clone().mul(-1).add(G).mul(-0.5),ne=E(Z,0,W,W);return{x:ee,y:te,z:ne,m:$,p:G}}function E(W,T,Z,Q){for(var K=new F(Z,Q,{initialCapacity:20}),G=0;G<W.length;G++)0<=G-T&&G-T<Z&&G<Q&&K.set(G-T,G,W[G]);return K}var F=D(13),O=R(2);u.exports=function(W){return 2===W?O:R(W)}},function(u,I,D){u.exports=D(22)},function(u,I){var R,E,P;(function(){var F,O,W,T,Z,Q,K,G,$,ee,te,ne,ie,se,oe;W=_Mathfloor,ee=_Mathmin,O=function(le,ae){return le<ae?-1:le>ae?1:0},$=function(le,ae,ce,de,ue){var he;if(null==ce&&(ce=0),null==ue&&(ue=O),0>ce)throw new Error('lo must be non-negative');for(null==de&&(de=le.length);ce<de;)he=W((ce+de)/2),0>ue(ae,le[he])?de=he:ce=he+1;return[].splice.apply(le,[ce,ce-ce].concat(ae)),ae},Q=function(le,ae,ce){return null==ce&&(ce=O),le.push(ae),se(le,0,le.length-1,ce)},Z=function(le,ae){var ce,de;return null==ae&&(ae=O),ce=le.pop(),le.length?(de=le[0],le[0]=ce,oe(le,0,ae)):de=ce,de},G=function(le,ae,ce){var de;return null==ce&&(ce=O),de=le[0],le[0]=ae,oe(le,0,ce),de},K=function(le,ae,ce){var de;return null==ce&&(ce=O),le.length&&0>ce(le[0],ae)&&(de=[le[0],ae],ae=de[0],le[0]=de[1],oe(le,0,ce)),ae},T=function(le,ae){var ce,de,he,me,pe,xe;for(null==ae&&(ae=O),me=function(){xe=[];for(var je=0,ke=W(le.length/2);0<=ke?je<ke:je>ke;0<=ke?je++:je--)xe.push(je);return xe}.apply(this).reverse(),pe=[],(de=0,he=me.length);de<he;de++)ce=me[de],pe.push(oe(le,ce,ae));return pe},ie=function(le,ae,ce){var de;if(null==ce&&(ce=O),de=le.indexOf(ae),-1!==de)return se(le,0,de,ce),oe(le,de,ce)},te=function(le,ae,ce){var de,ue,he,ge,me;if(null==ce&&(ce=O),ue=le.slice(0,ae),!ue.length)return ue;for(T(ue,ce),me=le.slice(ae),(he=0,ge=me.length);he<ge;he++)de=me[he],K(ue,de,ce);return ue.sort(ce).reverse()},ne=function(le,ae,ce){var de,ue,he,ge,me,pe,xe,je,ke,fe;if(null==ce&&(ce=O),10*ae<=le.length){if(ge=le.slice(0,ae).sort(ce),!ge.length)return ge;for(he=ge[ge.length-1],je=le.slice(ae),(me=0,xe=je.length);me<xe;me++)de=je[me],0>ce(de,he)&&($(ge,de,0,null,ce),ge.pop(),he=ge[ge.length-1]);return ge}for(T(le,ce),fe=[],(ue=pe=0,ke=ee(ae,le.length));0<=ke?pe<ke:pe>ke;ue=0<=ke?++pe:--pe)fe.push(Z(le,ce));return fe},se=function(le,ae,ce,de){var ue,he,ge;for(null==de&&(de=O),ue=le[ce];ce>ae;){if(ge=ce-1>>1,he=le[ge],0>de(ue,he)){le[ce]=he,ce=ge;continue}break}return le[ce]=ue},oe=function(le,ae,ce){var de,ue,he,ge,me;for(null==ce&&(ce=O),ue=le.length,me=ae,he=le[ae],de=2*ae+1;de<ue;)ge=de+1,ge<ue&&!(0>ce(le[de],le[ge]))&&(de=ge),le[ae]=le[de],ae=de,de=2*ae+1;return le[ae]=he,se(le,me,ae,ce)},F=function(){function le(ae){this.cmp=null==ae?O:ae,this.nodes=[]}return le.push=Q,le.pop=Z,le.replace=G,le.pushpop=K,le.heapify=T,le.updateItem=ie,le.nlargest=te,le.nsmallest=ne,le.prototype.push=function(ae){return Q(this.nodes,ae,this.cmp)},le.prototype.pop=function(){return Z(this.nodes,this.cmp)},le.prototype.peek=function(){return this.nodes[0]},le.prototype.contains=function(ae){return-1!==this.nodes.indexOf(ae)},le.prototype.replace=function(ae){return G(this.nodes,ae,this.cmp)},le.prototype.pushpop=function(ae){return K(this.nodes,ae,this.cmp)},le.prototype.heapify=function(){return T(this.nodes,this.cmp)},le.prototype.updateItem=function(ae){return ie(this.nodes,ae,this.cmp)},le.prototype.clear=function(){return this.nodes=[]},le.prototype.empty=function(){return 0===this.nodes.length},le.prototype.size=function(){return this.nodes.length},le.prototype.clone=function(){var ae;return ae=new le,ae.nodes=this.nodes.slice(0),ae},le.prototype.toArray=function(){return this.nodes.slice(0)},le.prototype.insert=le.prototype.push,le.prototype.top=le.prototype.peek,le.prototype.front=le.prototype.peek,le.prototype.has=le.prototype.contains,le.prototype.copy=le.prototype.clone,le}(),function(le,ae){return E=[],R=ae,P='function'==typeof R?R.apply(I,E):R,!(void 0!==P&&(u.exports=P))}(this,function(){return F})}).call(this)},function(u,I,D){'use strict';function F(Q){for(var K=Array(Q[0].length),G=0;G<K.length;++G)K[G]=Array(Q.length);for(G=0;G<Q.length;++G)for(var $=0;$<Q[0].length;++$)K[$][G]=Q[G][$];return K}const Z=D(15).array;u.exports={coordArrayToPoints:function(Q,K){if(0!=Q.length%K)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var ne,G=Q.length/K,$=Array(G),ee=0,te=0;te<Q.length;te+=K){ne=Array(K);for(var ie=0;ie<K;++ie)ne[ie]=Q[te+ie];$[ee]=ne,ee++}return $},coordArrayToCoordMatrix:function(Q,K){if(0!=Q.length%K)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var G=Array(K),$=Q.length/K,ee=0;ee<G.length;ee++)G[ee]=Array($);for(ee=0;ee<Q.length;ee+=K)for(var ne,te=0;te<K;++te)ne=_Mathfloor(ee/K),G[te][ne]=Q[ee+te];return G},coordMatrixToCoordArray:function(Q){for(var K=Array(Q.length*Q[0].length),G=0,$=0;$<Q[0].length;++$)for(var ee=0;ee<Q.length;++ee)K[G]=Q[ee][$],++G;return K},coordMatrixToPoints:F,pointsToCoordArray:function(Q){for(var K=Array(Q.length*Q[0].length),G=0,$=0;$<Q.length;++$)for(var ee=0;ee<Q[0].length;++ee)K[G]=Q[$][ee],++G;return K},pointsToCoordMatrix:F,applyDotProduct:function(Q,K){var G,$;Q.length<=K.length?($=Q,G=K):($=K,G=Q);for(var ie,ee=G.length-$.length+1,te=Array(ee),ne=0;ne<ee;++ne){ie=0;for(var se=0;se<$.length;++se)ie+=$[se]*G[ne+se];te[ne]=ie}return te},scale:function(Q,K){var G=K.inPlace?Q:Array(Q.length);const $=K.max,ee=K.min;if('number'==typeof $){if('number'==typeof ee)for(var te=Z.minMax(Q),ne=($-ee)/(te.max-te.min),ie=0;ie<G.length;ie++)G[ie]=(Q[ie]-te.min)*ne+ee;else for(var se=Z.max(Q),ne=$/se,ie=0;ie<G.length;ie++)G[ie]=Q[ie]*ne;}else if('number'==typeof ee)for(var se=Z.min(Q),ne=ee/se,ie=0;ie<G.length;ie++)G[ie]=Q[ie]*ne;return G}}},function(u,I){'use strict';function E(O,W,T,Z,Q){function K(ye,we,be,ve){return(ve-we)/(be-ye)}var G=O.length,$=(Z-T)/(Q-1),te=T-$/2,ne=Array(Q),ie=O[1]-O[0],se=O[O.length-1]-O[O.length-2],oe=te,le=te+$,ae=Number.MIN_VALUE,ce=0,de=O[0]-ie,ue=0,he=0,ge=0,me=0,pe=0,xe=0,je=0,ke=0;main:for(;;){for(;0<=de-le;){var fe=F(0,le-ae,ge,ce);if(xe=he+fe,ne[ke]=(xe-pe)/$,ke++,ke===Q)break main;oe=le,le+=$,pe=xe}ae<=oe&&oe<=de&&(fe=F(0,oe-ae,ge,ce),pe=he+fe),he+=F(ae,de,ge,me),ae=de,ce=ue,je<G?(de=O[je],ue=W[je],je++):je===G&&(de+=se,ue=0),ge=K(ae,ce,de,ue),me=-ge*ae+ce}return ne}function P(O,W,T,Z,Q){var K=O.length,G=(Z-T)/(Q-1),ee=O[O.length-1]-O[O.length-2],te=T-G/2,ne=Array(Q),ie=te,se=te+G,oe=-_NumberMAX_VALUE,le=0,ae=O[0],ce=W[0],de=0,ue=!0,he=0,ge=0,me=1,pe=0;main:for(;;){if(oe>=ae)throw new Error('x must be an increasing serie');for(;0<oe-se;){if(ue&&(ge++,ue=!1),ne[pe]=0>=ge?0:he/ge,pe++,pe===Q)break main;ie=se,se+=G,he=0,ge=0}oe>ie&&(he+=le,ge++),(oe==-_NumberMAX_VALUE||1<de)&&ge--,oe=ae,le=ce,me<K?(ae=O[me],ce=W[me],me++):(ae+=ee,ce=0,de++)}return ne}function F(O,W,T,Z){return 0.5*T*W*W+Z*W-(0.5*T*O*O+Z*O)}I.getEquallySpacedData=function(O,W,T){1<O.length&&O[0]>O[1]&&(O=O.slice().reverse(),W=W.slice().reverse());var Z=O.length;if(Z!==W.length)throw new RangeError('the x and y vector doesn\'t have the same size.');T===void 0&&(T={});var Q=T.from===void 0?O[0]:T.from;if(isNaN(Q)||!isFinite(Q))throw new RangeError('\'From\' value must be a number');var K=T.to===void 0?O[O.length-1]:T.to;if(isNaN(K)||!isFinite(K))throw new RangeError('\'To\' value must be a number');var G=Q>K;if(G){var $=Q;Q=K,K=$}var ee=T.numberOfPoints===void 0?100:T.numberOfPoints;if(isNaN(ee)||!isFinite(ee))throw new RangeError('\'Number of points\' value must be a number');if(1>ee)throw new RangeError('the number of point must be higher than 1');var te='slot'===T.variant?'slot':'smooth',ne='slot'==te?P(O,W,Q,K,ee):E(O,W,Q,K,ee);return G?ne.reverse():ne},I.integral=F},function(u,I,D){u.exports=I=D(23),I.getEquallySpacedData=D(24).getEquallySpacedData,I.SNV=D(26).SNV},function(u,I,D){'use strict';I.SNV=function(P){for(var F=E.mean(P),O=E.standardDeviation(P),W=P.slice(),T=0;T<P.length;T++)W[T]=(W[T]-F)/O;return W};var E=D(15).array},function(u){'use strict';u.exports=function(E,P){const F=E.length;let O=Array.from({length:F}).map(()=>Array.from({length:F}));for(let W=0;W<F;W++)for(let T=0;T<=W;T++)O[W][T]=P(E[W],E[T]);for(let W=0;W<F;W++)for(let T=W+1;T<F;T++)O[W][T]=O[T][W];return O}},function(u,I,D){'use strict';function R(ie,se){return 0|ie*se}function E(ie,se){return _Mathmin(ie-2,0|ie*se)}function P(ie,se,oe){return T(_Mathmax(ie+1,0|4*ie/(3*se+oe)))}function F(ie,se,oe){return T(_Mathmax(ie+1,0|4*ie/(se+3*oe)))}const O=D(6),W=D(29),T=W.nextPrime,Z=W.largestPrime,Q=0,K=1,G=2;class ne{constructor(ie={}){if(ie instanceof ne)return this.table=ie.table.slice(),this.values=ie.values.slice(),this.state=ie.state.slice(),this.minLoadFactor=ie.minLoadFactor,this.maxLoadFactor=ie.maxLoadFactor,this.distinct=ie.distinct,this.freeEntries=ie.freeEntries,this.lowWaterMark=ie.lowWaterMark,void(this.highWaterMark=ie.maxLoadFactor);const se=ie.initialCapacity===void 0?150:ie.initialCapacity;if(0>se)throw new RangeError(`initial capacity must not be less than zero: ${se}`);const oe=ie.minLoadFactor===void 0?1/6:ie.minLoadFactor,le=ie.maxLoadFactor===void 0?2/3:ie.maxLoadFactor;if(0>oe||1<=oe)throw new RangeError(`invalid minLoadFactor: ${oe}`);if(0>=le||1<=le)throw new RangeError(`invalid maxLoadFactor: ${le}`);if(oe>=le)throw new RangeError(`minLoadFactor (${oe}) must be smaller than maxLoadFactor (${le})`);let ae=se;ae=0|ae/le,ae=T(ae),0===ae&&(ae=1),this.table=O(ae,0),this.values=O(ae,0),this.state=O(ae,0),this.minLoadFactor=oe,this.maxLoadFactor=ae===Z?1:le,this.distinct=0,this.freeEntries=ae,this.lowWaterMark=0,this.highWaterMark=E(ae,this.maxLoadFactor)}clone(){return new ne(this)}get size(){return this.distinct}get(ie){const se=this.indexOfKey(ie);return 0>se?0:this.values[se]}set(ie,se){let oe=this.indexOfInsertion(ie);if(0>oe)return oe=-oe-1,this.values[oe]=se,!1;if(this.distinct>this.highWaterMark){const le=P(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);return this.rehash(le),this.set(ie,se)}if(this.table[oe]=ie,this.values[oe]=se,this.state[oe]===Q&&this.freeEntries--,this.state[oe]=K,this.distinct++,1>this.freeEntries){const le=P(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);this.rehash(le)}return!0}remove(ie,se){const oe=this.indexOfKey(ie);return!(0>oe)&&(this.state[oe]=G,this.distinct--,se||this.maybeShrinkCapacity(),!0)}delete(ie,se){const oe=this.indexOfKey(ie);return!(0>oe)&&(this.state[oe]=Q,this.distinct--,se||this.maybeShrinkCapacity(),!0)}maybeShrinkCapacity(){if(this.distinct<this.lowWaterMark){const ie=F(this.distinct,this.minLoadFactor,this.maxLoadFactor);this.rehash(ie)}}containsKey(ie){return 0<=this.indexOfKey(ie)}indexOfKey(ie){const se=this.table,oe=this.state,le=this.table.length,ae=2147483647&ie;let ce=ae%le,de=ae%(le-2);for(0==de&&(de=1);oe[ce]!==Q&&(oe[ce]===G||se[ce]!==ie);)ce-=de,0>ce&&(ce+=le);return oe[ce]===Q?-1:ce}containsValue(ie){return 0<=this.indexOfValue(ie)}indexOfValue(ie){const se=this.values,oe=this.state;for(var le=0;le<oe.length;le++)if(oe[le]===K&&se[le]===ie)return le;return-1}indexOfInsertion(ie){const se=this.table,oe=this.state,le=se.length,ae=2147483647&ie;let ce=ae%le,de=ae%(le-2);for(0==de&&(de=1);oe[ce]===K&&se[ce]!==ie;)ce-=de,0>ce&&(ce+=le);if(oe[ce]===G){const ue=ce;for(;oe[ce]!==Q&&(oe[ce]===G||se[ce]!==ie);)ce-=de,0>ce&&(ce+=le);oe[ce]===Q&&(ce=ue)}return oe[ce]===K?-ce-1:ce}ensureCapacity(ie){if(this.table.length<ie){const se=T(ie);this.rehash(se)}}rehash(ie){const se=this.table.length;if(ie<=this.distinct)throw new Error('Unexpected');const oe=this.table,le=this.values,ae=this.state,ce=O(ie,0),de=O(ie,0),ue=O(ie,0);this.lowWaterMark=R(ie,this.minLoadFactor),this.highWaterMark=E(ie,this.maxLoadFactor),this.table=ce,this.values=de,this.state=ue,this.freeEntries=ie-this.distinct;for(var he=0;he<se;he++)if(ae[he]===K){var ge=oe[he],me=this.indexOfInsertion(ge);ce[me]=ge,de[me]=le[he],ue[me]=K}}forEachKey(ie){for(var se=0;se<this.state.length;se++)if(this.state[se]===K&&!ie(this.table[se]))return!1;return!0}forEachValue(ie){for(var se=0;se<this.state.length;se++)if(this.state[se]===K&&!ie(this.values[se]))return!1;return!0}forEachPair(ie){for(var se=0;se<this.state.length;se++)if(this.state[se]===K&&!ie(this.table[se],this.values[se]))return!1;return!0}}u.exports=ne},function(u,I,D){const E=D(7),P=D(16).asc,F=2147483647,O=[F,5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939,210719881,421439783,842879579,1685759167,433,877,1759,3527,7057,14143,28289,56591,113189,226379,452759,905551,1811107,3622219,7244441,14488931,28977863,57955739,115911563,231823147,463646329,927292699,1854585413,953,1907,3821,7643,15287,30577,61169,122347,244703,489407,978821,1957651,3915341,7830701,15661423,31322867,62645741,125291483,250582987,501165979,1002331963,2004663929,1039,2081,4177,8363,16729,33461,66923,133853,267713,535481,1070981,2141977,4283963,8567929,17135863,34271747,68543509,137087021,274174111,548348231,1096696463,31,67,137,277,557,1117,2237,4481,8963,17929,35863,71741,143483,286973,573953,1147921,2295859,4591721,9183457,18366923,36733847,73467739,146935499,293871013,587742049,1175484103,599,1201,2411,4831,9677,19373,38747,77509,155027,310081,620171,1240361,2480729,4961459,9922933,19845871,39691759,79383533,158767069,317534141,635068283,1270136683,311,631,1277,2557,5119,10243,20507,41017,82037,164089,328213,656429,1312867,2625761,5251529,10503061,21006137,42012281,84024581,168049163,336098327,672196673,1344393353,3,7,17,37,79,163,331,673,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,43,89,179,359,719,1439,2879,5779,11579,23159,46327,92657,185323,370661,741337,1482707,2965421,5930887,11861791,23723597,47447201,94894427,189788857,379577741,759155483,1518310967,379,761,1523,3049,6101,12203,24407,48817,97649,195311,390647,781301,1562611,3125257,6250537,12501169,25002389,50004791,100009607,200019221,400038451,800076929,1600153859,13,29,59,127,257,521,1049,2099,4201,8419,16843,33703,67409,134837,269683,539389,1078787,2157587,4315183,8630387,17260781,34521589,69043189,138086407,276172823,552345671,1104691373,19,41,83,167,337,677,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,53,107,223,449,907,1823,3659,7321,14653,29311,58631,117269,234539,469099,938207,1876417,3752839,7505681,15011389,30022781,60045577,120091177,240182359,480364727,960729461,1921458943];O.sort(P),I.nextPrime=function(W){let T=E(O,W,P);return 0>T&&(T=~T),O[T]},I.largestPrime=F},function(u,I,D){'use strict';function R(te,ne,ie){for(var se=1e101,oe=0;oe<te.length;oe++)for(var ae,le=0;le<ne.length;le++)ae=ie[te[oe]][ne[le]],se=_Mathmin(ae,se);return se}function E(te,ne,ie){for(var se=-1,oe=0;oe<te.length;oe++)for(var ae,le=0;le<ne.length;le++)ae=ie[te[oe]][ne[le]],se=_Mathmax(ae,se);return se}function P(te,ne,ie){for(var se=0,oe=0;oe<te.length;oe++)for(var le=0;le<ne.length;le++)se+=ie[te[oe]][ne[le]];return se/(te.length*ne.length)}function F(te,ne,ie){for(var se=Array(te.length*ne.length),oe=0;oe<te.length;oe++)for(var le=0;le<ne.length;le++)se[oe*ne.length+le]=ie[te[oe]][ne[le]];return T(se)}function O(te,ne,ie){return F(te,ne,ie)*te.length*ne.length/(te.length+ne.length)}function W(te,ne){return te-ne}function T(te,ne){ne===void 0&&(ne=!1),ne||(te=[].concat(te).sort(W));var ie=te.length,se=_Mathfloor(ie/2);return 0==ie%2?0.5*(te[se-1]+te[se]):te[se]}const Q=D(8),K=D(9),G=D(3),$=D(27);var ee={disFunc:Q,kind:'single',isDistanceMatrix:!1};u.exports=function(te,ne){ne=Object.assign({},ee,ne);var ie=te.length,se=te;if(ne.isDistanceMatrix||(se=$(te,ne.disFunc)),'string'==typeof ne.kind)switch(ne.kind){case'single':ne.kind=R;break;case'complete':ne.kind=E;break;case'average':ne.kind=P;break;case'centroid':ne.kind=F;break;case'ward':ne.kind=O;break;default:throw new RangeError('Unknown kind of similarity');}else if('function'!=typeof ne.kind)throw new TypeError('Undefined kind of similarity');for(var oe=Array(ie),le=0;le<se.length;le++)oe[le]=new K(le);for(var ae=1e6,ce={},de=0;1<oe.length;){ce={},ae=1e6;for(var ue=0;ue<oe.length;ue++)for(var he=ue+1;he<oe.length;he++){var ge,me;if(oe[ue]instanceof K)ge=[oe[ue].index];else{ge=Array(oe[ue].index.length);for(var pe=0;pe<ge.length;pe++)ge[pe]=oe[ue].index[pe].index}if(oe[he]instanceof K)me=[oe[he].index];else{me=Array(oe[he].index.length);for(var xe=0;xe<me.length;xe++)me[xe]=oe[he].index[xe].index}de=ne.kind(ge,me,se).toFixed(4),de in ce?ce[de].push([oe[ue],oe[he]]):ce[de]=[[oe[ue],oe[he]]],ae=_Mathmin(de,ae)}for(var fe,je=ce[ae.toFixed(4)],ke=Array(je.length),ye=0;0<je.length;){fe=je.shift();for(var be,we=0;we<je.length;we++)if(be=je[we].filter(function(De){return-1!==fe.indexOf(De)}),0<be.length){var ve=je[we].filter(function(De){return-1===fe.indexOf(De)});fe=fe.concat(ve),je.splice(we--,1)}ke[ye++]=fe}ke.length=ye;for(var Ie,Me=0;Me<ke.length;Me++){Ie=new G,Ie.children=ke[Me].concat(),Ie.distance=ae,Ie.index=Array(ie);for(var Se=0,Ce=0;Ce<ke[Me].length;Ce++)ke[Me][Ce]instanceof K?Ie.index[Se++]=ke[Me][Ce]:(Se+=ke[Me][Ce].index.length,Ie.index=ke[Me][Ce].index.concat(Ie.index)),oe.splice(oe.indexOf(ke[Me][Ce]),1);Ie.index.length=Se,oe.push(Ie)}}return oe[0]}},function(u,I,D){'use strict';function R(ee,te,ne){for(var ie=1e101,se=0;se<ee.length;se++)for(var le,oe=se;oe<te.length;oe++)le=ne(ee[se],te[oe]),ie=_Mathmin(le,ie);return ie}function E(ee,te,ne){for(var ie=-1,se=0;se<ee.length;se++)for(var le,oe=se;oe<te.length;oe++)le=ne(ee[se],te[oe]),ie=_Mathmax(le,ie);return ie}function P(ee,te,ne){for(var ie=0,se=0;se<ee.length;se++)for(var oe=0;oe<te.length;oe++)ie+=ne(ee[se],te[oe]);return ie/(ee.length*te.length)}function F(ee,te,ne){for(var ie=0,se=0,oe=0,le=0,ae=0;ae<ee.length;ae++)ie+=ee[ae][0],se+=ee[ae][1];for(var ce=0;ce<te.length;ce++)oe+=te[ce][0],le+=te[ce][1];return ie/=ee.length,se/=ee.length,oe/=te.length,le/=te.length,ne([ie,se],[oe,le])}function O(ee,te,ne){for(var ie=0,se=0,oe=0,le=0,ae=0;ae<ee.length;ae++)ie+=ee[ae][0],se+=ee[ae][1];for(var ce=0;ce<te.length;ce++)oe+=te[ce][0],le+=te[ce][1];return ie/=ee.length,se/=ee.length,oe/=te.length,le/=te.length,ne([ie,se],[oe,le])*ee.length*te.length/(ee.length+te.length)}function W(ee,te,ne){for(var ie={d:0,p:0},se=Array(ee[0].length),oe=0;oe<ee[0].length;oe++)se[oe]=te[ee[0][oe]];for(var le=Array(ee[1].length),ae=0;ae<ee[1].length;ae++)le[ae]=te[ee[1][ae]];for(var ce,de,ue=0;ue<se.length;ue++){ce=0;for(var he=0;he<se.length;he++)ue!==he&&(ce+=ne(se[ue],se[he]));ce/=se.length-1,de=0;for(var ge=0;ge<le.length;ge++)de+=ne(se[ue],le[ge]);de/=le.length,ce-de>ie.d&&(ie.d=ce-de,ie.p=ue)}return ie}function T(ee,te,ne){for(var ie=0,se=0,oe=0;oe<ee.length;oe++)for(var le=oe;le<ee.length;le++)ie+=ne(te[ee[oe].index],te[ee[le].index]),se++;return ie/se}const Q=D(8),K=D(9),G=D(3);var $={dist:Q,kind:'single'};u.exports=function(ee,te){if(te=Object.assign({},$,te),'string'==typeof te.kind)switch(te.kind){case'single':te.kind=R;break;case'complete':te.kind=E;break;case'average':te.kind=P;break;case'centroid':te.kind=F;break;case'ward':te.kind=O;break;default:throw new RangeError('Unknown kind of similarity');}else if('function'!=typeof te.kind)throw new TypeError('Undefined kind of similarity');var ne=new G;ne.children=Array(ee.length),ne.index=Array(ee.length);for(var ie=0;ie<ee.length;ie++)ne.children[ie]=new K(ie),ne.index[ie]=new K(ie);ne.distance=T(ne.index,ee,te.dist);for(var se,oe,le,ae,ce,de=[ne];0<de.length;){oe=0,le=0;for(var ue=0;ue<de.length;ue++){se=0;for(var he=0;he<de[ue].length;he++)for(var ge=he+1;ge<de[ue].length;ge++)se=_Mathmax(te.dist(ee[de[ue].index[he].index],ee[de[ue].index[ge].index]),se);se>oe&&(oe=se,le=ue)}if(oe=0,2===de[le].index.length)de[le].children=[de[le].index[0],de[le].index[1]],de[le].distance=te.dist(ee[de[le].index[0].index],ee[de[le].index[1].index]);else if(3===de[le].index.length){de[le].children=[de[le].index[0],de[le].index[1],de[le].index[2]];var me=[te.dist(ee[de[le].index[0].index],ee[de[le].index[1].index]),te.dist(ee[de[le].index[1].index],ee[de[le].index[2].index])];de[le].distance=(me[0]+me[1])/2}else{for(var pe=new G,xe=new G,je=[Array(de[le].index.length),[]],ke=0;ke<je[0].length;ke++)je[0][ke]=ke;for(var fe=0;fe<je[0].length;fe++){ae=0;for(var ye=0;ye<je[0].length;ye++)fe!==ye&&(ae+=te.dist(ee[de[le].index[je[0][ye]].index],ee[de[le].index[je[0][fe]].index]));ae/=je[0].length-1,ae>oe&&(oe=ae,ce=fe)}for(je[1]=[ce],je[0].splice(ce,1),ae=W(je,ee,te.dist);0<ae.d;)je[1].push(je[0][ae.p]),je[0].splice(ae.p,1),ae=W(je,ee,te.dist);var we=Array(je[0].length);pe.index=Array(je[0].length);for(var be=0;be<we.length;be++)we[be]=ee[de[le].index[je[0][be]].index],pe.index[be]=de[le].index[je[0][be]],pe.children[be]=de[le].index[je[0][be]];var ve=Array(je[1].length);xe.index=Array(je[1].length);for(var Me=0;Me<ve.length;Me++)ve[Me]=ee[de[le].index[je[1][Me]].index],xe.index[Me]=de[le].index[je[1][Me]],xe.children[Me]=de[le].index[je[1][Me]];pe.distance=T(pe.index,ee,te.dist),xe.distance=T(xe.index,ee,te.dist),de.push(pe),de.push(xe),de[le].children=[pe,xe]}de.splice(le,1)}return ne}},function(u,I,D){'use strict';I.agnes=D(30),I.diana=D(31)},function(u,I,D){'use strict';function R(P){if(!(this instanceof R))return new R(P);if(P=E.checkMatrix(P),!P.isSymmetric())throw new Error('Matrix is not symmetric');var Z,Q,K,F=P,O=F.rows,W=new E(O,O),T=!0;for(Q=0;Q<O;Q++){var G=W[Q],$=0;for(K=0;K<Q;K++){var ee=W[K],te=0;for(Z=0;Z<K;Z++)te+=ee[Z]*G[Z];G[K]=te=(F[Q][K]-te)/W[K][K],$+=te*te}for($=F[Q][Q]-$,T&=0<$,W[Q][Q]=_Mathsqrt(_Mathmax($,0)),K=Q+1;K<O;K++)W[Q][K]=0}if(!T)throw new Error('Matrix is not positive definite');this.L=W}var E=D(0).Matrix;R.prototype={get lowerTriangularMatrix(){return this.L},solve:function(P){P=E.checkMatrix(P);var F=this.L,O=F.rows;if(P.rows!==O)throw new Error('Matrix dimensions do not match');var Z,Q,K,W=P.columns,T=P.clone();for(K=0;K<O;K++)for(Q=0;Q<W;Q++){for(Z=0;Z<K;Z++)T[K][Q]-=T[Z][Q]*F[K][Z];T[K][Q]/=F[K][K]}for(K=O-1;0<=K;K--)for(Q=0;Q<W;Q++){for(Z=K+1;Z<O;Z++)T[K][Q]-=T[Z][Q]*F[Z][K];T[K][Q]/=F[K][K]}return T}},u.exports=R},function(u,I,D){'use strict';function R($,ee){if(ee=Object.assign({},G,ee),!(this instanceof R))return new R($,ee);if($=T.checkMatrix($),!$.isSquare())throw new Error('Matrix is not a square matrix');var le,ae,te=$.columns,ne=K(te,te,0),ie=Array(te),se=Array(te),oe=$,ce=!1;if(ce=!!ee.assumeSymmetric||$.isSymmetric(),ce){for(le=0;le<te;le++)for(ae=0;ae<te;ae++)ne[le][ae]=oe.get(le,ae);E(te,se,ie,ne),P(te,se,ie,ne)}else{var de=K(te,te,0),ue=Array(te);for(ae=0;ae<te;ae++)for(le=0;le<te;le++)de[le][ae]=oe.get(le,ae);F(te,de,ue,ne),O(te,se,ie,ne,de)}this.n=te,this.e=se,this.d=ie,this.V=ne}function E($,ee,te,ne){var ie,se,oe,le,ae,ce,de,ue;for(ae=0;ae<$;ae++)te[ae]=ne[$-1][ae];for(le=$-1;0<le;le--){for(ue=0,oe=0,ce=0;ce<le;ce++)ue+=_Mathabs(te[ce]);if(0===ue)for(ee[le]=te[le-1],ae=0;ae<le;ae++)te[ae]=ne[le-1][ae],ne[le][ae]=0,ne[ae][le]=0;else{for(ce=0;ce<le;ce++)te[ce]/=ue,oe+=te[ce]*te[ce];for(ie=te[le-1],se=_Mathsqrt(oe),0<ie&&(se=-se),ee[le]=ue*se,oe-=ie*se,te[le-1]=ie-se,ae=0;ae<le;ae++)ee[ae]=0;for(ae=0;ae<le;ae++){for(ie=te[ae],ne[ae][le]=ie,se=ee[ae]+ne[ae][ae]*ie,ce=ae+1;ce<=le-1;ce++)se+=ne[ce][ae]*te[ce],ee[ce]+=ne[ce][ae]*ie;ee[ae]=se}for(ie=0,ae=0;ae<le;ae++)ee[ae]/=oe,ie+=ee[ae]*te[ae];for(de=ie/(oe+oe),ae=0;ae<le;ae++)ee[ae]-=de*te[ae];for(ae=0;ae<le;ae++){for(ie=te[ae],se=ee[ae],ce=ae;ce<=le-1;ce++)ne[ce][ae]-=ie*ee[ce]+se*te[ce];te[ae]=ne[le-1][ae],ne[le][ae]=0}}te[le]=oe}for(le=0;le<$-1;le++){if(ne[$-1][le]=ne[le][le],ne[le][le]=1,oe=te[le+1],0!==oe){for(ce=0;ce<=le;ce++)te[ce]=ne[ce][le+1]/oe;for(ae=0;ae<=le;ae++){for(se=0,ce=0;ce<=le;ce++)se+=ne[ce][le+1]*ne[ce][ae];for(ce=0;ce<=le;ce++)ne[ce][ae]-=se*te[ce]}}for(ce=0;ce<=le;ce++)ne[ce][le+1]=0}for(ae=0;ae<$;ae++)te[ae]=ne[$-1][ae],ne[$-1][ae]=0;ne[$-1][$-1]=1,ee[0]=0}function P($,ee,te,ne){var ie,se,oe,le,ae,ce,de,ue,he,ge,me,pe,xe,je,ke,fe,ye;for(oe=1;oe<$;oe++)ee[oe-1]=ee[oe];ee[$-1]=0;var we=0,be=0,ve=2.220446049250313e-16;for(ce=0;ce<$;ce++){for(be=_Mathmax(be,_Mathabs(te[ce])+_Mathabs(ee[ce])),de=ce;de<$&&!(_Mathabs(ee[de])<=ve*be);)de++;if(de>ce){ye=0;do{for(++ye,ie=te[ce],ue=(te[ce+1]-ie)/(2*ee[ce]),he=Q(ue,1),0>ue&&(he=-he),te[ce]=ee[ce]/(ue+he),te[ce+1]=ee[ce]*(ue+he),ge=te[ce+1],se=ie-te[ce],oe=ce+2;oe<$;oe++)te[oe]-=se;for(we+=se,ue=te[de],me=1,pe=me,xe=me,je=ee[ce+1],ke=0,fe=0,oe=de-1;oe>=ce;oe--)for(xe=pe,pe=me,fe=ke,ie=me*ee[oe],se=me*ue,he=Q(ue,ee[oe]),ee[oe+1]=ke*he,ke=ee[oe]/he,me=ue/he,ue=me*te[oe]-ke*ie,te[oe+1]=se+ke*(me*ie+ke*te[oe]),ae=0;ae<$;ae++)se=ne[ae][oe+1],ne[ae][oe+1]=ke*ne[ae][oe]+me*se,ne[ae][oe]=me*ne[ae][oe]-ke*se;ue=-ke*fe*xe*je*ee[ce]/ge,ee[ce]=ke*ue,te[ce]=me*ue}while(_Mathabs(ee[ce])>ve*be)}te[ce]+=we,ee[ce]=0}for(oe=0;oe<$-1;oe++){for(ae=oe,ue=te[oe],le=oe+1;le<$;le++)te[le]<ue&&(ae=le,ue=te[le]);if(ae!==oe)for(te[ae]=te[oe],te[oe]=ue,le=0;le<$;le++)ue=ne[le][oe],ne[le][oe]=ne[le][ae],ne[le][ae]=ue}}function F($,ee,te,ne){var oe,le,ae,ce,de,ue,he,ie=0,se=$-1;for(ue=ie+1;ue<=se-1;ue++){for(he=0,ce=ue;ce<=se;ce++)he+=_Mathabs(ee[ce][ue-1]);if(0!==he){for(ae=0,ce=se;ce>=ue;ce--)te[ce]=ee[ce][ue-1]/he,ae+=te[ce]*te[ce];for(le=_Mathsqrt(ae),0<te[ue]&&(le=-le),ae-=te[ue]*le,te[ue]-=le,de=ue;de<$;de++){for(oe=0,ce=se;ce>=ue;ce--)oe+=te[ce]*ee[ce][de];for(oe/=ae,ce=ue;ce<=se;ce++)ee[ce][de]-=oe*te[ce]}for(ce=0;ce<=se;ce++){for(oe=0,de=se;de>=ue;de--)oe+=te[de]*ee[ce][de];for(oe/=ae,de=ue;de<=se;de++)ee[ce][de]-=oe*te[de]}te[ue]=he*te[ue],ee[ue][ue-1]=he*le}}for(ce=0;ce<$;ce++)for(de=0;de<$;de++)ne[ce][de]=ce===de?1:0;for(ue=se-1;ue>=ie+1;ue--)if(0!==ee[ue][ue-1]){for(ce=ue+1;ce<=se;ce++)te[ce]=ee[ce][ue-1];for(de=ue;de<=se;de++){for(le=0,ce=ue;ce<=se;ce++)le+=te[ce]*ne[ce][de];for(le=le/te[ue]/ee[ue][ue-1],ce=ue;ce<=se;ce++)ne[ce][de]+=le*te[ce]}}}function O($,ee,te,ne,ie){var je,ke,fe,ye,we,be,ve,Me,Ie,Se,Ce,De,ze,Ve,Re,se=$-1,oe=0,le=$-1,ae=2.220446049250313e-16,ce=0,de=0,ue=0,he=0,ge=0,me=0,pe=0,xe=0;for(je=0;je<$;je++)for((je<oe||je>le)&&(te[je]=ie[je][je],ee[je]=0),ke=_Mathmax(je-1,0);ke<$;ke++)de+=_Mathabs(ie[je][ke]);for(;se>=oe;){for(ye=se;ye>oe&&(me=_Mathabs(ie[ye-1][ye-1])+_Mathabs(ie[ye][ye]),0===me&&(me=de),!(_Mathabs(ie[ye][ye-1])<ae*me));)ye--;if(ye===se)ie[se][se]+=ce,te[se]=ie[se][se],ee[se]=0,se--,xe=0;else if(ye===se-1){if(ve=ie[se][se-1]*ie[se-1][se],ue=(ie[se-1][se-1]-ie[se][se])/2,he=ue*ue+ve,pe=_Mathsqrt(_Mathabs(he)),ie[se][se]+=ce,ie[se-1][se-1]=ie[se-1][se-1]+ce,Me=ie[se][se],0<=he){for(pe=0<=ue?ue+pe:ue-pe,te[se-1]=Me+pe,te[se]=te[se-1],0!==pe&&(te[se]=Me-ve/pe),ee[se-1]=0,ee[se]=0,Me=ie[se][se-1],me=_Mathabs(Me)+_Mathabs(pe),ue=Me/me,he=pe/me,ge=_Mathsqrt(ue*ue+he*he),ue/=ge,he/=ge,ke=se-1;ke<$;ke++)pe=ie[se-1][ke],ie[se-1][ke]=he*pe+ue*ie[se][ke],ie[se][ke]=he*ie[se][ke]-ue*pe;for(je=0;je<=se;je++)pe=ie[je][se-1],ie[je][se-1]=he*pe+ue*ie[je][se],ie[je][se]=he*ie[je][se]-ue*pe;for(je=oe;je<=le;je++)pe=ne[je][se-1],ne[je][se-1]=he*pe+ue*ne[je][se],ne[je][se]=he*ne[je][se]-ue*pe}else te[se-1]=Me+ue,te[se]=Me+ue,ee[se-1]=pe,ee[se]=-pe;se-=2,xe=0}else{if(Me=ie[se][se],Ie=0,ve=0,ye<se&&(Ie=ie[se-1][se-1],ve=ie[se][se-1]*ie[se-1][se]),10==xe){for(ce+=Me,je=oe;je<=se;je++)ie[je][je]-=Me;me=_Mathabs(ie[se][se-1])+_Mathabs(ie[se-1][se-2]),Me=Ie=0.75*me,ve=-0.4375*me*me}if(30==xe&&(me=(Ie-Me)/2,me=me*me+ve,0<me)){for(me=_Mathsqrt(me),Ie<Me&&(me=-me),me=Me-ve/((Ie-Me)/2+me),je=oe;je<=se;je++)ie[je][je]-=me;ce+=me,Me=Ie=ve=0.964}for(++xe,we=se-2;we>=ye&&(pe=ie[we][we],ge=Me-pe,me=Ie-pe,ue=(ge*me-ve)/ie[we+1][we]+ie[we][we+1],he=ie[we+1][we+1]-pe-ge-me,ge=ie[we+2][we+1],me=_Mathabs(ue)+_Mathabs(he)+_Mathabs(ge),ue/=me,he/=me,ge/=me,we!==ye)&&!(_Mathabs(ie[we][we-1])*(_Mathabs(he)+_Mathabs(ge))<ae*(_Mathabs(ue)*(_Mathabs(ie[we-1][we-1])+_Mathabs(pe)+_Mathabs(ie[we+1][we+1]))));)we--;for(je=we+2;je<=se;je++)ie[je][je-2]=0,je>we+2&&(ie[je][je-3]=0);for(fe=we;fe<=se-1&&(Ve=fe!==se-1,fe!==we&&(ue=ie[fe][fe-1],he=ie[fe+1][fe-1],ge=Ve?ie[fe+2][fe-1]:0,Me=_Mathabs(ue)+_Mathabs(he)+_Mathabs(ge),0!==Me&&(ue/=Me,he/=Me,ge/=Me)),0!==Me);fe++)if(me=_Mathsqrt(ue*ue+he*he+ge*ge),0>ue&&(me=-me),0!==me){for(fe===we?ye!==we&&(ie[fe][fe-1]=-ie[fe][fe-1]):ie[fe][fe-1]=-me*Me,ue+=me,Me=ue/me,Ie=he/me,pe=ge/me,he/=ue,ge/=ue,ke=fe;ke<$;ke++)ue=ie[fe][ke]+he*ie[fe+1][ke],Ve&&(ue+=ge*ie[fe+2][ke],ie[fe+2][ke]=ie[fe+2][ke]-ue*pe),ie[fe][ke]-=ue*Me,ie[fe+1][ke]=ie[fe+1][ke]-ue*Ie;for(je=0;je<=_Mathmin(se,fe+3);je++)ue=Me*ie[je][fe]+Ie*ie[je][fe+1],Ve&&(ue+=pe*ie[je][fe+2],ie[je][fe+2]=ie[je][fe+2]-ue*ge),ie[je][fe]-=ue,ie[je][fe+1]=ie[je][fe+1]-ue*he;for(je=oe;je<=le;je++)ue=Me*ne[je][fe]+Ie*ne[je][fe+1],Ve&&(ue+=pe*ne[je][fe+2],ne[je][fe+2]=ne[je][fe+2]-ue*ge),ne[je][fe]-=ue,ne[je][fe+1]=ne[je][fe+1]-ue*he}}}if(0!==de){for(se=$-1;0<=se;se--)if(ue=te[se],he=ee[se],0===he)for(ye=se,ie[se][se]=1,je=se-1;0<=je;je--){for(ve=ie[je][je]-ue,ge=0,ke=ye;ke<=se;ke++)ge+=ie[je][ke]*ie[ke][se];if(0>ee[je])pe=ve,me=ge;else if(ye=je,0===ee[je]?ie[je][se]=0===ve?-ge/(ae*de):-ge/ve:(Me=ie[je][je+1],Ie=ie[je+1][je],he=(te[je]-ue)*(te[je]-ue)+ee[je]*ee[je],be=(Me*me-pe*ge)/he,ie[je][se]=be,ie[je+1][se]=_Mathabs(Me)>_Mathabs(pe)?(-ge-ve*be)/Me:(-me-Ie*be)/pe),be=_Mathabs(ie[je][se]),1<ae*be*be)for(ke=je;ke<=se;ke++)ie[ke][se]/=be}else if(0>he)for(ye=se-1,_Mathabs(ie[se][se-1])>_Mathabs(ie[se-1][se])?(ie[se-1][se-1]=he/ie[se][se-1],ie[se-1][se]=-(ie[se][se]-ue)/ie[se][se-1]):(Re=W(0,-ie[se-1][se],ie[se-1][se-1]-ue,he),ie[se-1][se-1]=Re[0],ie[se-1][se]=Re[1]),ie[se][se-1]=0,ie[se][se]=1,je=se-2;0<=je;je--){for(Se=0,Ce=0,ke=ye;ke<=se;ke++)Se+=ie[je][ke]*ie[ke][se-1],Ce+=ie[je][ke]*ie[ke][se];if(ve=ie[je][je]-ue,0>ee[je])pe=ve,ge=Se,me=Ce;else if(ye=je,0===ee[je]?(Re=W(-Se,-Ce,ve,he),ie[je][se-1]=Re[0],ie[je][se]=Re[1]):(Me=ie[je][je+1],Ie=ie[je+1][je],De=(te[je]-ue)*(te[je]-ue)+ee[je]*ee[je]-he*he,ze=2*(te[je]-ue)*he,0===De&&0===ze&&(De=ae*de*(_Mathabs(ve)+_Mathabs(he)+_Mathabs(Me)+_Mathabs(Ie)+_Mathabs(pe))),Re=W(Me*ge-pe*Se+he*Ce,Me*me-pe*Ce-he*Se,De,ze),ie[je][se-1]=Re[0],ie[je][se]=Re[1],_Mathabs(Me)>_Mathabs(pe)+_Mathabs(he)?(ie[je+1][se-1]=(-Se-ve*ie[je][se-1]+he*ie[je][se])/Me,ie[je+1][se]=(-Ce-ve*ie[je][se]-he*ie[je][se-1])/Me):(Re=W(-ge-Ie*ie[je][se-1],-me-Ie*ie[je][se],pe,he),ie[je+1][se-1]=Re[0],ie[je+1][se]=Re[1])),be=_Mathmax(_Mathabs(ie[je][se-1]),_Mathabs(ie[je][se])),1<ae*be*be)for(ke=je;ke<=se;ke++)ie[ke][se-1]=ie[ke][se-1]/be,ie[ke][se]/=be}for(je=0;je<$;je++)if(je<oe||je>le)for(ke=je;ke<$;ke++)ne[je][ke]=ie[je][ke];for(ke=$-1;ke>=oe;ke--)for(je=oe;je<=le;je++){for(pe=0,fe=oe;fe<=_Mathmin(ke,le);fe++)pe+=ne[je][fe]*ie[fe][ke];ne[je][ke]=pe}}}function W($,ee,te,ne){var ie,se;return _Mathabs(te)>_Mathabs(ne)?(ie=ne/te,se=te+ie*ne,[($+ie*ee)/se,(ee-ie*$)/se]):(ie=te/ne,se=ne+ie*te,[(ie*$+ee)/se,(ie*ee-$)/se])}const T=D(0).Matrix,Z=D(4),Q=Z.hypotenuse,K=Z.getFilled2DArray,G={assumeSymmetric:!1};R.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return T.isMatrix(this.V)||(this.V=new T(this.V)),this.V},get diagonalMatrix(){var ie,se,$=this.n,ee=this.e,te=this.d,ne=new T($,$);for(ie=0;ie<$;ie++){for(se=0;se<$;se++)ne[ie][se]=0;ne[ie][ie]=te[ie],0<ee[ie]?ne[ie][ie+1]=ee[ie]:0>ee[ie]&&(ne[ie][ie-1]=ee[ie])}return ne}},u.exports=R},function(u,I,D){'use strict';function R(F){if(!(this instanceof R))return new R(F);F=E.checkMatrix(F);var Q,K,G,$,O=F.clone(),W=F.rows,T=F.columns,Z=Array(T);for(G=0;G<T;G++){var ee=0;for(Q=G;Q<W;Q++)ee=P(ee,O[Q][G]);if(0!==ee){for(0>O[G][G]&&(ee=-ee),Q=G;Q<W;Q++)O[Q][G]/=ee;for(O[G][G]+=1,K=G+1;K<T;K++){for($=0,Q=G;Q<W;Q++)$+=O[Q][G]*O[Q][K];for($=-$/O[G][G],Q=G;Q<W;Q++)O[Q][K]+=$*O[Q][G]}}Z[G]=-ee}this.QR=O,this.Rdiag=Z}var E=D(0).Matrix,P=D(4).hypotenuse;R.prototype={solve:function(F){F=E.checkMatrix(F);var O=this.QR,W=O.rows;if(F.rows!==W)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var T=F.columns,Z=F.clone(),Q=O.columns,K,G,$,ee;for($=0;$<Q;$++)for(G=0;G<T;G++){for(ee=0,K=$;K<W;K++)ee+=O[K][$]*Z[K][G];for(ee=-ee/O[$][$],K=$;K<W;K++)Z[K][G]+=ee*O[K][$]}for($=Q-1;0<=$;$--){for(G=0;G<T;G++)Z[$][G]/=this.Rdiag[$];for(K=0;K<$;K++)for(G=0;G<T;G++)Z[K][G]-=Z[$][G]*O[K][$]}return Z.subMatrix(0,Q-1,0,T-1)},isFullRank:function(){for(var F=this.QR.columns,O=0;O<F;O++)if(0===this.Rdiag[O])return!1;return!0},get upperTriangularMatrix(){var T,Z,F=this.QR,O=F.columns,W=new E(O,O);for(T=0;T<O;T++)for(Z=0;Z<O;Z++)W[T][Z]=T<Z?F[T][Z]:T===Z?this.Rdiag[T]:0;return W},get orthogonalMatrix(){var Z,Q,K,G,F=this.QR,O=F.rows,W=F.columns,T=new E(O,W);for(K=W-1;0<=K;K--){for(Z=0;Z<O;Z++)T[Z][K]=0;for(T[K][K]=1,Q=K;Q<W;Q++)if(0!==F[K][K]){for(G=0,Z=K;Z<O;Z++)G+=F[Z][K]*T[Z][Q];for(G=-G/F[K][K],Z=K;Z<O;Z++)T[Z][Q]+=G*F[Z][K]}}return T}},u.exports=R},function(u,I,D){'use strict';function R(Q){return Q=P.checkMatrix(Q),E(Q,P.eye(Q.rows))}function E(Q,K){return Q=P.checkMatrix(Q),K=P.checkMatrix(K),Q.isSquare()?new W(Q).solve(K):new T(Q).solve(K)}var P=D(0).Matrix,F=D(12),O=D(34),W=D(11),T=D(35),Z=D(33);P.inverse=P.inv=R,P.prototype.inverse=P.prototype.inv=function(){return R(this)},P.solve=E,P.prototype.solve=function(Q){return E(this,Q)},u.exports={SingularValueDecomposition:F,SVD:F,EigenvalueDecomposition:O,EVD:O,LuDecomposition:W,LU:W,QrDecomposition:T,QR:T,CholeskyDecomposition:Z,CHO:Z,inverse:R,solve:E}},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(u,I,D){'use strict';var R=D(1);u.exports=class extends R{constructor(P,F){super(P,P.rows,1),this.column=F}set(P,F,O){return this.matrix.set(P,this.column,O),this}get(P){return this.matrix.get(P,this.column)}}},function(u,I,D){'use strict';var R=D(1);u.exports=class extends R{constructor(P){super(P,P.rows,P.columns)}set(P,F,O){return this.matrix.set(P,this.columns-F-1,O),this}get(P,F){return this.matrix.get(P,this.columns-F-1)}}},function(u,I,D){'use strict';var R=D(1);u.exports=class extends R{constructor(P){super(P,P.rows,P.columns)}set(P,F,O){return this.matrix.set(this.rows-P-1,F,O),this}get(P,F){return this.matrix.get(this.rows-P-1,F)}}},function(u,I,D){'use strict';var R=D(1);u.exports=class extends R{constructor(P,F){super(P,1,P.columns),this.row=F}set(P,F,O){return this.matrix.set(this.row,F,O),this}get(P,F){return this.matrix.get(this.row,F)}}},function(u,I,D){'use strict';var R=D(1),E=D(2);u.exports=class extends R{constructor(F,O,W){var T=E.checkIndices(F,O,W);super(F,T.row.length,T.column.length),this.rowIndices=T.row,this.columnIndices=T.column}set(F,O,W){return this.matrix.set(this.rowIndices[F],this.columnIndices[O],W),this}get(F,O){return this.matrix.get(this.rowIndices[F],this.columnIndices[O])}}},function(u,I,D){'use strict';var R=D(1),E=D(2);u.exports=class extends R{constructor(F,O,W,T,Z){E.checkRange(F,O,W,T,Z),super(F,W-O+1,Z-T+1),this.startRow=O,this.startColumn=T}set(F,O,W){return this.matrix.set(this.startRow+F,this.startColumn+O,W),this}get(F,O){return this.matrix.get(this.startRow+F,this.startColumn+O)}}},function(u,I,D){'use strict';var R=D(1);u.exports=class extends R{constructor(P){super(P,P.columns,P.rows)}set(P,F,O){return this.matrix.set(F,P,O),this}get(P,F){return this.matrix.get(F,P)}}},function(u){'use strict';function R(P){var F=_Mathsqrt(2*P.length+0.25)-0.5,O=[],W=Array(F),T=F,Z=0,Q=[];for(Z=F-1;0<=Z;Z--)W[Z]=1;for(var K=-1,G=[];0<T;){if(0===G.length){for(Q=Array(F),Z=0;Z<F;Z++)Q[Z]=0;for(O.push(Q),K=0;0==W[K];K++);}else K=G.splice(0,1);Q[K]=1,W[K]=0,T--;var $=Array(F);for(Z=0;Z<F;Z++){var ee=_Mathmax(K,Z),te=_Mathmin(K,Z);$[Z]=P[te*(2*F-te-1)/2+ee],1==$[Z]&&1==W[Z]&&0==Q[Z]&&(G.push(Z),Q[Z]=1)}}return O}const E={threshold:0,out:'assignment'};u.exports=function(F,O){const W=Object.assign({},E,O);var T,Z,Q,K;if('number'==typeof F[0])T=R(F);else if('object'==typeof F[0]){for(var G=F.length,$=Array(G*(G+1)/2),ee=0,Z=0;Z<G;Z++)for(var Q=Z;Q<G;Q++)$[ee++]=F[Z][Q]>W.threshold?1:0;T=R($)}if('indexes'===W.out||'values'===W.out){var te=Array(T.length);for(Z=0;Z<T.length;Z++)for(te[Z]=[],Q=0;Q<T[Z].length;Q++)0!=T[Z][Q]&&te[Z].push(Q);if('values'===W.out){var ne=Array(te.length);for(Z=0;Z<te.length;Z++)for(ne[Z]=Array(te[Z].length),Q=0;Q<te[Z].length;Q++)for(ne[Z][Q]=Array(te[Z].length),K=0;K<te[Z].length;K++)ne[Z][Q][K]=F[te[Z][Q]][te[Z][K]];return ne}return te}return T}},function(u,I,D){'use strict';function R(P,F){return P-F}var E=D(14);I.max=function(F){for(var P=-Infinity,O=0;O<F.length;O++)for(var W=0;W<F[O].length;W++)F[O][W]>P&&(P=F[O][W]);return P},I.min=function(F){for(var P=Infinity,O=0;O<F.length;O++)for(var W=0;W<F[O].length;W++)F[O][W]<P&&(P=F[O][W]);return P},I.minMax=function(F){for(var O=Infinity,W=-Infinity,T=0;T<F.length;T++)for(var Z=0;Z<F[T].length;Z++)F[T][Z]<O&&(O=F[T][Z]),F[T][Z]>W&&(W=F[T][Z]);return{min:O,max:W}},I.entropy=function(F,O){'undefined'==typeof O&&(O=0);for(var W=0,T=F.length,Z=F[0].length,Q=0;Q<T;Q++)for(var K=0;K<Z;K++)W+=F[Q][K]*_Mathlog(F[Q][K]+O);return-W},I.mean=function(F,O){'undefined'==typeof O&&(O=0);var Z,Q,K,G,W=F.length,T=F[0].length;if(-1===O){for(Z=[0],Q=W*T,K=0;K<W;K++)for(G=0;G<T;G++)Z[0]+=F[K][G];Z[0]/=Q}else if(0===O)for(Z=Array(T),Q=W,G=0;G<T;G++){for(Z[G]=0,K=0;K<W;K++)Z[G]+=F[K][G];Z[G]/=Q}else if(1===O)for(Z=Array(W),Q=T,G=0;G<W;G++){for(Z[G]=0,K=0;K<T;K++)Z[G]+=F[G][K];Z[G]/=Q}else throw new Error('Invalid dimension');return Z},I.sum=function(F,O){'undefined'==typeof O&&(O=0);var Z,Q,K,W=F.length,T=F[0].length;if(-1===O)for(Z=[0],Q=0;Q<W;Q++)for(K=0;K<T;K++)Z[0]+=F[Q][K];else if(0===O)for(Z=Array(T),K=0;K<T;K++)for(Z[K]=0,Q=0;Q<W;Q++)Z[K]+=F[Q][K];else if(1===O)for(Z=Array(W),K=0;K<W;K++)for(Z[K]=0,Q=0;Q<T;Q++)Z[K]+=F[K][Q];else throw new Error('Invalid dimension');return Z},I.product=function(F,O){'undefined'==typeof O&&(O=0);var Z,Q,K,W=F.length,T=F[0].length;if(-1===O)for(Z=[1],Q=0;Q<W;Q++)for(K=0;K<T;K++)Z[0]*=F[Q][K];else if(0===O)for(Z=Array(T),K=0;K<T;K++)for(Z[K]=1,Q=0;Q<W;Q++)Z[K]*=F[Q][K];else if(1===O)for(Z=Array(W),K=0;K<W;K++)for(Z[K]=1,Q=0;Q<T;Q++)Z[K]*=F[K][Q];else throw new Error('Invalid dimension');return Z},I.standardDeviation=function(F,O,W){for(var T=I.variance(F,O,W),Z=T.length,Q=0;Q<Z;Q++)T[Q]=_Mathsqrt(T[Q]);return T},I.variance=function(F,O,W){'undefined'==typeof W&&(W=!0),O=O||I.mean(F);var T=F.length;if(0===T)return[];for(var Z=F[0].length,Q=Array(Z),K=0;K<Z;K++){for(var G=0,$=0,ee=0,te=0;te<T;te++)ee=F[te][K]-O[K],G+=ee,$+=ee*ee;Q[K]=W?($-G*G/T)/(T-1):($-G*G/T)/T}return Q},I.median=function(F){for(var Q,O=F.length,W=F[0].length,T=Array(W),Z=0;Z<W;Z++){Q=Array(O);for(var K=0;K<O;K++)Q[K]=F[K][Z];Q.sort(R);var G=Q.length;T[Z]=0==G%2?0.5*(Q[G/2]+Q[G/2-1]):Q[_Mathfloor(G/2)]}return T},I.mode=function(F){var Z,Q,O=F.length,W=F[0].length,T=Array(W);for(Z=0;Z<W;Z++){for(var K=Array(O),G=0;G<O;G++)K[G]=0;var $=Array(O),ee=0;for(Q=0;Q<O;Q++){var te=$.indexOf(F[Q][Z]);0<=te?K[te]++:($[ee]=F[Q][Z],K[ee]=1,ee++)}var ne=0,ie=0;for(Q=0;Q<ee;Q++)K[Q]>ne&&(ne=K[Q],ie=Q);T[Z]=$[ie]}return T},I.skewness=function(F,O){'undefined'==typeof O&&(O=!0);for(var W=I.mean(F),T=F.length,Z=W.length,Q=Array(Z),K=0;K<Z;K++){for(var te,G=0,$=0,ee=0;ee<T;ee++)te=F[ee][K]-W[K],G+=te*te,$+=te*te*te;var ne=G/T,ie=$/T,se=ie/_Mathpow(ne,3/2);if(O){var oe=_Mathsqrt(T*(T-1));Q[K]=oe/(T-2)*se}else Q[K]=se}return Q},I.kurtosis=function(F,O){'undefined'==typeof O&&(O=!0);for(var W=I.mean(F),T=F.length,Z=F[0].length,Q=Array(Z),K=0;K<Z;K++){for(var te,G=0,$=0,ee=0;ee<T;ee++)te=F[ee][K]-W[K],G+=te*te,$+=te*te*te*te;var ne=G/T,ie=$/T;if(O){var se=G/(T-1),le=$/(se*se);Q[K]=T*(T+1)/((T-1)*(T-2)*(T-3))*le-3*((T-1)*(T-1)/((T-2)*(T-3)))}else Q[K]=ie/(ne*ne)-3}return Q},I.standardError=function(F){for(var O=F.length,W=I.standardDeviation(F),T=W.length,Z=Array(T),Q=_Mathsqrt(O),K=0;K<T;K++)Z[K]=W[K]/Q;return Z},I.covariance=function(F,O){return I.scatter(F,void 0,O)},I.scatter=function(F,O,W){'undefined'==typeof W&&(W=0),'undefined'==typeof O&&(0===W?O=F.length-1:1===W&&(O=F[0].length-1));var T=I.mean(F,W),Z=F.length;if(0===Z)return[[]];var K,G,$,ee,te,Q=F[0].length;if(0===W){for(K=Array(Q),G=0;G<Q;G++)K[G]=Array(Q);for(G=0;G<Q;G++)for($=G;$<Q;$++){for(ee=0,te=0;te<Z;te++)ee+=(F[te][$]-T[$])*(F[te][G]-T[G]);ee/=O,K[G][$]=ee,K[$][G]=ee}}else if(1===W){for(K=Array(Z),G=0;G<Z;G++)K[G]=Array(Z);for(G=0;G<Z;G++)for($=G;$<Z;$++){for(ee=0,te=0;te<Q;te++)ee+=(F[$][te]-T[$])*(F[G][te]-T[G]);ee/=O,K[G][$]=ee,K[$][G]=ee}}else throw new Error('Invalid dimension');return K},I.correlation=function(F){var K,G,O=I.mean(F),W=I.standardDeviation(F,!0,O),T=I.zScores(F,O,W),Z=F.length,Q=F[0].length,$=Array(Q);for(K=0;K<Q;K++)$[K]=Array(Q);for(K=0;K<Q;K++)for(G=K;G<Q;G++){for(var ee=0,te=0,ne=T.length;te<ne;te++)ee+=T[te][G]*T[te][K];ee/=Z-1,$[K][G]=ee,$[G][K]=ee}return $},I.zScores=function(F,O,W){return O=O||I.mean(F),'undefined'==typeof W&&(W=I.standardDeviation(F,!0,O)),I.standardize(I.center(F,O,!1),W,!0)},I.center=function(F,O,W){O=O||I.mean(F);var Q,K,G,T=F,Z=F.length;if(!W)for(T=Array(Z),Q=0;Q<Z;Q++)T[Q]=Array(F[Q].length);for(Q=0;Q<Z;Q++){var $=T[Q];for(K=0,G=$.length;K<G;K++)$[K]=F[Q][K]-O[K]}return T},I.standardize=function(F,O,W){'undefined'==typeof O&&(O=I.standardDeviation(F));var Q,K,G,T=F,Z=F.length;if(!W)for(T=Array(Z),Q=0;Q<Z;Q++)T[Q]=Array(F[Q].length);for(Q=0;Q<Z;Q++){var $=T[Q],ee=F[Q];for(K=0,G=$.length;K<G;K++)0===O[K]||isNaN(O[K])||($[K]=ee[K]/O[K])}return T},I.weightedVariance=function(F,O){var W=I.mean(F),T=F.length;if(0===T)return[];for(var Z=F[0].length,Q=Array(Z),K=0;K<Z;K++){for(var G=0,$=0,ee=0,te=0;te<T;te++){var ne=F[te][K]-W[K],ie=O[te];G+=ie*(ne*ne),ee+=ie,$+=ie*ie}Q[K]=G*(ee/(ee*ee-$))}return Q},I.weightedMean=function(F,O,W){'undefined'==typeof W&&(W=0);var T=F.length;if(0===T)return[];var Q,K,G,$,ee,te,Z=F[0].length;if(0===W){for(Q=Array(Z),K=0;K<Z;K++)Q[K]=0;for(K=0;K<T;K++)for(te=F[K],ee=O[K],$=0;$<Z;$++)Q[$]+=te[$]*ee}else if(1===W){for(Q=Array(T),K=0;K<T;K++)Q[K]=0;for($=0;$<T;$++)for(te=F[$],ee=O[$],K=0;K<Z;K++)Q[$]+=te[K]*ee}else throw new Error('Invalid dimension');var ne=E.sum(O);if(0!==ne)for(K=0,G=Q.length;K<G;K++)Q[K]/=ne;return Q},I.weightedCovariance=function(F,O,W,T){T=T||0,W=W||I.weightedMean(F,O,T);for(var Z=0,Q=0,K=0,G=O.length;K<G;K++)Z+=O[K],Q+=O[K]*O[K];var $=Z/(Z*Z-Q);return I.weightedScatter(F,O,W,$,T)},I.weightedScatter=function(F,O,W,T,Z){Z=Z||0,W=W||I.weightedMean(F,O,Z),'undefined'==typeof T&&(T=1);var Q=F.length;if(0===Q)return[[]];var G,$,ee,te,ne,K=F[0].length;if(0===Z){for(G=Array(K),$=0;$<K;$++)G[$]=Array(K);for($=0;$<K;$++)for(ee=$;ee<K;ee++){for(ne=0,te=0;te<Q;te++)ne+=O[te]*(F[te][ee]-W[ee])*(F[te][$]-W[$]);G[$][ee]=ne*T,G[ee][$]=ne*T}}else if(1===Z){for(G=Array(Q),$=0;$<Q;$++)G[$]=Array(Q);for($=0;$<Q;$++)for(ee=$;ee<Q;ee++){for(ne=0,te=0;te<K;te++)ne+=O[te]*(F[ee][te]-W[ee])*(F[$][te]-W[$]);G[$][ee]=ne*T,G[ee][$]=ne*T}}else throw new Error('Invalid dimension');return G}},function(u){'use strict';u.exports=Number.isNaN||function(R){return R!==R}},function(u){function D(){throw new Error('setTimeout has not been defined')}function R(){throw new Error('clearTimeout has not been defined')}function E(ne){if(Q===setTimeout)return setTimeout(ne,0);if((Q===D||!Q)&&setTimeout)return Q=setTimeout,setTimeout(ne,0);try{return Q(ne,0)}catch(ie){try{return Q.call(null,ne,0)}catch(se){return Q.call(this,ne,0)}}}function P(ne){if(K===clearTimeout)return clearTimeout(ne);if((K===R||!K)&&clearTimeout)return K=clearTimeout,clearTimeout(ne);try{return K(ne)}catch(ie){try{return K.call(null,ne)}catch(se){return K.call(this,ne)}}}function F(){$&&ee&&($=!1,ee.length?G=ee.concat(G):te=-1,G.length&&O())}function O(){if(!$){var ne=E(F);$=!0;for(var ie=G.length;ie;){for(ee=G,G=[];++te<ie;)ee&&ee[te].run();te=-1,ie=G.length}ee=null,$=!1,P(ne)}}function W(ne,ie){this.fun=ne,this.array=ie}function T(){}var Z=u.exports={},Q,K;(function(){try{Q='function'==typeof setTimeout?setTimeout:D}catch(ne){Q=D}try{K='function'==typeof clearTimeout?clearTimeout:R}catch(ne){K=R}})();var G=[],$=!1,ee,te=-1;Z.nextTick=function(ne){var ie=Array(arguments.length-1);if(1<arguments.length)for(var se=1;se<arguments.length;se++)ie[se-1]=arguments[se];G.push(new W(ne,ie)),1!==G.length||$||E(O)},W.prototype.run=function(){this.fun.apply(null,this.array)},Z.title='browser',Z.browser=!0,Z.env={},Z.argv=[],Z.version='',Z.versions={},Z.on=T,Z.addListener=T,Z.once=T,Z.off=T,Z.removeListener=T,Z.removeAllListeners=T,Z.emit=T,Z.binding=function(){throw new Error('process.binding is not supported')},Z.cwd=function(){return'/'},Z.chdir=function(){throw new Error('process.chdir is not supported')},Z.umask=function(){return 0}},function(u){u.exports='function'==typeof Object.create?function(R,E){R.super_=E,R.prototype=Object.create(E.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}})}:function(R,E){R.super_=E;var P=function(){};P.prototype=E.prototype,R.prototype=new P,R.prototype.constructor=R}},function(u){u.exports=function(R){return R&&'object'==typeof R&&'function'==typeof R.copy&&'function'==typeof R.fill&&'function'==typeof R.readUInt8}},function(u,I,D){(function(R,E){function P(ve,Me){var Ie={seen:[],stylize:O};return 3<=arguments.length&&(Ie.depth=arguments[2]),4<=arguments.length&&(Ie.colors=arguments[3]),te(Me)?Ie.showHidden=Me:Me&&I._extend(Ie,Me),ae(Ie.showHidden)&&(Ie.showHidden=!1),ae(Ie.depth)&&(Ie.depth=2),ae(Ie.colors)&&(Ie.colors=!1),ae(Ie.customInspect)&&(Ie.customInspect=!0),Ie.colors&&(Ie.stylize=F),T(Ie,ve,Ie.depth)}function F(ve,Me){var Ie=P.styles[Me];return Ie?'\x1B['+P.colors[Ie][0]+'m'+ve+'\x1B['+P.colors[Ie][1]+'m':ve}function O(ve){return ve}function W(ve){var Me={};return ve.forEach(function(Ie){Me[Ie]=!0}),Me}function T(ve,Me,Ie){if(ve.customInspect&&Me&&ge(Me.inspect)&&Me.inspect!==I.inspect&&!(Me.constructor&&Me.constructor.prototype===Me)){var Se=Me.inspect(Ie,ve);return oe(Se)||(Se=T(ve,Se,Ie)),Se}var Ce=Z(ve,Me);if(Ce)return Ce;var De=Object.keys(Me),ze=W(De);if(ve.showHidden&&(De=Object.getOwnPropertyNames(Me)),he(Me)&&(0<=De.indexOf('message')||0<=De.indexOf('description')))return Q(Me);if(0===De.length){if(ge(Me)){var Ve=Me.name?': '+Me.name:'';return ve.stylize('[Function'+Ve+']','special')}if(ce(Me))return ve.stylize(RegExp.prototype.toString.call(Me),'regexp');if(ue(Me))return ve.stylize(Date.prototype.toString.call(Me),'date');if(he(Me))return Q(Me)}var Re='',qe=!1,Le=['{','}'];if(ee(Me)&&(qe=!0,Le=['[',']']),ge(Me)){var Ee=Me.name?': '+Me.name:'';Re=' [Function'+Ee+']'}if(ce(Me)&&(Re=' '+RegExp.prototype.toString.call(Me)),ue(Me)&&(Re=' '+Date.prototype.toUTCString.call(Me)),he(Me)&&(Re=' '+Q(Me)),0===De.length&&(!qe||0==Me.length))return Le[0]+Re+Le[1];if(0>Ie)return ce(Me)?ve.stylize(RegExp.prototype.toString.call(Me),'regexp'):ve.stylize('[Object]','special');ve.seen.push(Me);var Pe;return Pe=qe?K(ve,Me,Ie,ze,De):De.map(function(Ae){return G(ve,Me,Ie,ze,Ae,qe)}),ve.seen.pop(),$(Pe,Re,Le)}function Z(ve,Me){if(ae(Me))return ve.stylize('undefined','undefined');if(oe(Me)){var Ie='\''+JSON.stringify(Me).replace(/^"|"$/g,'').replace(/'/g,'\\\'').replace(/\\"/g,'"')+'\'';return ve.stylize(Ie,'string')}return se(Me)?ve.stylize(''+Me,'number'):te(Me)?ve.stylize(''+Me,'boolean'):ne(Me)?ve.stylize('null','null'):void 0}function Q(ve){return'['+Error.prototype.toString.call(ve)+']'}function K(ve,Me,Ie,Se,Ce){for(var De=[],ze=0,Ve=Me.length;ze<Ve;++ze)ke(Me,ze+'')?De.push(G(ve,Me,Ie,Se,ze+'',!0)):De.push('');return Ce.forEach(function(Re){Re.match(/^\d+$/)||De.push(G(ve,Me,Ie,Se,Re,!0))}),De}function G(ve,Me,Ie,Se,Ce,De){var ze,Ve,Re;if(Re=Object.getOwnPropertyDescriptor(Me,Ce)||{value:Me[Ce]},Re.get?Re.set?Ve=ve.stylize('[Getter/Setter]','special'):Ve=ve.stylize('[Getter]','special'):Re.set&&(Ve=ve.stylize('[Setter]','special')),ke(Se,Ce)||(ze='['+Ce+']'),Ve||(0>ve.seen.indexOf(Re.value)?(Ve=ne(Ie)?T(ve,Re.value,null):T(ve,Re.value,Ie-1),-1<Ve.indexOf('\n')&&(De?Ve=Ve.split('\n').map(function(qe){return'  '+qe}).join('\n').substr(2):Ve='\n'+Ve.split('\n').map(function(qe){return'   '+qe}).join('\n'))):Ve=ve.stylize('[Circular]','special')),ae(ze)){if(De&&Ce.match(/^\d+$/))return Ve;ze=JSON.stringify(''+Ce),ze.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ze=ze.substr(1,ze.length-2),ze=ve.stylize(ze,'name')):(ze=ze.replace(/'/g,'\\\'').replace(/\\"/g,'"').replace(/(^"|"$)/g,'\''),ze=ve.stylize(ze,'string'))}return ze+': '+Ve}function $(ve,Me,Ie){var Se=0,Ce=ve.reduce(function(De,ze){return Se++,0<=ze.indexOf('\n')&&Se++,De+ze.replace(/\u001b\[\d\d?m/g,'').length+1},0);return 60<Ce?Ie[0]+(''===Me?'':Me+'\n ')+' '+ve.join(',\n  ')+' '+Ie[1]:Ie[0]+Me+' '+ve.join(', ')+' '+Ie[1]}function ee(ve){return Array.isArray(ve)}function te(ve){return'boolean'==typeof ve}function ne(ve){return null===ve}function se(ve){return'number'==typeof ve}function oe(ve){return'string'==typeof ve}function ae(ve){return void 0===ve}function ce(ve){return de(ve)&&'[object RegExp]'===pe(ve)}function de(ve){return'object'==typeof ve&&null!==ve}function ue(ve){return de(ve)&&'[object Date]'===pe(ve)}function he(ve){return de(ve)&&('[object Error]'===pe(ve)||ve instanceof Error)}function ge(ve){return'function'==typeof ve}function pe(ve){return Object.prototype.toString.call(ve)}function xe(ve){return 10>ve?'0'+ve.toString(10):ve.toString(10)}function je(){var ve=new Date,Me=[xe(ve.getHours()),xe(ve.getMinutes()),xe(ve.getSeconds())].join(':');return[ve.getDate(),be[ve.getMonth()],Me].join(' ')}function ke(ve,Me){return Object.prototype.hasOwnProperty.call(ve,Me)}var fe=/%[sdj%]/g;I.format=function(ve){if(!oe(ve)){for(var Me=[],Ie=0;Ie<arguments.length;Ie++)Me.push(P(arguments[Ie]));return Me.join(' ')}for(var Ie=1,Se=arguments,Ce=Se.length,De=(ve+'').replace(fe,function(Ve){if('%%'===Ve)return'%';if(Ie>=Ce)return Ve;switch(Ve){case'%s':return Se[Ie++]+'';case'%d':return+Se[Ie++];case'%j':try{return JSON.stringify(Se[Ie++])}catch(Re){return'[Circular]'}default:return Ve;}}),ze=Se[Ie];Ie<Ce;ze=Se[++Ie])De+=ne(ze)||!de(ze)?' '+ze:' '+P(ze);return De},I.deprecate=function(ve,Me){if(ae(R.process))return function(){return I.deprecate(ve,Me).apply(this,arguments)};if(!0===E.noDeprecation)return ve;var Se=!1;return function(){if(!Se){if(E.throwDeprecation)throw new Error(Me);else E.traceDeprecation?console.trace(Me):console.error(Me);Se=!0}return ve.apply(this,arguments)}};var ye={},we;I.debuglog=function(ve){if(ae(we)&&(we=E.env.NODE_DEBUG||''),ve=ve.toUpperCase(),!ye[ve])if(new RegExp('\\b'+ve+'\\b','i').test(we)){var Me=E.pid;ye[ve]=function(){var Ie=I.format.apply(I,arguments);console.error('%s %d: %s',ve,Me,Ie)}}else ye[ve]=function(){};return ye[ve]},I.inspect=P,P.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},P.styles={special:'cyan',number:'yellow',boolean:'yellow',undefined:'grey','null':'bold',string:'green',date:'magenta',regexp:'red'},I.isArray=ee,I.isBoolean=te,I.isNull=ne,I.isNullOrUndefined=function(ve){return null==ve},I.isNumber=se,I.isString=oe,I.isSymbol=function(ve){return'symbol'==typeof ve},I.isUndefined=ae,I.isRegExp=ce,I.isObject=de,I.isDate=ue,I.isError=he,I.isFunction=ge,I.isPrimitive=function(ve){return null===ve||'boolean'==typeof ve||'number'==typeof ve||'string'==typeof ve||'symbol'==typeof ve||'undefined'==typeof ve},I.isBuffer=D(50);var be=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];I.log=function(){console.log('%s - %s',je(),I.format.apply(I,arguments))},I.inherits=D(49),I._extend=function(ve,Me){if(!Me||!de(Me))return ve;for(var Ie=Object.keys(Me),Se=Ie.length;Se--;)ve[Ie[Se]]=Me[Ie[Se]];return ve}}).call(I,D(52),D(48))},function(u){var D=function(){return this}();try{D=D||Function('return this')()||(1,eval)('this')}catch(R){'object'==typeof window&&(D=window)}u.exports=D},function(u,I,D){'use strict';I.SpinSystem=D(17),I.simulate1D=D(18),I.simulate2D=D(19)}])});
//# sourceMappingURL=nmr-simulation.min.js.map